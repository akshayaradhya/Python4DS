<!doctype html>
<html>
<head>
<meta charset='UTF-8'><meta name='viewport' content='width=device-width initial-scale=1'>
<title>Pandas.md</title><style type='text/css'>html, body {overflow-x: initial !important;}.CodeMirror { height: auto; }
.CodeMirror-scroll { overflow-y: hidden; overflow-x: auto; }
.CodeMirror-lines { padding: 4px 0px; }
.CodeMirror pre { }
.CodeMirror-scrollbar-filler, .CodeMirror-gutter-filler { background-color: white; }
.CodeMirror-gutters { border-right-width: 1px; border-right-style: solid; border-right-color: rgb(221, 221, 221); background-color: rgb(247, 247, 247); white-space: nowrap; }
.CodeMirror-linenumbers { }
.CodeMirror-linenumber { padding: 0px 3px 0px 5px; text-align: right; color: rgb(153, 153, 153); }
.CodeMirror div.CodeMirror-cursor { border-left-width: 1px; border-left-style: solid; border-left-color: black; z-index: 3; }
.CodeMirror div.CodeMirror-secondarycursor { border-left-width: 1px; border-left-style: solid; border-left-color: silver; }
.CodeMirror.cm-keymap-fat-cursor div.CodeMirror-cursor { width: auto; border: 0px; background-color: rgb(119, 238, 119); z-index: 1; background-position: initial initial; background-repeat: initial initial; }
.CodeMirror div.CodeMirror-cursor.CodeMirror-overwrite { }
.cm-tab { display: inline-block; }
.cm-s-typora-default .cm-header, .cm-s-typora-default .cm-property { color: rgb(217, 79, 138); }
.cm-s-typora-default pre.cm-header1:not(.cm-atom) :not(.cm-overlay) { font-size: 2rem; line-height: 2rem; }
.cm-s-typora-default pre.cm-header2:not(.cm-atom) :not(.cm-overlay) { font-size: 1.4rem; line-height: 1.4rem; }
.cm-s-typora-default .cm-atom, .cm-s-typora-default .cm-number { color: rgb(149, 132, 134); }
.cm-s-typora-default .cm-table-row, .cm-s-typora-default .cm-block-start { font-family: monospace; }
.cm-s-typora-default .cm-comment, .cm-s-typora-default .cm-code { color: rgb(74, 90, 159); font-family: monospace; }
.cm-s-typora-default .cm-tag { color: rgb(169, 68, 66); }
.cm-s-typora-default .cm-string { color: rgb(126, 134, 169); }
.cm-s-typora-default .cm-link { color: rgb(196, 122, 15); text-decoration: underline; }
.cm-s-typora-default .cm-variable-2, .cm-s-typora-default .cm-variable-1 { color: inherit; }
.cm-s-typora-default .cm-overlay { font-size: 1rem; font-family: monospace; }
.CodeMirror.cm-s-typora-default div.CodeMirror-cursor { border-left-width: 3px; border-left-style: solid; border-left-color: rgb(228, 98, 154); }
.cm-s-typora-default .CodeMirror-activeline-background { left: -60px; right: -30px; background-color: rgba(204, 204, 204, 0.2); background-position: initial initial; background-repeat: initial initial; }
.cm-s-typora-default .CodeMirror-gutters { border-right-style: none; background-color: inherit; }
.cm-s-typora-default .cm-trailing-space-new-line::after, .cm-startspace::after, .cm-starttab .cm-tab::after { content: '•'; position: absolute; left: 0px; opacity: 0; font-family: LetterGothicStd, monospace; }
.os-windows .cm-startspace::after, .os-windows .cm-starttab .cm-tab::after { left: -0.1em; }
.cm-starttab .cm-tab::after { content: ' '; }
.cm-startspace, .cm-tab, .cm-starttab, .cm-trailing-space-a, .cm-trailing-space-b, .cm-trailing-space-new-line { font-family: monospace; position: relative; }
.cm-s-typora-default .cm-trailing-space-new-line::after { content: '↓'; opacity: 0.3; }
.cm-s-inner .cm-keyword { color: rgb(119, 0, 136); }
.cm-s-inner .cm-atom, .cm-s-inner.cm-atom { color: rgb(34, 17, 153); }
.cm-s-inner .cm-number { color: rgb(17, 102, 68); }
.cm-s-inner .cm-def { color: rgb(0, 0, 255); }
.cm-s-inner .cm-variable { color: black; }
.cm-s-inner .cm-variable-2 { color: rgb(0, 85, 170); }
.cm-s-inner .cm-variable-3 { color: rgb(0, 136, 85); }
.cm-s-inner .cm-property { color: black; }
.cm-s-inner .cm-operator { color: rgb(152, 26, 26); }
.cm-s-inner .cm-comment, .cm-s-inner.cm-comment { color: rgb(170, 85, 0); }
.cm-s-inner .cm-string { color: rgb(170, 17, 17); }
.cm-s-inner .cm-string-2 { color: rgb(255, 85, 0); }
.cm-s-inner .cm-meta { color: rgb(85, 85, 85); }
.cm-s-inner .cm-qualifier { color: rgb(85, 85, 85); }
.cm-s-inner .cm-builtin { color: rgb(51, 0, 170); }
.cm-s-inner .cm-bracket { color: rgb(153, 153, 119); }
.cm-s-inner .cm-tag { color: rgb(17, 119, 0); }
.cm-s-inner .cm-attribute { color: rgb(0, 0, 204); }
.cm-s-inner .cm-header, .cm-s-inner.cm-header { color: blue; }
.cm-s-inner .cm-quote, .cm-s-inner.cm-quote { color: rgb(0, 153, 0); }
.cm-s-inner .cm-hr, .cm-s-inner.cm-hr { color: rgb(153, 153, 153); }
.cm-s-inner .cm-link, .cm-s-inner.cm-link { color: rgb(0, 0, 204); }
.cm-negative { color: rgb(221, 68, 68); }
.cm-positive { color: rgb(34, 153, 34); }
.cm-header, .cm-strong { font-weight: bold; }
.cm-del { text-decoration: line-through; }
.cm-em { font-style: italic; }
.cm-link { text-decoration: underline; }
.cm-error { color: rgb(255, 0, 0); }
.cm-invalidchar { color: rgb(255, 0, 0); }
div.CodeMirror span.CodeMirror-matchingbracket { color: rgb(0, 255, 0); }
div.CodeMirror span.CodeMirror-nonmatchingbracket { color: rgb(255, 34, 34); }
.cm-s-inner .CodeMirror-activeline-background { background-image: inherit; background-size: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: inherit; background-position: inherit inherit; background-repeat: inherit inherit; }
.CodeMirror { position: relative; overflow: hidden; }
.CodeMirror-scroll { margin-bottom: -30px; margin-right: -30px; padding-bottom: 30px; padding-right: 30px; height: 100%; outline: none; position: relative; box-sizing: content-box; }
.CodeMirror-sizer { position: relative; }
.CodeMirror-vscrollbar, .CodeMirror-hscrollbar, .CodeMirror-scrollbar-filler, .CodeMirror-gutter-filler { position: absolute; z-index: 6; display: none; }
.CodeMirror-vscrollbar { right: 0px; top: 0px; overflow-x: hidden; overflow-y: scroll; }
.CodeMirror-hscrollbar { bottom: 0px; left: 0px; overflow-y: hidden; overflow-x: scroll; }
.CodeMirror-scrollbar-filler { right: 0px; bottom: 0px; }
.CodeMirror-gutter-filler { left: 0px; bottom: 0px; }
.CodeMirror-gutters { position: absolute; left: 0px; top: 0px; padding-bottom: 30px; z-index: 3; }
.CodeMirror-gutter { white-space: normal; height: 100%; box-sizing: content-box; padding-bottom: 30px; margin-bottom: -32px; display: inline-block; }
.CodeMirror-gutter-elt { position: absolute; cursor: default; z-index: 4; }
.CodeMirror-lines { cursor: text; }
.CodeMirror pre { border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; border-width: 0px; background-color: transparent; font-family: inherit; font-size: inherit; margin: 0px; white-space: pre; word-wrap: normal; color: inherit; z-index: 2; position: relative; overflow: visible; background-position: initial initial; background-repeat: initial initial; }
.CodeMirror-wrap pre { word-wrap: break-word; white-space: pre-wrap; word-break: normal; }
.CodeMirror-code pre { border-right-width: 30px; border-right-style: solid; border-right-color: transparent; width: -webkit-fit-content; }
.CodeMirror-wrap .CodeMirror-code pre { border-right-style: none; width: auto; }
.CodeMirror-linebackground { position: absolute; left: 0px; right: 0px; top: 0px; bottom: 0px; z-index: 0; }
.CodeMirror-linewidget { position: relative; z-index: 2; overflow: auto; }
.CodeMirror-widget { }
.CodeMirror-wrap .CodeMirror-scroll { overflow-x: hidden; }
.CodeMirror-measure { position: absolute; width: 100%; height: 0px; overflow: hidden; visibility: hidden; }
.CodeMirror-measure pre { position: static; }
.CodeMirror div.CodeMirror-cursor { position: absolute; visibility: hidden; border-right-style: none; width: 0px; }
.CodeMirror div.CodeMirror-cursor { visibility: hidden; }
.CodeMirror-focused div.CodeMirror-cursor { visibility: inherit; }
.CodeMirror-selected { background-color: rgb(217, 217, 217); background-position: initial initial; background-repeat: initial initial; }
.CodeMirror-focused .CodeMirror-selected { background-color: rgb(215, 212, 240); background-position: initial initial; background-repeat: initial initial; }
.cm-searching { background-color: rgba(255, 255, 0, 0.4); background-position: initial initial; background-repeat: initial initial; }
.CodeMirror span { }
@media print { 
  .CodeMirror div.CodeMirror-cursor { visibility: hidden; }
}
.CodeMirror-lint-markers { width: 16px; }
.CodeMirror-lint-tooltip { background-color: infobackground; border: 1px solid black; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; color: infotext; font-family: monospace; overflow: hidden; padding: 2px 5px; position: fixed; white-space: pre-wrap; z-index: 10000; max-width: 600px; opacity: 0; -webkit-transition: opacity 0.4s; transition: opacity 0.4s; font-size: 0.8em; }
.CodeMirror-lint-mark-error, .CodeMirror-lint-mark-warning { background-position: 0% 100%; background-repeat: repeat no-repeat; }
.CodeMirror-lint-mark-error { background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAADCAYAAAC09K7GAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9sJDw4cOCW1/KIAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAAHElEQVQI12NggIL/DAz/GdA5/xkY/qPKMDAwAADLZwf5rvm+LQAAAABJRU5ErkJggg==); }
.CodeMirror-lint-marker-error, .CodeMirror-lint-marker-warning { cursor: pointer; display: inline-block; height: 16px; width: 16px; vertical-align: middle; position: relative; background-position: 50% 50%; background-repeat: no-repeat no-repeat; }
.CodeMirror-lint-message-error, .CodeMirror-lint-message-warning { padding-left: 18px; background-position: 0% 0%; background-repeat: no-repeat no-repeat; }
.CodeMirror-lint-marker-error, .CodeMirror-lint-message-error { background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAHlBMVEW7AAC7AACxAAC7AAC7AAAAAAC4AAC5AAD///+7AAAUdclpAAAABnRSTlMXnORSiwCK0ZKSAAAATUlEQVR42mWPOQ7AQAgDuQLx/z8csYRmPRIFIwRGnosRrpamvkKi0FTIiMASR3hhKW+hAN6/tIWhu9PDWiTGNEkTtIOucA5Oyr9ckPgAWm0GPBog6v4AAAAASUVORK5CYII=); }
.CodeMirror-lint-marker-warning, .CodeMirror-lint-message-warning { background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAANlBMVEX/uwDvrwD/uwD/uwD/uwD/uwD/uwD/uwD/uwD6twD/uwAAAADurwD2tQD7uAD+ugAAAAD/uwDhmeTRAAAADHRSTlMJ8mN1EYcbmiixgACm7WbuAAAAVklEQVR42n3PUQqAIBBFUU1LLc3u/jdbOJoW1P08DA9Gba8+YWJ6gNJoNYIBzAA2chBth5kLmG9YUoG0NHAUwFXwO9LuBQL1giCQb8gC9Oro2vp5rncCIY8L8uEx5ZkAAAAASUVORK5CYII=); }
.CodeMirror-lint-marker-multiple { background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAcAAAAHCAMAAADzjKfhAAAACVBMVEUAAAAAAAC/v7914kyHAAAAAXRSTlMAQObYZgAAACNJREFUeNo1ioEJAAAIwmz/H90iFFSGJgFMe3gaLZ0od+9/AQZ0ADosbYraAAAAAElFTkSuQmCC); width: 100%; height: 100%; background-position: 100% 100%; background-repeat: no-repeat no-repeat; }


html { font-size: 14px; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); }
body { margin: 0px; padding: 0px; height: auto; bottom: 0px; top: 0px; left: 0px; right: 0px; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 1rem; line-height: 1.42857143; overflow-x: hidden; background-image: inherit; background-size: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: inherit; background-position: inherit inherit; background-repeat: inherit inherit; }
a:active, a:hover { outline: 0px; }
.in-text-selection, ::selection { background-color: rgb(181, 214, 252); text-shadow: none; background-position: initial initial; background-repeat: initial initial; }
#write { margin: 0px auto; height: auto; width: inherit; word-break: normal; word-wrap: break-word; position: relative; padding-bottom: 70px; white-space: pre-wrap; overflow-x: auto; }
.for-image #write { padding-left: 8px; padding-right: 8px; }
body.typora-export { padding-left: 30px; padding-right: 30px; }
@media screen and (max-width: 500px) { 
  body.typora-export { padding-left: 0px; padding-right: 0px; }
  .CodeMirror-sizer { margin-left: 0px !important; }
  .CodeMirror-gutters { display: none !important; }
}
.typora-export #write { margin: 0px auto; }
#write > p:first-child, #write > ul:first-child, #write > ol:first-child, #write > pre:first-child, #write > blockquote:first-child, #write > div:first-child, #write > table:first-child { margin-top: 30px; }
#write li > table:first-child { margin-top: -20px; }
img { max-width: 100%; }
input, button, select, textarea { color: inherit; font-family: inherit; font-size: inherit; font-style: inherit; font-variant-caps: inherit; font-weight: inherit; line-height: inherit; }
input[type="checkbox"], input[type="radio"] { line-height: normal; padding: 0px; }
::before, ::after, * { box-sizing: border-box; }
#write p, #write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write div, #write pre { width: inherit; }
#write p, #write h1, #write h2, #write h3, #write h4, #write h5, #write h6 { position: relative; }
h1 { font-size: 2rem; }
h2 { font-size: 1.8rem; }
h3 { font-size: 1.6rem; }
h4 { font-size: 1.4rem; }
h5 { font-size: 1.2rem; }
h6 { font-size: 1rem; }
p { -webkit-margin-before: 1rem; -webkit-margin-after: 1rem; -webkit-margin-start: 0px; -webkit-margin-end: 0px; }
.mathjax-block { margin-top: 0px; margin-bottom: 0px; -webkit-margin-before: 0rem; -webkit-margin-after: 0rem; }
.hidden { display: none; }
.md-blockmeta { color: rgb(204, 204, 204); font-weight: bold; font-style: italic; }
a { cursor: pointer; }
#write input[type="checkbox"] { cursor: pointer; width: inherit; height: inherit; margin: 4px 0px 0px; }
tr { page-break-inside: avoid; page-break-after: auto; }
thead { display: table-header-group; }
table { border-collapse: collapse; border-spacing: 0px; width: 100%; overflow: auto; page-break-inside: auto; text-align: left; }
table.md-table td { min-width: 80px; }
.CodeMirror-gutters { border-right-width: 0px; background-color: inherit; }
.CodeMirror { text-align: left; }
.CodeMirror-placeholder { opacity: 0.3; }
.CodeMirror pre { padding: 0px 4px; }
.CodeMirror-lines { padding: 0px; }
div.hr:focus { cursor: none; }
pre { white-space: pre-wrap; }
.CodeMirror-gutters { margin-right: 4px; }
.md-fences { font-size: 0.9rem; display: block; page-break-inside: avoid; text-align: left; overflow: visible; white-space: pre; background-image: inherit; background-size: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: inherit; position: relative !important; background-position: inherit inherit; background-repeat: inherit inherit; }
.md-diagram-panel { width: 100%; margin-top: 10px; text-align: center; padding-top: 0px; padding-bottom: 8px; overflow-x: auto; }
.md-fences .CodeMirror.CodeMirror-wrap { top: -1.6em; margin-bottom: -1.6em; }
.md-fences.mock-cm { white-space: pre-wrap; }
.show-fences-line-number .md-fences { padding-left: 0px; }
.show-fences-line-number .md-fences.mock-cm { padding-left: 40px; }
.footnotes { opacity: 0.8; font-size: 0.9rem; padding-top: 1em; padding-bottom: 1em; }
.footnotes + .footnotes { margin-top: -1em; }
.md-reset { margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: top; background-color: transparent; text-decoration: none; text-shadow: none; float: none; position: static; width: auto; height: auto; white-space: nowrap; cursor: inherit; line-height: normal; font-weight: normal; text-align: left; box-sizing: content-box; direction: ltr; background-position: initial initial; background-repeat: initial initial; }
li div { padding-top: 0px; }
blockquote { margin: 1rem 0px; }
li p, li .mathjax-block { margin: 0.5rem 0px; }
li { margin: 0px; position: relative; }
blockquote > :last-child { margin-bottom: 0px; }
blockquote > :first-child { margin-top: 0px; }
.footnotes-area { color: rgb(136, 136, 136); margin-top: 0.714rem; padding-bottom: 0.143rem; }
@media print { 
  html, body { height: 100%; }
  .typora-export * { -webkit-print-color-adjust: exact; }
  h1, h2, h3, h4, h5, h6 { page-break-after: avoid; break-after: avoid-page; orphans: 2; }
  p { orphans: 4; }
  html.blink-to-pdf { font-size: 13px; }
  .typora-export #write { padding-left: 1cm; padding-right: 1cm; }
  .typora-export #write::after { height: 0px; }
  @page { margin: 20mm 0mm; }
}
.footnote-line { margin-top: 0.714em; font-size: 0.7em; }
a img, img a { cursor: pointer; }
pre.md-meta-block { font-size: 0.8rem; min-height: 2.86rem; white-space: pre-wrap; background-color: rgb(204, 204, 204); display: block; background-position: initial initial; background-repeat: initial initial; }
p .md-image:only-child, p img:only-child { display: inline-block; width: 100%; text-align: center; }
#write .MathJax_Display { margin: 0.8em 0px 0px; }
.mathjax-block { white-space: pre; overflow: hidden; width: 100%; }
p + .mathjax-block { margin-top: -1.143rem; }
.mathjax-block:not(:empty)::after { display: none; }
[contenteditable="true"]:active, [contenteditable="true"]:focus { outline: none; box-shadow: none; }
.task-list { list-style-type: none; }
.task-list-item { position: relative; padding-left: 1em; }
.task-list-item input { position: absolute; top: 0px; left: 0px; }
.math { font-size: 1rem; }
.md-toc { min-height: 3.58rem; position: relative; font-size: 0.9rem; border-top-left-radius: 10px; border-top-right-radius: 10px; border-bottom-right-radius: 10px; border-bottom-left-radius: 10px; }
.md-toc-content { position: relative; margin-left: 0px; }
.md-toc::after, .md-toc-content::after { display: none; }
.md-toc-item { display: block; color: rgb(65, 131, 196); text-decoration: none; }
.md-toc-inner:hover { }
.md-toc-inner { display: inline-block; cursor: pointer; }
.md-toc-h1 .md-toc-inner { margin-left: 0px; font-weight: bold; }
.md-toc-h2 .md-toc-inner { margin-left: 2em; }
.md-toc-h3 .md-toc-inner { margin-left: 4em; }
.md-toc-h4 .md-toc-inner { margin-left: 6em; }
.md-toc-h5 .md-toc-inner { margin-left: 8em; }
.md-toc-h6 .md-toc-inner { margin-left: 10em; }
@media screen and (max-width: 48em) { 
  .md-toc-h3 .md-toc-inner { margin-left: 3.5em; }
  .md-toc-h4 .md-toc-inner { margin-left: 5em; }
  .md-toc-h5 .md-toc-inner { margin-left: 6.5em; }
  .md-toc-h6 .md-toc-inner { margin-left: 8em; }
}
a.md-toc-inner { font-size: inherit; font-style: inherit; font-weight: inherit; line-height: inherit; }
.footnote-line a:not(.reversefootnote) { color: inherit; }
.md-attr { display: none; }
.md-fn-count::after { content: '.'; }
.md-tag { opacity: 0.5; }
.md-comment { color: rgb(162, 127, 3); opacity: 0.8; font-family: monospace; }
code { text-align: left; }
h1 .md-tag, h2 .md-tag, h3 .md-tag, h4 .md-tag, h5 .md-tag, h6 .md-tag { font-weight: initial; opacity: 0.35; }
a.md-header-anchor.md-print-anchor { border: none !important; display: inline-block !important; position: absolute !important; width: 1px !important; right: 0px !important; outline: none !important; background-color: transparent !important; text-shadow: initial !important; background-position: initial initial !important; background-repeat: initial initial !important; }
.md-inline-math .MathJax_SVG .noError { display: none !important; }
.mathjax-block .MathJax_SVG_Display { text-align: center; margin: 1em 0em; position: relative; text-indent: 0px; max-width: none; max-height: none; min-width: 0px; min-height: 0px; width: 100%; display: block !important; }
.MathJax_SVG_Display, .md-inline-math .MathJax_SVG_Display { width: auto; margin: inherit; display: inline-block !important; }
.MathJax_SVG .MJX-monospace { font-family: monospace; }
.MathJax_SVG .MJX-sans-serif { font-family: sans-serif; }
.MathJax_SVG { display: inline; font-style: normal; font-weight: normal; line-height: normal; zoom: 90%; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; }
.MathJax_SVG * { -webkit-transition: none; transition: none; }


html {
	font-size: 19px;
}

html, body {
	margin: auto;
	background: #fefefe;
}
body {
	font-family: "Vollkorn", Palatino, Times;
	color: #333;
	line-height: 1.4;
	text-align: justify;
}
#write {
	max-width: 960px;
	margin: 0 auto;
	margin-bottom: 2em;
	line-height: 1.53;
}

#write>h2:first-child,
#write>h3:first-child,
#write>h4:first-child,
#write>p:first-child{
	margin-top: 1.2em;
}

/* Typography
-------------------------------------------------------- */

#write>h1:first-child,
h1 {
	margin-top: 1.6em;
	font-weight: normal;
}

h1 {
	font-size:3em;
}

h2 {
	margin-top:2em;
	font-weight: normal;
}

h3 {
	font-weight: normal;
	font-style: italic;
	margin-top: 3em;
}

h1, 
h2, 
h3{
	text-align: center;
}

h2:after{
	border-bottom: 1px solid #2f2f2f;
    content: '';
    width: 100px;
    display: block;
    margin: 0 auto;
    height: 1px;
}

h1+h2, h2+h3 {
	margin-top: 0.83em;
}

p,
.mathjax-block {
	margin-top: 0;
	-webkit-hypens: auto;
	-moz-hypens: auto;
	hyphens: auto;
}
ul {
	list-style: square;
	padding-left: 1.2em;
}
ol {
	padding-left: 1.2em;
}
blockquote {
	margin-left: 1em;
	padding-left: 1em;
	border-left: 1px solid #ddd;
}
code,
pre {
	font-family: "Consolas", "Menlo", "Monaco", monospace, serif;
	font-size: .9em;
	background: white;
}
.md-fences{
	margin-left: 1em;
	padding-left: 1em;
	border: 1px solid #ddd;
	padding-bottom: 8px;
	padding-top: 6px;
	margin-bottom: 1.5em;
}

a {
	color: #2484c1;
	text-decoration: none;
}
a:hover {
	text-decoration: underline;
}
a img {
	border: none;
}
h1 a,
h1 a:hover {
	color: #333;
	text-decoration: none;
}
hr {
	color: #ddd;
	height: 1px;
	margin: 2em 0;
	border-top: solid 1px #ddd;
	border-bottom: none;
	border-left: 0;
	border-right: 0;
}
.md-table-edit {
	background: #ededed;
    padding-top: 4px;
}
table {
	margin-bottom: 1.333333rem
}
table th,
table td {
	padding: 8px;
	line-height: 1.333333rem;
	vertical-align: top;
	border-top: 1px solid #ddd
}
table th {
	font-weight: bold
}
table thead th {
	vertical-align: bottom
}
table caption+thead tr:first-child th,
table caption+thead tr:first-child td,
table colgroup+thead tr:first-child th,
table colgroup+thead tr:first-child td,
table thead:first-child tr:first-child th,
table thead:first-child tr:first-child td {
	border-top: 0
}
table tbody+tbody {
	border-top: 2px solid #ddd
}

.task-list{
	padding:0;
}

.task-list-item {
	padding-left: 1.6rem;
}

.task-list-item input:before {
	content: '\221A';
	display: inline-block;
	width: 1.33333333rem;
  	height: 1.6rem;
	vertical-align: middle;
	text-align: center;
	color: #ddd;
	background-color: #fefefe;
}

.task-list-item input:checked:before,
.task-list-item input[checked]:before{
	color: inherit;
}
.md-tag {
	color: inherit;
	font: inherit;
}
#write pre.md-meta-block {
	min-height: 35px;
	padding: 0.5em 1em;
}
#write pre.md-meta-block {
	white-space: pre;
	background: #f8f8f8;
	border: 0px;
	color: #999;
	border-left: 1000px #f8f8f8 solid;
	margin-left: -1000px;
	border-right: 1000px #f8f8f8 solid;
	margin-right: -1000px;
	margin-bottom: 2em;
	margin-top: -1.3333333333333rem;
	padding-top: 26px;
	padding-bottom: 10px;
	line-height: 1.8em;
	font-size: 0.9em;
	font-size: 0.76em;
	padding-left: 0;
}
.md-img-error.md-image>.md-meta{
	vertical-align: bottom;
}
#write>h5.md-focus:before {
	top: 2px;
}

.md-toc {
	margin-top: 40px;
}

.md-toc-content {
	padding-bottom: 20px;
}

.outline-expander:before {
	color: inherit;
	font-size: 14px;
	top: auto;
	content: "\f0da";
	font-family: FontAwesome;
}

.outline-expander:hover:before,
.outline-item-open>.outline-item>.outline-expander:before {
  	content: "\f0d7";
}

/** source code mode */
#typora-source {
	font-family: Courier, monospace;
    color: #6A6A6A;
}

.cm-s-typora-default .cm-header, 
.cm-s-typora-default .cm-property,
.CodeMirror.cm-s-typora-default div.CodeMirror-cursor {
	color: #428bca;
}

.cm-s-typora-default .cm-atom, .cm-s-typora-default .cm-number {
	color: #777777;
}



</style>
</head>
<body class='typora-export' >
<div  id='write'  class = 'is-mac'><h1><a name='header-c1' class='md-header-anchor '></a>Data Wrangling with <code>pandas</code></h1><hr /><h2><a name='header-c2094' class='md-header-anchor '></a>Introduction</h2><blockquote><p><em>A simple analysis of clean data can be more productive than a complex analysis of noisy and irregular data.</em></p></blockquote><p>In chapter 1, we came across the <strong>Data Science Process</strong> as a list of tasks that Data Scientists perform in their day-to-day work. This can be considered to be an extension of <strong>the Scientific Method</strong> (which is a commonly taught framework for conducting scientific investigations) and can be applied to solving almost any kind of problem. </p><p>Attempts have been made by several practitioners to give structure to this process that begins with raw data and ends in a data product (typically a machine learning model or an interactive visualization.) </p><p>The <a href='https://en.wikipedia.org/wiki/Cross_Industry_Standard_Process_for_Data_Mining'>CRISP-DM</a> methodology and Hilary Mason&#39;s <a href='http://www.dataists.com/tag/osemn/'>OSEMN things</a> are examples of this process. </p><p>									</p><p><img src="800px-CRISP-DM_Process_Diagram.png" width="200px"></p><p>​                                                    			    <em>Fig. 3-1 CRISP-DM</em></p><p></p><p><img src="osemn.jpg" width="200px"></p><p>										<em>Fig 3-2 OSEMN Things</em></p><p></p><p><img src="ds_process_2.png" width="300px"></p><p>									<em>Fig 3-3 The Data Science Process</em></p><p></p><hr /><p>Broadly, it consists of the following steps</p><p><small></p><table><thead><tr><th style='text-align:left;' >Step</th><th style='text-align:left;' >Task</th></tr></thead><tbody><tr><td style='text-align:left;' >1.  Question</td><td style='text-align:left;' >Clearly define the business problem</td></tr><tr><td style='text-align:left;' >2.  Get Data</td><td style='text-align:left;' >Obtain data from internal/external sources, APIs</td></tr><tr><td style='text-align:left;' >3.  Wrangle</td><td style='text-align:left;' >Clean messy data. Engineer features. Summarize, aggregate data.</td></tr><tr><td style='text-align:left;' >4.  Explore</td><td style='text-align:left;' >Visualize distributions. Investigate relationships. Build intuition for subsequent steps.</td></tr><tr><td style='text-align:left;' >5.  Model</td><td style='text-align:left;' >Build and Tune models. Select the best from competing statistical models.</td></tr><tr><td style='text-align:left;' >6.  Interpret</td><td style='text-align:left;' >Assess model performance on out-of-sample data. Understand results. Draw Insights.</td></tr><tr><td style='text-align:left;' >7.  Deploy</td><td style='text-align:left;' >Productionalize your analysis. Build a data product.</td></tr></tbody></table><p></small></p><p>In this chapter, we will focus on <strong>#2 - Get Data</strong> and <strong>#3 - Wrangle</strong> above. 
But before we begin, a word of caution. </p><p>Raw data in the real-world is often <em>messy</em> and before we conduct any analysis on the data, we must first make it <em>tidy</em>. Cleaning data can be a tedious and repetitive task, and handling this problem inefficiently may lead to great exasperation.</p><p>The path from messy to clean data is fraught with sinister dangers like strange delimiters, inconsistent character encodings, spelling mistakes, missing values, dates stored as text … the list goes on. It is for these reasons that data preparation has often been labeled by various practitioners as</p><blockquote><p> the <em>least sexy, most time &amp; labour intensive</em> task in data science. </p></blockquote><p></p><p><img src="ds_time_spent.png" width="400"></p><p>					        <em>Fig 3-3 Data Preparation will take upto 80% of your time</em></p><p></p><p>Here are some of the more commonly observed patterns in unclean data.</p><ul><li>Column names are missing or gibberish </li><li>Data from multiple variables are concatenated into a single column</li><li><strong>Missing data</strong> are encoded in different ways </li><li>Features are stored using varying units of measurement</li><li><strong>Outliers</strong> </li></ul><p>There are strategies to deal with each one of these patterns. The following sections will introuce you to the tools and techniques you can use to perform these janitorial duties. Most of these tasks will be performed in Python using the <code>pandas</code> library.</p><p>Once the data is clean it may still require more work before it can be used to create meaningful visualizations or for building machine learning models. This is where we perform advanced <em>data wrangling</em> tasks such as </p><ul><li><strong>Reshaping</strong> long-data to wide-data </li><li><strong>Subsetting</strong> data to retain relevant rows and/or columns </li><li><strong>Aggregating</strong> data using the <code>split-apply-combine</code> strategy </li><li><strong>Sorting , Merging</strong> to combine data from different sources</li></ul><p>If you persevere through these steps, you should have a <code>tidy</code> dataset that satisfies the criterion laid down by Hadley Wickham, and makes it easy to carry out data analysis. </p><ul><li>Observations are in rows</li><li>Variables are in columns</li><li>Entities of one kind to be contained in a single dataset (ex. customers, transactions)</li></ul><h1><a name='header-c116' class='md-header-anchor '></a>Introducing <code>pandas</code></h1><p><strong>Pandas</strong> is an acronym for <strong>PAN</strong>el <strong>D</strong>ata <strong>A</strong>nalysi<strong>S</strong>. It is a free, open-source data science library aimed at quick and simplified data munging and exploratory analysis in Python. Specifically, it provides high-level data structures like the <code>DataFrame</code> (similar to the R <code>data.frame</code>) and <code>Series</code> (one-dimensional structure with an index) which have rich methods for tackling the entire spectrum of data munging tasks. Additionally, <code>pandas</code> has specialized methods for manipulating and visualizing numerical variables and time series data. </p><p>Pandas creator Wes McKinney started building the library in 2008 during his time at an investment management firm. He was motivated by a need to address a distinct set of data analysis requirements that were not fully satisfiedby any one tool at his disposal at the time.</p><blockquote><p>Python had long been great for data munging and preparation, but less so for data analysis and modeling. Pandas helps fill this gap, enabling you to carry out your entire data analysis workflow in Python without having to switch to a more domain specific language.</p></blockquote><h2><a name='header-c125' class='md-header-anchor '></a>Pandas Features </h2><ul><li>Easy handling of <strong><em>missing data.</em></strong> (<code>dropna, fillna, ffill, isnull, notnull</code>)</li><li>Simple <strong><em>mutations</em></strong> of tables to add/remove columns on the fly (<code>assign, drop</code>)</li><li>Easy <strong><em>slicing</em></strong> of data (fancy indexing and subsetting)</li><li>Automatic <strong><em>data alignment</em></strong> (by <code>index</code>)</li><li>Powerful <strong><em>split-apply-combine</em></strong> (<code>groupby</code>) for aggregations and transformations</li><li>Intuitive <strong><em>merge/join</em></strong> (<code>concat, join</code>)</li><li>Flexible <strong>Reshaping</strong> and <strong><em>Pivoting</em></strong> (<code>stack, pivot</code>)</li><li><strong><em>Hierarchical Labeling</em></strong> of axes indices for working with higher-dimensional data</li><li>Robust <strong><em>I/O tools</em></strong> to work with csv, Excel, flat files, <strong><em>databases and HDFS</em></strong></li><li>Integrated <strong><em>Time Series</em></strong> Functionality</li><li>Easy visualization (<code>plot</code>)</li></ul><p>Pandas is built on a solid foundation of NumPy arrays, and is optimized for performance (pandas is about 15x faster), with essential code pieces written in Cython or C. NumPy’s <code>ndarray</code> and its broadcasting capabilities are leveraged extensively. </p><p>The documentation is available at <a href='http://pandas.pydata.org' target='_blank' >http://pandas.pydata.org</a></p><p>We will now take a quick detour to highlight a few important concepts of NumPy that will simplify our understanding of many concepts in <code>pandas</code>.</p><h1><a name='header-c167' class='md-header-anchor '></a>Quick NumPy Reference</h1><p><a href='http://www.numpy.org/'>Numpy</a> is the fundamental library for all scientific computing in Python. It provides a <em>high-performance, homogenous, multidimensional</em> array and matrix objects called the <code>ndarray</code>, along with an assortment of high-level functions for fast operations on these arrays, such as:</p><ul><li>mathematical, logical routines </li><li>shape manipulations </li><li>sorting, selecting data</li><li>basic linear algebra and statistical operations, </li><li>random number generation capabilities</li><li>sophisticated (broadcasting) functions</li></ul><p>Almost every data analysis or machine learning package in the PyData ecosystem (most notably <code>pandas</code> and <code>scikit-learn</code>) uses NumPy ndarrays under the hood.</p><p>Alright, let&#39;s jump into some code. Conventionally, we start with importing the module</p><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">numpy</span> <span class="cm-keyword">as</span> <span class="cm-variable">np</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 26px;"></div></div></div></pre><h2><a name='header-c194' class='md-header-anchor '></a>NumPy Arrays</h2><p>A NumPy array is a homogeneous collection of elements (usually <em>numerics</em>), indexed by a tuple of positive integers. In NumPy the dimensions are called <em>axes</em>. The number of axes is known as the <em>rank</em> of the array. For example, a 2D array has a rank of 2.</p><ul><li><p>Arrays can be of different <strong>types</strong></p><ul><li><p> <code>int, float, string, object, bool</code></p></li><li><p>type conversion can be achieved using <code>.astype()</code></p><p></p></li></ul></li></ul><ul><li><p>Arrays can be <strong>created</strong> by</p><ul><li><p>calling <code>np.array()</code> or <code>reshape</code> on Python lists or nested lists</p></li><li><p>using special functions like <code>np.zeros(), np.ones(), np.eye()</code></p></li><li><p>using sequence generators like <code>np.linspace(), np.arange()</code></p></li><li><p>using random number generators like <code>np.random.randint(), np.random.randn()</code></p><p>You may read about other methods of array creation <a href='http://docs.scipy.org/doc/numpy/user/basics.creation.html#arrays-creation'>in the documentation</a></p></li></ul><p></p><p>Examples</p></li></ul><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Create a 1D array from a Python list</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"> <span class="cm-variable">In</span> [<span class="cm-number">9</span>]: <span class="cm-variable">ndarr_1</span> = <span class="cm-variable">np</span>.<span class="cm-property">array</span>([<span class="cm-number">100</span>, <span class="cm-number">3</span>, <span class="cm-number">19</span>, <span class="cm-number">75</span>, <span class="cm-number">43</span>]) </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">10</span>]: <span class="cm-variable">ndarr_1</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">10</span>]: <span class="cm-variable">array</span>([<span class="cm-number">100</span>, &nbsp; <span class="cm-number">3</span>,  <span class="cm-number">19</span>,  <span class="cm-number">75</span>,  <span class="cm-number">43</span>])</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Create a 2D array from a Python list-of-lists &nbsp;  </span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">11</span>]: <span class="cm-variable">ndarr_2</span> = <span class="cm-variable">np</span>.<span class="cm-property">array</span>([[<span class="cm-number">2</span>, <span class="cm-number">4</span>, <span class="cm-number">6</span>], [<span class="cm-number">3</span>, <span class="cm-number">5</span>, <span class="cm-number">7</span>]])</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">12</span>]: <span class="cm-variable">ndarr_2</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">12</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">array</span>([[<span class="cm-number">2</span>, <span class="cm-number">4</span>, <span class="cm-number">6</span>],</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; [<span class="cm-number">3</span>, <span class="cm-number">5</span>, <span class="cm-number">7</span>]])</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Create a 2D array by reshaping a 1D array</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">14</span>]: <span class="cm-variable">ndarr_3</span> = <span class="cm-variable">np</span>.<span class="cm-property">arange</span>(<span class="cm-number">20</span>).<span class="cm-property">reshape</span>(<span class="cm-number">4</span>, <span class="cm-number">5</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">15</span>]: <span class="cm-variable">ndarr_3</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">15</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">array</span>([[ <span class="cm-number">0</span>,  <span class="cm-number">1</span>,  <span class="cm-number">2</span>,  <span class="cm-number">3</span>,  <span class="cm-number">4</span>],</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; [ <span class="cm-number">5</span>,  <span class="cm-number">6</span>,  <span class="cm-number">7</span>,  <span class="cm-number">8</span>,  <span class="cm-number">9</span>],</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; [<span class="cm-number">10</span>, <span class="cm-number">11</span>, <span class="cm-number">12</span>, <span class="cm-number">13</span>, <span class="cm-number">14</span>],</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; [<span class="cm-number">15</span>, <span class="cm-number">16</span>, <span class="cm-number">17</span>, <span class="cm-number">18</span>, <span class="cm-number">19</span>]])</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Create a 3x3 array filled with random integers</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">16</span>]: <span class="cm-variable">arr_4</span> = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randint</span>(<span class="cm-number">0</span>, <span class="cm-number">100</span>, <span class="cm-number">9</span>).<span class="cm-property">reshape</span>(<span class="cm-number">3</span>, <span class="cm-number">3</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">17</span>]: <span class="cm-variable">arr_4</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">17</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">array</span>([[<span class="cm-number">66</span>, <span class="cm-number">87</span>, <span class="cm-number">41</span>],</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; [<span class="cm-number">49</span>, <span class="cm-number">41</span>, <span class="cm-number">33</span>],</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; [ <span class="cm-number">5</span>, <span class="cm-number">57</span>, <span class="cm-number">78</span>]])</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Create a 4x4 matrix filled with random numbers</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">26</span>]: <span class="cm-variable">arr_5</span> = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">rand</span>(<span class="cm-number">4</span>, <span class="cm-number">4</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">27</span>]: <span class="cm-variable">arr_5</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">27</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">array</span>([[ <span class="cm-number">0.35827069</span>,  <span class="cm-number">0.0687782</span> ,  <span class="cm-number">0.16042925</span>,  <span class="cm-number">0.40275736</span>],</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; [ <span class="cm-number">0.8666519</span> ,  <span class="cm-number">0.66905765</span>,  <span class="cm-number">0.05632903</span>,  <span class="cm-number">0.41828043</span>],</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; [ <span class="cm-number">0.12067091</span>,  <span class="cm-number">0.34682221</span>,  <span class="cm-number">0.68698091</span>,  <span class="cm-number">0.87333071</span>],</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; [ <span class="cm-number">0.72627949</span>,  <span class="cm-number">0.56991059</span>,  <span class="cm-number">0.80397042</span>,  <span class="cm-number">0.50586414</span>]])</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 962px;"></div></div></div></pre><p></p><ul><li><p>Arrays can be <strong>indexed</strong> or <strong>subsetted</strong> by using the <code>[]</code> square brackets accessor with</p><ul><li><p><strong>integer slices</strong> like we&#39;ve seen for Python lists, but here we provide one slice each for rows and columns as ndarrays may be multidimensional</p><ul><li><p>Syntax </p><p><code>ndarr_1[&lt;for rows&gt; start: stop: step, &lt;for columns&gt; start: stop: step]</code></p></li><li><p>Examples</p></li></ul></li></ul></li></ul><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap "><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Using one of the arrays we created above</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">42</span>]: <span class="cm-variable">ndarr_3</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">42</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">array</span>([[ <span class="cm-number">0</span>,  <span class="cm-number">1</span>,  <span class="cm-number">2</span>,  <span class="cm-number">3</span>,  <span class="cm-number">4</span>],</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; [ <span class="cm-number">5</span>,  <span class="cm-number">6</span>,  <span class="cm-number">7</span>,  <span class="cm-number">8</span>,  <span class="cm-number">9</span>],</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; [<span class="cm-number">10</span>, <span class="cm-number">11</span>, <span class="cm-number">12</span>, <span class="cm-number">13</span>, <span class="cm-number">14</span>],</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; [<span class="cm-number">15</span>, <span class="cm-number">16</span>, <span class="cm-number">17</span>, <span class="cm-number">18</span>, <span class="cm-number">19</span>]])</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Subset one element</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">43</span>]: <span class="cm-variable">ndarr_3</span>[<span class="cm-number">0</span>, <span class="cm-number">0</span>]</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">43</span>]: <span class="cm-number">0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Subset the first row &nbsp;  </span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">44</span>]: <span class="cm-variable">ndarr_3</span>[<span class="cm-number">0</span>, :]</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">44</span>]: <span class="cm-variable">array</span>([<span class="cm-number">0</span>, <span class="cm-number">1</span>, <span class="cm-number">2</span>, <span class="cm-number">3</span>, <span class="cm-number">4</span>])</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Subset the first column &nbsp;  </span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">45</span>]: <span class="cm-variable">ndarr_3</span>[:, <span class="cm-number">0</span>]</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">45</span>]: <span class="cm-variable">array</span>([ <span class="cm-number">0</span>,  <span class="cm-number">5</span>, <span class="cm-number">10</span>, <span class="cm-number">15</span>])</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Subset the 2nd and 3rd rows</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">46</span>]: <span class="cm-variable">ndarr_3</span>[<span class="cm-number">1</span>:<span class="cm-number">3</span>, :]</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">46</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">array</span>([[ <span class="cm-number">5</span>,  <span class="cm-number">6</span>,  <span class="cm-number">7</span>,  <span class="cm-number">8</span>,  <span class="cm-number">9</span>],</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; [<span class="cm-number">10</span>, <span class="cm-number">11</span>, <span class="cm-number">12</span>, <span class="cm-number">13</span>, <span class="cm-number">14</span>]])</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Subset the 3rd and 4th columns</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">47</span>]: <span class="cm-variable">ndarr_3</span>[:, <span class="cm-number">2</span>:<span class="cm-number">4</span>]</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">47</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">array</span>([[ <span class="cm-number">2</span>,  <span class="cm-number">3</span>],</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; [ <span class="cm-number">7</span>,  <span class="cm-number">8</span>],</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; [<span class="cm-number">12</span>, <span class="cm-number">13</span>],</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; [<span class="cm-number">17</span>, <span class="cm-number">18</span>]])</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Subset both rows and columns (2nd and 3rd rows and columns)</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">48</span>]: <span class="cm-variable">ndarr_3</span>[<span class="cm-number">1</span>:<span class="cm-number">3</span>, <span class="cm-number">1</span>:<span class="cm-number">3</span>]</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">48</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">array</span>([[ <span class="cm-number">6</span>,  <span class="cm-number">7</span>],</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; [<span class="cm-number">11</span>, <span class="cm-number">12</span>]])</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1014px;"></div></div></div></pre><ul><li><p>using <strong>boolean subsetting</strong>  to select the elements of an array that satisfy some condition</p><blockquote><p><em>Boolean subsetting is the process of created an array of booleans of the same length as the array to be subsetted using logical operations, and passing it to the square brackets subsetter.</em></p></blockquote></li></ul><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap "><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Create an array of numbers</span></span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">57</span>]: <span class="cm-variable">arr_6</span> = <span class="cm-variable">np</span>.<span class="cm-property">arange</span>(<span class="cm-number">15</span>)</span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">58</span>]: <span class="cm-variable">arr_6</span></span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">58</span>]: <span class="cm-variable">array</span>([ <span class="cm-number">0</span>,  <span class="cm-number">1</span>,  <span class="cm-number">2</span>,  <span class="cm-number">3</span>,  <span class="cm-number">4</span>,  <span class="cm-number">5</span>,  <span class="cm-number">6</span>,  <span class="cm-number">7</span>,  <span class="cm-number">8</span>,  <span class="cm-number">9</span>, <span class="cm-number">10</span>, <span class="cm-number">11</span>, <span class="cm-number">12</span>, <span class="cm-number">13</span>, <span class="cm-number">14</span>])</span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Logical operations on arrays produce Boolean arrays &nbsp;  </span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">59</span>]: <span class="cm-variable">arr_6</span> <span class="cm-operator">%</span> <span class="cm-number">2</span> == <span class="cm-number">0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">59</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">array</span>([ <span class="cm-builtin">True</span>, <span class="cm-builtin">False</span>,  <span class="cm-builtin">True</span>, <span class="cm-builtin">False</span>,  <span class="cm-builtin">True</span>, <span class="cm-builtin">False</span>,  <span class="cm-builtin">True</span>, <span class="cm-builtin">False</span>,  <span class="cm-builtin">True</span>,</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; <span class="cm-builtin">False</span>,  <span class="cm-builtin">True</span>, <span class="cm-builtin">False</span>,  <span class="cm-builtin">True</span>, <span class="cm-builtin">False</span>,  <span class="cm-builtin">True</span>], <span class="cm-variable">dtype</span>=<span class="cm-builtin">bool</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Boolean array to subset even numbers </span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">60</span>]: <span class="cm-variable">even_bool</span> = (<span class="cm-variable">arr_6</span> <span class="cm-operator">%</span> <span class="cm-number">2</span> == <span class="cm-number">0</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Boolean subsetting</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">61</span>]: <span class="cm-variable">arr_6</span>[<span class="cm-variable">even_bool</span>]</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">61</span>]: <span class="cm-variable">array</span>([ <span class="cm-number">0</span>,  <span class="cm-number">2</span>,  <span class="cm-number">4</span>,  <span class="cm-number">6</span>,  <span class="cm-number">8</span>, <span class="cm-number">10</span>, <span class="cm-number">12</span>, <span class="cm-number">14</span>])</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 442px;"></div></div></div></pre><h3><a name='header-c248' class='md-header-anchor '></a>Mathematical operations</h3><p>These are carried out <strong>element-wise</strong> and can be specified</p><ul><li>using mathematical operators like <code>+, -, *, /</code></li><li>using NumPy functions like <code>np.add(), np.subtract(), np.multiply(), np.divide()</code></li></ul><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Create two new arrays</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">73</span>]: <span class="cm-variable">x</span> = <span class="cm-variable">np</span>.<span class="cm-property">array</span>([[<span class="cm-number">2</span>, <span class="cm-number">5</span>],[<span class="cm-number">9</span>, <span class="cm-number">6</span>]], <span class="cm-variable">dtype</span>=<span class="cm-variable">np</span>.<span class="cm-property">float64</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">74</span>]: <span class="cm-variable">y</span> = <span class="cm-variable">np</span>.<span class="cm-property">array</span>([[<span class="cm-number">8</span>, <span class="cm-number">4</span>],[<span class="cm-number">3</span>, <span class="cm-number">7</span>]], <span class="cm-variable">dtype</span>=<span class="cm-variable">np</span>.<span class="cm-property">float64</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">75</span>]: <span class="cm-variable">x</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">75</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">array</span>([[ <span class="cm-number">2.</span>,  <span class="cm-number">5.</span>],</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; [ <span class="cm-number">9.</span>,  <span class="cm-number">6.</span>]])</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">76</span>]: <span class="cm-variable">y</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">76</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">array</span>([[ <span class="cm-number">8.</span>,  <span class="cm-number">4.</span>],</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; [ <span class="cm-number">3.</span>,  <span class="cm-number">7.</span>]])</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Add</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">77</span>]: <span class="cm-variable">x</span> <span class="cm-operator">+</span> <span class="cm-variable">y</span> </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">77</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">array</span>([[ <span class="cm-number">10.</span>, &nbsp; <span class="cm-number">9.</span>],</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; [ <span class="cm-number">12.</span>,  <span class="cm-number">13.</span>]])</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Subtract</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">78</span>]: <span class="cm-variable">x</span> <span class="cm-operator">-</span> <span class="cm-variable">y</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">78</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">array</span>([[<span class="cm-operator">-</span><span class="cm-number">6.</span>,  <span class="cm-number">1.</span>],</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; [ <span class="cm-number">6.</span>, <span class="cm-operator">-</span><span class="cm-number">1.</span>]])</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Multiply</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">79</span>]: <span class="cm-variable">x</span> <span class="cm-operator">*</span> <span class="cm-variable">y</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">79</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">array</span>([[ <span class="cm-number">16.</span>,  <span class="cm-number">20.</span>],</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; [ <span class="cm-number">27.</span>,  <span class="cm-number">42.</span>]])</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Divide </span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">81</span>]: <span class="cm-variable">x</span> <span class="cm-operator">/</span> <span class="cm-variable">y</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">81</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">array</span>([[ <span class="cm-number">0.25</span> &nbsp; &nbsp;  ,  <span class="cm-number">1.25</span> &nbsp; &nbsp;  ],</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; [ <span class="cm-number">3.</span> &nbsp; &nbsp; &nbsp;  ,  <span class="cm-number">0.85714286</span>]])</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 910px;"></div></div></div></pre><ul><li>NumPy has universal functions or <code>ufuncs</code> that operate elementwise on an array, producing an array as output. For ex. <code>np.sqrt()</code>, <code>np.abs()</code></li></ul><p></p><h3><a name='header-c1510' class='md-header-anchor '></a>Array <strong>Attributes</strong> and <strong>Methods</strong></h3><p>These include  the following (assume we have an array object called <em>ndarr</em>.)</p><p><img src="numpy_1.png"></p><p>As we saw for methods and attributes of other Python objects, these too can be explored using the in-built help. We will be seeing some of these attributes and methods again with pandas&#39; <code>Series</code> and <code>DataFrame</code> objects.</p><h1><a name='header-c273' class='md-header-anchor '></a>Getting Data into Pandas</h1><p>We start, as always, by importing modules and frequently used classes from the module. 
As per convention, we write</p><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">pandas</span> <span class="cm-keyword">as</span> <span class="cm-variable">pd</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">pandas</span> <span class="cm-keyword">import</span> <span class="cm-variable">Series</span>, <span class="cm-variable">DataFrame</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 52px;"></div></div></div></pre><h2><a name='header-c279' class='md-header-anchor '></a>Reading Flat Files</h2><p><code>pandas</code> has functions such as <code>read_csv, read_table, read_fwf</code> and <code>read_clipboard</code> for reading tabular data into a <code>DataFrame</code> object. These functions take as arguments the following options:**</p><ul><li><p><em>Which columns to consider?</em> <br/></p><ul><li>Import the header (<code>header=</code>) or provide column names (<code>names=</code>)</li></ul></li><li><p><em>Type inference and conversion</em></p><ul><li>Processing dates, combining date and time</li></ul></li><li><p><em>Which column serves as the index?</em> (<code>index_col=</code>)</p><ul><li>For a hierarchical index, pass a list of column names</li></ul></li><li><p><em>Which values to interpret as missing data?</em> (<code>na_values=</code>)</p><ul><li>If there are multiple sentinels for missing data, pass a dictionary</li></ul></li><li><p><em>If the file is too large, read chunks iteratively</em> (<code>nrows=</code> and <code>chunksize=</code>)</p><ul><li>This option is particularly helpful if you&#39;re working with files whose size runs into several gigabytes.</li></ul></li><li><p>Skipping over rows (<code>skiprows=</code>)</p><ul><li>Sometimes data files have metadata in the first few lines before the actual data. </li></ul></li><li><p>Interpreting decimal numbers (points or commas to mark thousands)</p><ul><li>Depending on where you are in the world, floating point numbers are written differently. 
For ex. The value of pi is written as 3.142 in India and most places, while in Europe you would write it as 3,142</li></ul></li></ul><h4><a name='header-c320' class='md-header-anchor '></a>CSV files</h4><p>Reading a CSV is as simple as calling the read_csv function. By default, the read_csv function expects the column separator to be a comma, but you can change that using the sep parameter.</p><p>Syntax:</p><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap "><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"> <span class="cm-variable">pd</span>.<span class="cm-property">read_csv</span>(<span class="cm-variable">filepath</span>, <span class="cm-variable">sep</span>=, <span class="cm-variable">header</span>=, <span class="cm-variable">names</span>=, <span class="cm-variable">skiprows</span>=, <span class="cm-variable">na_values</span>= ... ) </span></pre></div></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 26px;"></div></div></div></pre><p>These functions are also able to pull data from a URL. Just use the URL in place of <code>filepath</code> </p><h4><a name='header-c329' class='md-header-anchor '></a>Excel Files</h4><p>Pandas allows you to read and write Excel files, so you can easily read from Excel, write your code in Python, and then write back out to Excel - no need for VBA. Reading Excel files requires the xlrd library. </p><p>You can install it via pip (<code>pip install xlrd</code>).</p><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap "><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">football</span> = <span class="cm-variable">pd</span>.<span class="cm-property">read_excel</span>(<span class="cm-string">'path_to_excel_file.xlsx'</span>, <span class="cm-string">'sheet1'</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 26px;"></div></div></div></pre><h4><a name='header-c1577' class='md-header-anchor '></a>SQL Databases</h4><p><code>pandas</code> also has great support for reading or writing data directly from or to a database. The workflow consists of </p><ul><li><em>setting up a connection</em> to the database using add-on libraries like <code>sql-alchemy</code> and <code>psycopg2</code> that help in establishing connections to databases like RDBMS and Redshift. </li><li><em>and then passing a SQL query over that connection</em> to the database. The query results, usually in tabular format, are returned to <code>pandas</code> as a <code>DataFrame</code> object.</li></ul><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap  "><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">sqlite3</span> </span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">conn</span> = <span class="cm-variable">sqlite3</span>.<span class="cm-property">connect</span>(<span class="cm-string">'my-sqlite-database.db'</span>)</span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">query</span> = <span class="cm-string">"SELECT * FROM my-sqlite-database LIMIT 10;"</span></span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">df</span> = <span class="cm-variable">pd</span>.<span class="cm-property">read_sql</span>(<span class="cm-variable">query</span>, <span class="cm-variable">con</span>=<span class="cm-variable">conn</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 156px;"></div></div></div></pre><h4><a name='header-c344' class='md-header-anchor '></a>Reading from the Clipboard</h4><p>Sometimes we need to quickly import data from an HTML table or an Excel sheet without needing to import the entire page or workbook. We could then just highlight the required data, hit <code>CTRL + C</code>, move over to pandas and run <code>pd.read_clipboard()</code>. It may be prudent, after the data is imported into your workspace, to back it up using DataFrame methods like <code>to_csv</code></p><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap "><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">df</span> = <span class="cm-variable">pd</span>.<span class="cm-property">read_clipboard</span>()</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 26px;"></div></div></div></pre><p></p><h2><a name='header-c1761' class='md-header-anchor '></a>Pandas Data Structures</h2><p>Pandas has two <strong>workhorse</strong> <strong>data structures</strong> – <em>Series</em> and <em>DataFrame</em> - that provide robust and easy-to-implement solutions to many data analysis tasks. These are built on top of NumPy arrays and inherit many of their methods and functions.</p><p>Operations using these structures include </p><table><thead><tr><th>CREATE</th><th>SUBSET</th><th>INSERT</th><th>UPDATE</th><th>VIEW</th></tr></thead><tbody><tr><td><strong>FILTER</strong></td><td><strong>APPEND</strong></td><td><strong>SORT</strong></td><td><strong>JOIN</strong></td><td><strong>MERGE</strong></td></tr><tr><td><strong>GROUP</strong></td><td><strong>SUMMARIZE</strong></td><td><strong>RESHAPE</strong></td><td><strong>MAP</strong></td><td><strong>APPLY</strong></td></tr></tbody></table><h2><a name='header-c376' class='md-header-anchor '></a>1. Series</h2><p>A <code>Series</code> is a one-dimensional, homogeneous array-like data structure containing a vector of data (of any valid NumPy type) and an associated array of data labels, called its <em>index</em>.</p><h3><a name='header-c379' class='md-header-anchor '></a>1.1 Creation</h3><p>A Series can be created by calling the <code>pd.Series()</code> function on a NumPy 1D array or a Python collection like <code>list, tuple,</code> or <code>dictionary</code>. The index of the Series could be constructed in the same way from one of these objects. If the index isn&#39;t explicitly specified, a numeric vector from 0 to length-1 is automatically generated as the index. Additionally, the user may specify the <em>type</em> and a <em>name</em> while declaring a Series.</p><p>Syntax:</p><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap "><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">pd</span>.<span class="cm-property">Series</span>(<span class="cm-variable">data</span>=, <span class="cm-variable">index</span>=, <span class="cm-variable">dtype</span>=, <span class="cm-variable">name</span>=)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 26px;"></div></div></div></pre><p>Examples:</p><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap "><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code      " style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Basic Series with no explicit index from an array </span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []: <span class="cm-variable">series_1</span> = <span class="cm-variable">pd</span>.<span class="cm-property">Series</span>(<span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">random</span>(<span class="cm-number">5</span>).<span class="cm-property">round</span>(<span class="cm-number">2</span>))</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []: <span class="cm-variable">series_1</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">0</span> &nbsp;  <span class="cm-number">0.03</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">1</span> &nbsp;  <span class="cm-number">0.94</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">2</span> &nbsp;  <span class="cm-number">0.69</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">3</span> &nbsp;  <span class="cm-number">0.16</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">4</span> &nbsp;  <span class="cm-number">0.61</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">dtype</span>: <span class="cm-variable">float64</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 260px;"></div></div></div></pre><p>Here, we created a series called <em>series_1</em> using an array of 5 elements filled with random numbers. The type was induced from the data to be <em>float64</em> and a numeric index was automatically generated. 
Note that this series has no <em>name.</em></p><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap "><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code          " style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Series with an explicit index, dtype and name specification</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []: <span class="cm-variable">series_2</span> = <span class="cm-variable">pd</span>.<span class="cm-property">Series</span>(<span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randint</span>(<span class="cm-number">0</span>, <span class="cm-number">100</span>, <span class="cm-number">5</span>),</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-variable">index</span>=<span class="cm-builtin">list</span>(<span class="cm-string">'abcde'</span>),</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-variable">dtype</span>=<span class="cm-builtin">float</span>,</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-variable">name</span>=<span class="cm-string">'S2'</span>) </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []: <span class="cm-variable">series_2</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">a</span> &nbsp;  <span class="cm-number">60.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">b</span> &nbsp;  <span class="cm-number">13.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">c</span> &nbsp;  <span class="cm-number">54.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">d</span> &nbsp;  <span class="cm-number">13.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">e</span> &nbsp;  <span class="cm-number">65.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Name</span>: <span class="cm-variable">S2</span>, <span class="cm-variable">dtype</span>: <span class="cm-variable">float64</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 338px;"></div></div></div></pre><p>Here, we create a series of random integers, but convert the type to <em>float</em> explicitly. The automatic index is replaced by the one we provide. The name <em>S2</em> is important as it will become the column name if this <code>Series</code> is imported or concatenated into a <code>DataFrame</code>.</p><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># From a numeric list</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []: <span class="cm-variable">pd</span>.<span class="cm-property">Series</span>([<span class="cm-operator">-</span><span class="cm-number">55</span>, <span class="cm-number">4</span>, <span class="cm-number">79</span>, <span class="cm-number">101</span>])</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">0</span> &nbsp;  <span class="cm-operator">-</span><span class="cm-number">55</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">1</span> &nbsp; &nbsp;  <span class="cm-number">4</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">2</span> &nbsp; &nbsp; <span class="cm-number">79</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">3</span> &nbsp;  <span class="cm-number">101</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">dtype</span>: <span class="cm-variable">int64</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># From a tuple</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []: <span class="cm-variable">pd</span>.<span class="cm-property">Series</span>((<span class="cm-number">1</span>, <span class="cm-number">2</span>, <span class="cm-number">3</span>, <span class="cm-number">4</span>))</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">0</span> &nbsp;  <span class="cm-number">1</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">1</span> &nbsp;  <span class="cm-number">2</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">2</span> &nbsp;  <span class="cm-number">3</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">3</span> &nbsp;  <span class="cm-number">4</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">dtype</span>: <span class="cm-variable">int64</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># From a dictionary</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Note that when we use a Python dict to create a Series, the keys become the index.</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []: <span class="cm-variable">pd</span>.<span class="cm-property">Series</span>({<span class="cm-string">'a'</span>: <span class="cm-number">101</span>, <span class="cm-string">'b'</span>: <span class="cm-operator">-</span><span class="cm-number">55</span>, <span class="cm-string">'c'</span>: <span class="cm-number">79</span>, <span class="cm-string">'d'</span>: <span class="cm-number">4</span>})</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">a</span> &nbsp;  <span class="cm-number">101</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">b</span> &nbsp;  <span class="cm-operator">-</span><span class="cm-number">55</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">c</span> &nbsp; &nbsp; <span class="cm-number">79</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">d</span> &nbsp; &nbsp;  <span class="cm-number">4</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">dtype</span>: <span class="cm-variable">int64</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 728px;"></div></div></div></pre><p>A series can be converted into a list or a dictionary using methods like <code>tolist()</code> and <code>to_dict()</code></p><h3><a name='header-c396' class='md-header-anchor '></a>1.2 Series Attributes</h3><p>Just like attributes for primitive Python data structures like <code>Lists</code> or <code>Dictionaries</code> provide useful metadata about the contents of the data structure, we can use <code>Series</code> attributes like <code>values,  index, shape</code> to get the underlying array, the index and the length of the series respectively.</p><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap "><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []: <span class="cm-variable">series_2</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">a</span> &nbsp;  <span class="cm-number">34.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">b</span> &nbsp;  <span class="cm-number">60.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">c</span> &nbsp;  <span class="cm-number">21.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">d</span> &nbsp;  <span class="cm-number">22.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">e</span> &nbsp; &nbsp; <span class="cm-number">7.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Name</span>: <span class="cm-variable">S2</span>, <span class="cm-variable">dtype</span>: <span class="cm-variable">float64</span></span></pre><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  </span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Get the underlying NumPy array</span></span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []: <span class="cm-variable">series_2</span>.<span class="cm-property">values</span></span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[]: <span class="cm-variable">array</span>([ <span class="cm-number">34.</span>,  <span class="cm-number">60.</span>,  <span class="cm-number">21.</span>,  <span class="cm-number">22.</span>, &nbsp; <span class="cm-number">7.</span>])</span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Get the index</span></span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []: <span class="cm-variable">series_2</span>.<span class="cm-property">index</span></span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[]: <span class="cm-variable">Index</span>([<span class="cm-string">u'a'</span>, <span class="cm-string">u'b'</span>, <span class="cm-string">u'c'</span>, <span class="cm-string">u'd'</span>, <span class="cm-string">u'e'</span>], <span class="cm-variable">dtype</span>=<span class="cm-string">'object'</span>)</span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Get the size on disk</span></span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []: <span class="cm-variable">series_2</span>.<span class="cm-property">nbytes</span></span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[]: <span class="cm-number">40</span></span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Get the number of elements</span></span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []: <span class="cm-variable">series_2</span>.<span class="cm-property">shape</span></span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[]: (<span class="cm-number">5</span>,)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 624px;"></div></div></div></pre><h3><a name='header-c402' class='md-header-anchor '></a>1.3 Subsetting a Series</h3><p>There are many ways to extract subsets of a Series in Pandas. In addition to allowing NumPy-like subsetting using integer lists and slices, it is possible to subset a Series using </p><ul><li><em>label-based indexing</em> by passing index labels associated with the values</li><li><em>fancy indexing</em> using methods like <code>loc, iloc, ix, at, iat</code></li><li><em>boolean indexing</em> for subsetting with logical arrays</li></ul><p>Example: Label and integer based indexing on a <em>Breakfast Menu</em> </p><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap "><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">16</span>]: <span class="cm-variable">menu</span> = <span class="cm-variable">Series</span>({<span class="cm-string">'ham'</span>: <span class="cm-number">1</span>, <span class="cm-string">'eggs'</span>: <span class="cm-number">3</span>, <span class="cm-string">'bacon'</span>: <span class="cm-number">2</span>, </span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-string">'coffee'</span>: <span class="cm-number">1</span>, <span class="cm-string">'toast'</span>: <span class="cm-number">0.5</span>, <span class="cm-string">'jam'</span>: <span class="cm-number">0.2</span>})</span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">17</span>]: <span class="cm-variable">menu</span></span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">17</span>]: </span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">bacon</span> &nbsp; &nbsp; <span class="cm-number">2.0</span></span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">coffee</span> &nbsp;  <span class="cm-number">1.0</span></span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">eggs</span> &nbsp; &nbsp;  <span class="cm-number">3.0</span></span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">ham</span> &nbsp; &nbsp; &nbsp; <span class="cm-number">1.0</span></span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">jam</span> &nbsp; &nbsp; &nbsp; <span class="cm-number">0.2</span></span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">toast</span> &nbsp; &nbsp; <span class="cm-number">0.5</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">dtype</span>: <span class="cm-variable">float64</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># A single label</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">18</span>]: <span class="cm-variable">menu</span>[<span class="cm-string">'bacon'</span>]</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">18</span>]: <span class="cm-number">2.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># A list of labels &nbsp;  </span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">19</span>]: <span class="cm-variable">menu</span>[[<span class="cm-string">'eggs'</span>, <span class="cm-string">'bacon'</span>]]</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">19</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">eggs</span> &nbsp; &nbsp; <span class="cm-number">3.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">bacon</span> &nbsp;  <span class="cm-number">2.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">dtype</span>: <span class="cm-variable">float64</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># A slice of labels</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">20</span>]: <span class="cm-variable">menu</span>[<span class="cm-string">'bacon'</span>:<span class="cm-string">'eggs'</span>]</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">20</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">bacon</span> &nbsp; &nbsp; <span class="cm-number">2.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">coffee</span> &nbsp;  <span class="cm-number">1.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">eggs</span> &nbsp; &nbsp;  <span class="cm-number">3.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">dtype</span>: <span class="cm-variable">float64</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Another label slice</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">21</span>]: <span class="cm-variable">menu</span>[<span class="cm-string">'ham'</span>:]</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">21</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">ham</span> &nbsp; &nbsp;  <span class="cm-number">1.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">jam</span> &nbsp; &nbsp;  <span class="cm-number">0.2</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">toast</span> &nbsp;  <span class="cm-number">0.5</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">dtype</span>: <span class="cm-variable">float64</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Positional Slicing</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">22</span>]: <span class="cm-variable">menu</span>[<span class="cm-number">0</span>:<span class="cm-number">3</span>]</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">22</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">bacon</span> &nbsp; &nbsp; <span class="cm-number">2.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">coffee</span> &nbsp;  <span class="cm-number">1.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">eggs</span> &nbsp; &nbsp;  <span class="cm-number">3.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">dtype</span>: <span class="cm-variable">float64</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># More positional slicing</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">24</span>]: <span class="cm-variable">menu</span>[<span class="cm-number">0</span>::<span class="cm-number">2</span>]</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">24</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">bacon</span> &nbsp;  <span class="cm-number">2.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">eggs</span> &nbsp; &nbsp; <span class="cm-number">3.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">jam</span> &nbsp; &nbsp;  <span class="cm-number">0.2</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">dtype</span>: <span class="cm-variable">float64</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Reversing the Series &nbsp;  </span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">23</span>]: <span class="cm-variable">menu</span>[::<span class="cm-operator">-</span><span class="cm-number">1</span>]</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">23</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">toast</span> &nbsp; &nbsp; <span class="cm-number">0.5</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">jam</span> &nbsp; &nbsp; &nbsp; <span class="cm-number">0.2</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">ham</span> &nbsp; &nbsp; &nbsp; <span class="cm-number">1.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">eggs</span> &nbsp; &nbsp;  <span class="cm-number">3.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">coffee</span> &nbsp;  <span class="cm-number">1.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">bacon</span> &nbsp; &nbsp; <span class="cm-number">2.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">dtype</span>: <span class="cm-variable">float64</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1690px;"></div></div></div></pre><ul><li><p>Subsetting with <em>fancy indexing</em> methods<br/></p><ul><li><code>.loc()</code> for label based subsetting</li><li><code>.iloc()</code> for integer based subsetting</li></ul><p>Note that other methods such as <code>.ix()</code> and <code>.at(), .iat()</code> exist, but they serve the same purpose. So we will leave it to the reader to explore these functions in the documentation and pick the one they feel most productive in using.</p></li></ul><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Using loc</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">30</span>]: <span class="cm-variable">menu</span>.<span class="cm-property">loc</span>[<span class="cm-string">'coffee'</span>]</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">30</span>]: <span class="cm-number">1.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">31</span>]: <span class="cm-variable">menu</span>.<span class="cm-property">loc</span>[<span class="cm-string">'eggs'</span>:<span class="cm-string">'jam'</span>]</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">31</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">eggs</span> &nbsp;  <span class="cm-number">3.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">ham</span> &nbsp; &nbsp; <span class="cm-number">1.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">jam</span> &nbsp; &nbsp; <span class="cm-number">0.2</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">dtype</span>: <span class="cm-variable">float64</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Using iloc &nbsp;  </span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">32</span>]: <span class="cm-variable">menu</span>.<span class="cm-property">iloc</span>[<span class="cm-number">3</span>]</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">32</span>]: <span class="cm-number">1.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">33</span>]: <span class="cm-variable">menu</span>.<span class="cm-property">iloc</span>[<span class="cm-number">2</span>:<span class="cm-number">4</span>]</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">33</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">eggs</span> &nbsp;  <span class="cm-number">3.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">ham</span> &nbsp; &nbsp; <span class="cm-number">1.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">dtype</span>: <span class="cm-variable">float64</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 520px;"></div></div></div></pre><ul><li><em>boolean indexing</em> works in the same way as it does for subsetting NumPy arrays. 
We create a boolean of the same length as the Series, (using the same Series), and then pass the boolean to the squre bracket subsetter. </li></ul><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap  "><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Create a boolean series using a logical comparison</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">35</span>]: <span class="cm-variable">menu</span> <span class="cm-operator">&gt;</span> <span class="cm-number">1</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">35</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">bacon</span> &nbsp; &nbsp;  <span class="cm-builtin">True</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">coffee</span> &nbsp;  <span class="cm-builtin">False</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">eggs</span> &nbsp; &nbsp; &nbsp; <span class="cm-builtin">True</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">ham</span> &nbsp; &nbsp; &nbsp; <span class="cm-builtin">False</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">jam</span> &nbsp; &nbsp; &nbsp; <span class="cm-builtin">False</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">toast</span> &nbsp; &nbsp; <span class="cm-builtin">False</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">dtype</span>: <span class="cm-builtin">bool</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Subset the series using the boolean to retain values where True</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">36</span>]: <span class="cm-variable">menu</span>[<span class="cm-variable">menu</span> <span class="cm-operator">&gt;</span> <span class="cm-number">1</span>]</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">36</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">bacon</span> &nbsp;  <span class="cm-number">2.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">eggs</span> &nbsp; &nbsp; <span class="cm-number">3.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">dtype</span>: <span class="cm-variable">float64</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># We can also pass any arbitrary boolean (needs to be of the same length) &nbsp; &nbsp; </span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">37</span>]: <span class="cm-variable">menu</span>[[<span class="cm-builtin">True</span>, <span class="cm-builtin">True</span>, <span class="cm-builtin">False</span>, <span class="cm-builtin">False</span>, <span class="cm-builtin">True</span>, <span class="cm-builtin">False</span>]]</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">37</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">bacon</span> &nbsp; &nbsp; <span class="cm-number">2.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">coffee</span> &nbsp;  <span class="cm-number">1.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">jam</span> &nbsp; &nbsp; &nbsp; <span class="cm-number">0.2</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">dtype</span>: <span class="cm-variable">float64</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 650px;"></div></div></div></pre><h3><a name='header-c439' class='md-header-anchor '></a>1.4 Important Series Methods</h3><p>We&#39;ve just seen a few <code>Series</code> methods that allow us to subset data. There&#39;s a variety of other methods that are useful across the entire spectrum of data wrangling tasks. The figure below shows an exhaustive list of all methods. We will discuss some of the most important ones of these here, and encourage the readers to peruse the latest pandas documentation to explore other methods.</p><p><img src='Series_methods.png' alt='80% center' /></p><h4><a name='header-c1697' class='md-header-anchor '></a>Peeking at the data</h4><ul><li><code>head and tail</code>  are used to view a small sample of a Series or DataFrame object, use the <a href='http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.head.html#pandas.DataFrame.head'><code>head()</code></a> and <a href='http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.tail.html#pandas.DataFrame.tail'><code>tail()</code></a> methods. The default number of elements to display is five, but you may pass a custom number.</li></ul><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap  "><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">44</span>]: <span class="cm-variable">series_8</span> = <span class="cm-variable">Series</span>(<span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">1000</span>).<span class="cm-property">round</span>(<span class="cm-number">2</span>))</span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">45</span>]: <span class="cm-variable">series_8</span>.<span class="cm-property">head</span>()</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">45</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">0</span> &nbsp; <span class="cm-operator">-</span><span class="cm-number">0.23</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">1</span> &nbsp;  <span class="cm-number">0.55</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">2</span> &nbsp;  <span class="cm-number">0.77</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">3</span> &nbsp;  <span class="cm-number">0.18</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">4</span> &nbsp;  <span class="cm-number">0.76</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">dtype</span>: <span class="cm-variable">float64</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">46</span>]: <span class="cm-variable">series_8</span>.<span class="cm-property">tail</span>()</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">46</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">995</span> &nbsp;  <span class="cm-number">0.66</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">996</span> &nbsp; <span class="cm-operator">-</span><span class="cm-number">0.48</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">997</span> &nbsp;  <span class="cm-number">1.13</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">998</span> &nbsp;  <span class="cm-number">1.05</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">999</span> &nbsp;  <span class="cm-number">1.61</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">dtype</span>: <span class="cm-variable">float64</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 494px;"></div></div></div></pre><p></p><h4><a name='header-c452' class='md-header-anchor '></a>Type Conversion</h4><ul><li><code>astype</code> explicitly convert dtypes from one to another</li></ul><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">51</span>]: <span class="cm-variable">series_8</span>.<span class="cm-property">head</span>()</span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">51</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">0</span> &nbsp; <span class="cm-operator">-</span><span class="cm-number">0.23</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">1</span> &nbsp;  <span class="cm-number">0.55</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">2</span> &nbsp;  <span class="cm-number">0.77</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">3</span> &nbsp;  <span class="cm-number">0.18</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">4</span> &nbsp;  <span class="cm-number">0.76</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">dtype</span>: <span class="cm-builtin">float</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">52</span>]: <span class="cm-variable">series_8</span>.<span class="cm-property">astype</span>(<span class="cm-builtin">str</span>).<span class="cm-property">head</span>()</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">52</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">0</span> &nbsp;  <span class="cm-operator">-</span><span class="cm-number">0.23</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">1</span> &nbsp; &nbsp; <span class="cm-number">0.55</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">2</span> &nbsp; &nbsp; <span class="cm-number">0.77</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">3</span> &nbsp; &nbsp; <span class="cm-number">0.18</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">4</span> &nbsp; &nbsp; <span class="cm-number">0.76</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">dtype</span>: <span class="cm-builtin">object</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 442px;"></div></div></div></pre><p></p><h4><a name='header-c460' class='md-header-anchor '></a>Treating Outliers</h4><ul><li><code>clip_upper, clip_lower</code> can be used to clip outliers at a threshold value. All values lower than the one supplied to <code>clip_lower</code>, or higher than the one supplied to <code>clip_upper</code> will be replaced by that value. Note how the values in <em>series_8</em> below are clipped at the supplied threshold of <code>0.50</code></li></ul><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">53</span>]: <span class="cm-variable">series_8</span>.<span class="cm-property">head</span>()</span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">53</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">0</span> &nbsp; <span class="cm-operator">-</span><span class="cm-number">0.23</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">1</span> &nbsp;  <span class="cm-number">0.55</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">2</span> &nbsp;  <span class="cm-number">0.77</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">3</span> &nbsp;  <span class="cm-number">0.18</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">4</span> &nbsp;  <span class="cm-number">0.76</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">dtype</span>: <span class="cm-variable">float64</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">54</span>]: <span class="cm-variable">series_8</span>.<span class="cm-property">head</span>().<span class="cm-property">clip_upper</span>(<span class="cm-number">.50</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">54</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">0</span> &nbsp; <span class="cm-operator">-</span><span class="cm-number">0.23</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">1</span> &nbsp;  <span class="cm-number">0.50</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">2</span> &nbsp;  <span class="cm-number">0.50</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">3</span> &nbsp;  <span class="cm-number">0.18</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">4</span> &nbsp;  <span class="cm-number">0.50</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">dtype</span>: <span class="cm-variable">float64</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">55</span>]: <span class="cm-variable">series_8</span>.<span class="cm-property">head</span>().<span class="cm-property">clip_lower</span>(<span class="cm-number">.50</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">55</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">0</span> &nbsp;  <span class="cm-number">0.50</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">1</span> &nbsp;  <span class="cm-number">0.55</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">2</span> &nbsp;  <span class="cm-number">0.77</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">3</span> &nbsp;  <span class="cm-number">0.50</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">4</span> &nbsp;  <span class="cm-number">0.76</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">dtype</span>: <span class="cm-variable">float64</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 676px;"></div></div></div></pre><p>This function is especially useful in <strong>treating outliers</strong> when used in conjunction with <code>.quantile()</code> 
[PB] In data wrangling, we generally clip values at the 1st-99th Percentile (or the 5th-95th percentile)</p><h4><a name='header-c471' class='md-header-anchor '></a>Replacing Values</h4><ul><li><code>replace</code> is an effective way to replace source values with target values by suppling a dictionary with the required substitutions. </li></ul><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">60</span>]: <span class="cm-variable">fruits</span> = <span class="cm-variable">Series</span>([<span class="cm-string">'apples'</span>, <span class="cm-string">'oranges'</span>, <span class="cm-string">'peaches'</span>, <span class="cm-string">'mangoes'</span>])</span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">61</span>]: <span class="cm-variable">fruits</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">61</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">0</span> &nbsp; &nbsp; <span class="cm-variable">apples</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">1</span> &nbsp;  <span class="cm-variable">oranges</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">2</span> &nbsp;  <span class="cm-variable">peaches</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">3</span> &nbsp;  <span class="cm-variable">mangoes</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">dtype</span>: <span class="cm-builtin">object</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">62</span>]: <span class="cm-variable">fruits</span>.<span class="cm-property">replace</span>({<span class="cm-string">'apples'</span>:<span class="cm-string">'grapes'</span>, <span class="cm-string">'peaches'</span>:<span class="cm-string">'bananas'</span>})</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">62</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">0</span> &nbsp; &nbsp; <span class="cm-variable">grapes</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">1</span> &nbsp;  <span class="cm-variable">oranges</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">2</span> &nbsp;  <span class="cm-variable">bananas</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">3</span> &nbsp;  <span class="cm-variable">mangoes</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">dtype</span>: <span class="cm-builtin">object</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 416px;"></div></div></div></pre><p></p><h4><a name='header-c479' class='md-header-anchor '></a>Checking if values belong to a list</h4><ul><li><code>isin</code> produces a boolean by comparing each element of the Series against the provided list. It takes <code>True</code> if the element belongs to the list. This boolean may then be used for subsetting the Series. </li></ul><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">64</span>]: <span class="cm-variable">fruits</span>.<span class="cm-property">isin</span>([<span class="cm-string">'mangoes'</span>, <span class="cm-string">'oranges'</span>])</span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">64</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">0</span> &nbsp;  <span class="cm-builtin">False</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">1</span> &nbsp; &nbsp; <span class="cm-builtin">True</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">2</span> &nbsp;  <span class="cm-builtin">False</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">3</span> &nbsp; &nbsp; <span class="cm-builtin">True</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">dtype</span>: <span class="cm-builtin">bool</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 182px;"></div></div></div></pre><p></p><h4><a name='header-c487' class='md-header-anchor '></a>Finding uniques and their frequency</h4><ul><li><code>unique, nunique, value_counts</code> These methods are used to find the array of distinct values in a categorical Series, to count the number of distinct items, and to create a frequency table respectively.</li></ul><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">68</span>]: <span class="cm-variable">series_9</span> = <span class="cm-variable">Series</span>(<span class="cm-builtin">list</span>(<span class="cm-string">'abcd'</span> <span class="cm-operator">*</span> <span class="cm-number">3</span>))</span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">69</span>]: <span class="cm-variable">series_9</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">69</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">0</span> &nbsp; &nbsp; <span class="cm-variable">a</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">1</span> &nbsp; &nbsp; <span class="cm-variable">b</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">2</span> &nbsp; &nbsp; <span class="cm-variable">c</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">3</span> &nbsp; &nbsp; <span class="cm-variable">d</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">4</span> &nbsp; &nbsp; <span class="cm-variable">a</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">5</span> &nbsp; &nbsp; <span class="cm-variable">b</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">6</span> &nbsp; &nbsp; <span class="cm-variable">c</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">7</span> &nbsp; &nbsp; <span class="cm-variable">d</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">8</span> &nbsp; &nbsp; <span class="cm-variable">a</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">9</span> &nbsp; &nbsp; <span class="cm-variable">b</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">10</span> &nbsp;  <span class="cm-variable">c</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">11</span> &nbsp;  <span class="cm-variable">d</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">dtype</span>: <span class="cm-builtin">object</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">70</span>]: <span class="cm-variable">series_9</span>.<span class="cm-property">unique</span>()</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">70</span>]: <span class="cm-variable">array</span>([<span class="cm-string">'a'</span>, <span class="cm-string">'b'</span>, <span class="cm-string">'c'</span>, <span class="cm-string">'d'</span>], <span class="cm-variable">dtype</span>=<span class="cm-builtin">object</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">71</span>]: <span class="cm-variable">series_9</span>.<span class="cm-property">nunique</span>()</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">71</span>]: <span class="cm-number">4</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">72</span>]: <span class="cm-variable">series_9</span>.<span class="cm-property">value_counts</span>()</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">72</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">d</span> &nbsp;  <span class="cm-number">3</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">b</span> &nbsp;  <span class="cm-number">3</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">c</span> &nbsp;  <span class="cm-number">3</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">a</span> &nbsp;  <span class="cm-number">3</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">dtype</span>: <span class="cm-variable">int64</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 780px;"></div></div></div></pre><p>All three of these methods prove indespensible while performing visualization and exploratory data analysis (EDA) tasks. 
For ex. The output produced by <code>value_counts()</code> helps us plot bar-charts.</p><h4><a name='header-c495' class='md-header-anchor '></a>Dealing with Duplicates</h4><ul><li><p><code>duplicated</code> produces a boolean that marks every instance of a value after its first occurrence as True. <code>drop_duplicates</code> returns the Series with the duplicates removed. </p><ul><li>If you want to drop duplicated permanently, pass the <code>inplace=True</code> argument.</li></ul></li></ul><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">88</span>]: <span class="cm-variable">series_9</span>.<span class="cm-property">duplicated</span>()</span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">88</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">0</span> &nbsp; &nbsp; <span class="cm-builtin">False</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">1</span> &nbsp; &nbsp; <span class="cm-builtin">False</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">2</span> &nbsp; &nbsp; <span class="cm-builtin">False</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">3</span> &nbsp; &nbsp; <span class="cm-builtin">False</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">4</span> &nbsp; &nbsp;  <span class="cm-builtin">True</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">5</span> &nbsp; &nbsp;  <span class="cm-builtin">True</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">6</span> &nbsp; &nbsp;  <span class="cm-builtin">True</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">7</span> &nbsp; &nbsp;  <span class="cm-builtin">True</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">8</span> &nbsp; &nbsp;  <span class="cm-builtin">True</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">9</span> &nbsp; &nbsp;  <span class="cm-builtin">True</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">10</span> &nbsp; &nbsp; <span class="cm-builtin">True</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">11</span> &nbsp; &nbsp; <span class="cm-builtin">True</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">dtype</span>: <span class="cm-builtin">bool</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">89</span>]: <span class="cm-variable">series_9</span>.<span class="cm-property">drop_duplicates</span>()</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">89</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">0</span> &nbsp;  <span class="cm-variable">a</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">1</span> &nbsp;  <span class="cm-variable">b</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">2</span> &nbsp;  <span class="cm-variable">c</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">3</span> &nbsp;  <span class="cm-variable">d</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">dtype</span>: <span class="cm-builtin">object</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 598px;"></div></div></div></pre><p></p><h4><a name='header-c503' class='md-header-anchor '></a>Finding the largest/smallest values</h4><ul><li><code>idxmax, idxmin, nlargest, nsmallest</code> As their names imply, these methods help in finding the largest, smallest, n-largest and n-smallest respectively. Note that the index label is returned with these values, and this can be especially helpful in EDA.</li></ul><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap "><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">76</span>]: <span class="cm-variable">series_10</span> = <span class="cm-variable">Series</span>(<span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randint</span>(<span class="cm-number">0</span>, <span class="cm-number">50</span>, <span class="cm-number">6</span>), <span class="cm-variable">index</span>=<span class="cm-builtin">list</span>(<span class="cm-string">'xyzabc'</span>))</span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">77</span>]: <span class="cm-variable">series_10</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">77</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">x</span> &nbsp;  <span class="cm-number">21</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">y</span> &nbsp; &nbsp; <span class="cm-number">5</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">z</span> &nbsp;  <span class="cm-number">28</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">a</span> &nbsp;  <span class="cm-number">12</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">b</span> &nbsp;  <span class="cm-number">45</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">c</span> &nbsp; &nbsp; <span class="cm-number">5</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">dtype</span>: <span class="cm-variable">int64</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">78</span>]: <span class="cm-variable">series_10</span>.<span class="cm-property">idxmax</span>()</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">78</span>]: <span class="cm-string">'b'</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">79</span>]: <span class="cm-variable">series_10</span>.<span class="cm-property">idxmin</span>()</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">79</span>]: <span class="cm-string">'y'</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">80</span>]: <span class="cm-variable">series_10</span>.<span class="cm-property">nlargest</span>(<span class="cm-number">2</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">80</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">b</span> &nbsp;  <span class="cm-number">45</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">z</span> &nbsp;  <span class="cm-number">28</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">dtype</span>: <span class="cm-variable">int64</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">81</span>]: <span class="cm-variable">series_10</span>.<span class="cm-property">nsmallest</span>(<span class="cm-number">2</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">81</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">y</span> &nbsp;  <span class="cm-number">5</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">c</span> &nbsp;  <span class="cm-number">5</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">dtype</span>: <span class="cm-variable">int64</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 754px;"></div></div></div></pre><p></p><h4><a name='header-c511' class='md-header-anchor '></a>Sorting the data</h4><ul><li><p><code>sort_values</code>, <code>sort_index</code> help in sorting a Series by values or by index in desired order. The <code>ascending=</code> argument controls the nature of the sort. </p><blockquote><p> <em>[Note] In order to make the sorting permanent, we need to pass the <code>inplace=True</code> argument. The default value <code>inplace=False</code> returns a copy of the Series with the changes made, but the original remains intact. Many other methods like <code>drop_duplicates</code> also take this paramter.</em></p></blockquote></li></ul><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap  "><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">82</span>]: <span class="cm-variable">series_10</span>.<span class="cm-property">sort_values</span>()</span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">82</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">y</span> &nbsp; &nbsp; <span class="cm-number">5</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">c</span> &nbsp; &nbsp; <span class="cm-number">5</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">a</span> &nbsp;  <span class="cm-number">12</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">x</span> &nbsp;  <span class="cm-number">21</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">z</span> &nbsp;  <span class="cm-number">28</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">b</span> &nbsp;  <span class="cm-number">45</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">dtype</span>: <span class="cm-variable">int64</span> &nbsp;  </span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">83</span>]: <span class="cm-variable">series_10</span>.<span class="cm-property">sort_index</span>()</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">83</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">a</span> &nbsp;  <span class="cm-number">12</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">b</span> &nbsp;  <span class="cm-number">45</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">c</span> &nbsp; &nbsp; <span class="cm-number">5</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">x</span> &nbsp;  <span class="cm-number">21</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">y</span> &nbsp; &nbsp; <span class="cm-number">5</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">z</span> &nbsp;  <span class="cm-number">28</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">dtype</span>: <span class="cm-variable">int64</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 494px;"></div></div></div></pre><p></p><h4><a name='header-c520' class='md-header-anchor '></a>Mathematical Summaries</h4><ul><li><code>mean, median, std, quantile, describe</code> are mathematical methods employed to find the measures of central tendency for a given set of data points. <code>quantile</code> finds the requested percentiles, whereas <code>describe</code> produces the summary statistics for the data.
These functions come in handy when we&#39;re exploring data for patterns.</li></ul><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap "><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code " style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Create a long series with numeric values</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">108</span>]: <span class="cm-variable">series_11</span> = <span class="cm-variable">Series</span>(<span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">1000</span>))</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">109</span>]: <span class="cm-variable">series_11</span>.<span class="cm-property">head</span>()</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">109</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">0</span> &nbsp; <span class="cm-operator">-</span><span class="cm-number">0.808280</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">1</span> &nbsp; <span class="cm-operator">-</span><span class="cm-number">0.361064</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">2</span> &nbsp;  <span class="cm-number">1.098265</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">3</span> &nbsp; <span class="cm-operator">-</span><span class="cm-number">0.400104</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">4</span> &nbsp; <span class="cm-operator">-</span><span class="cm-number">0.401763</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">dtype</span>: <span class="cm-variable">float64</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">110</span>]: <span class="cm-variable">series_11</span>.<span class="cm-property">mean</span>()</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">110</span>]: <span class="cm-number">0.010034515870708844</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">111</span>]: <span class="cm-variable">series_11</span>.<span class="cm-property">std</span>()</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">111</span>]: <span class="cm-number">0.9999153362726881</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">112</span>]: <span class="cm-variable">series_11</span>.<span class="cm-property">median</span>()</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">112</span>]: <span class="cm-number">0.008293242730166963</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Find the 10th, 50th and 80th percentile &nbsp;  </span></span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">113</span>]: <span class="cm-variable">series_11</span>.<span class="cm-property">quantile</span>([<span class="cm-number">0.10</span>, <span class="cm-number">0.50</span>, <span class="cm-number">0.80</span>])</span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">113</span>]: </span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">0.1</span> &nbsp; <span class="cm-operator">-</span><span class="cm-number">1.290976</span></span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">0.5</span> &nbsp;  <span class="cm-number">0.008293</span></span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">0.8</span> &nbsp;  <span class="cm-number">0.854793</span></span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">dtype</span>: <span class="cm-variable">float64</span></span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">114</span>]: <span class="cm-variable">series_11</span>.<span class="cm-property">describe</span>()</span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">114</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">count</span> &nbsp;  <span class="cm-number">1000.000000</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">mean</span> &nbsp; &nbsp; &nbsp;  <span class="cm-number">0.010035</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">std</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">0.999915</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-builtin">min</span> &nbsp; &nbsp; &nbsp;  <span class="cm-operator">-</span><span class="cm-number">3.095835</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">25</span><span class="cm-operator">%</span> &nbsp; &nbsp; &nbsp;  <span class="cm-operator">-</span><span class="cm-number">0.665170</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">50</span><span class="cm-operator">%</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">0.008293</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">75</span><span class="cm-operator">%</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">0.693991</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-builtin">max</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">3.762116</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">dtype</span>: <span class="cm-variable">float64</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1040px;"></div></div></div></pre><p></p><h4><a name='header-c529' class='md-header-anchor '></a>Dealing with missing data</h4><ul><li><p><code>isnull, notnull</code> are complementary methods that work on a Series with missing data to produce a boolean Series that identifies missing or non-missing values respectively. </p><blockquote><p> <em>[Note] that both the NumPy <code>np.nan</code> and the base Python <code>None</code> type are identified as missing values.</em></p></blockquote></li></ul><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap  "><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code   " style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">93</span>]: <span class="cm-variable">series_12</span> = <span class="cm-variable">Series</span>([<span class="cm-number">1.12</span>, <span class="cm-number">3.14</span>, <span class="cm-variable">np</span>.<span class="cm-property">nan</span>, <span class="cm-number">6.02</span>, <span class="cm-number">2.73</span>, <span class="cm-builtin">None</span>])</span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">94</span>]: <span class="cm-variable">series_12</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">94</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">0</span> &nbsp;  <span class="cm-number">1.12</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">1</span> &nbsp;  <span class="cm-number">3.14</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">2</span> &nbsp; &nbsp; <span class="cm-variable">NaN</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">3</span> &nbsp;  <span class="cm-number">6.02</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">4</span> &nbsp;  <span class="cm-number">2.73</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">5</span> &nbsp; &nbsp; <span class="cm-variable">NaN</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">dtype</span>: <span class="cm-variable">float64</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Mark the missing values as True</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">95</span>]: <span class="cm-variable">series_12</span>.<span class="cm-property">isnull</span>()</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">95</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">0</span> &nbsp;  <span class="cm-builtin">False</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">1</span> &nbsp;  <span class="cm-builtin">False</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">2</span> &nbsp; &nbsp; <span class="cm-builtin">True</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">3</span> &nbsp;  <span class="cm-builtin">False</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">4</span> &nbsp;  <span class="cm-builtin">False</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">5</span> &nbsp; &nbsp; <span class="cm-builtin">True</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">dtype</span>: <span class="cm-builtin">bool</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Mark the non-missing values as True &nbsp; &nbsp; </span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">96</span>]: <span class="cm-variable">series_12</span>.<span class="cm-property">notnull</span>()</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">96</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">0</span> &nbsp; &nbsp; <span class="cm-builtin">True</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">1</span> &nbsp; &nbsp; <span class="cm-builtin">True</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">2</span> &nbsp;  <span class="cm-builtin">False</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">3</span> &nbsp; &nbsp; <span class="cm-builtin">True</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">4</span> &nbsp; &nbsp; <span class="cm-builtin">True</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">5</span> &nbsp;  <span class="cm-builtin">False</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">dtype</span>: <span class="cm-builtin">bool</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 858px;"></div></div></div></pre><p>These functions may be used in conjunction with <code>sum</code> and <code>apply</code> to find the proportion of missign values in each variable of the imported data. Generally, variables with more than 70- 80% missing values are not useful in data analysis.</p><h4><a name='header-c538' class='md-header-anchor '></a>Missing Values Imputation</h4><ul><li><p><code>fillna, ffill and bfill, dropna</code> This set of Series methods allow us to deal with missing data by choosing to either impute them with a particular value, or by copying the last known value over the missing ones (typically used in time-series analysis.) 
We may sometimes want to drop the missing data altogether and <code>dropna</code> helps us in doing that.</p><blockquote><p><em>[Note] It is a common practice in data science to replace missing values in a numeric variable by its mean (or median if the data is skewed) and in categorical variables with its mode.</em></p></blockquote></li></ul><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap "><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code   " style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">118</span>]: <span class="cm-variable">series_12</span> = <span class="cm-variable">Series</span>([<span class="cm-number">1.12</span>, <span class="cm-number">3.14</span>, <span class="cm-variable">np</span>.<span class="cm-property">nan</span>, <span class="cm-number">6.02</span>, <span class="cm-number">2.73</span>, <span class="cm-builtin">None</span>])</span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Replace missings with 0</span></span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">119</span>]: <span class="cm-variable">series_12</span>.<span class="cm-property">fillna</span>(<span class="cm-number">0</span>)</span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">119</span>]: </span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">0</span> &nbsp;  <span class="cm-number">1.12</span></span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">1</span> &nbsp;  <span class="cm-number">3.14</span></span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">2</span> &nbsp;  <span class="cm-number">0.00</span><span class="cm-variable">s</span></span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">3</span> &nbsp;  <span class="cm-number">6.02</span></span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">4</span> &nbsp;  <span class="cm-number">2.73</span></span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">5</span> &nbsp;  <span class="cm-number">0.00</span></span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">dtype</span>: <span class="cm-variable">float64</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Replace missings with the mean &nbsp;  </span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">120</span>]: <span class="cm-variable">series_12</span>.<span class="cm-property">fillna</span>(<span class="cm-variable">series_12</span>.<span class="cm-property">mean</span>())</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">120</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">0</span> &nbsp;  <span class="cm-number">1.1200</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">1</span> &nbsp;  <span class="cm-number">3.1400</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">2</span> &nbsp;  <span class="cm-number">3.2525</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">3</span> &nbsp;  <span class="cm-number">6.0200</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">4</span> &nbsp;  <span class="cm-number">2.7300</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">5</span> &nbsp;  <span class="cm-number">3.2525</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">dtype</span>: <span class="cm-variable">float64</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Replicate the last non-missing value over the missing ones &nbsp;  </span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">121</span>]: <span class="cm-variable">series_12</span>.<span class="cm-property">ffill</span>()</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">121</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">0</span> &nbsp;  <span class="cm-number">1.12</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">1</span> &nbsp;  <span class="cm-number">3.14</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">2</span> &nbsp;  <span class="cm-number">3.14</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">3</span> &nbsp;  <span class="cm-number">6.02</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">4</span> &nbsp;  <span class="cm-number">2.73</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">5</span> &nbsp;  <span class="cm-number">2.73</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">dtype</span>: <span class="cm-variable">float64</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Return a copy of the Series with missing values removed &nbsp;  </span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">122</span>]: <span class="cm-variable">series_12</span>.<span class="cm-property">dropna</span>()</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">122</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">0</span> &nbsp;  <span class="cm-number">1.12</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">1</span> &nbsp;  <span class="cm-number">3.14</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">3</span> &nbsp;  <span class="cm-number">6.02</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">4</span> &nbsp;  <span class="cm-number">2.73</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">dtype</span>: <span class="cm-variable">float64</span> &nbsp;  </span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1118px;"></div></div></div></pre><p></p><h4><a name='header-c548' class='md-header-anchor '></a>Apply a function to each element</h4><ul><li><code>map</code> is perhaps the <strong>most important</strong> of all Series methods. It takes a <em>general-purpose</em> or <em>user-defined</em> function and applies it to each value in the Series. Combined with base Python&#39;s <em>lambda functions</em>, it can be an incredibly powerful tool in transforming a given Series.
​
Some of you should&#39;ve recalled by now that this sounds like the  <code>map</code> function for List objects in base Python. The <code>.map()</code> method can be understood as a wrapper around that function.</li></ul><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Let's say we have a list of names stored in a Series</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">125</span>]: <span class="cm-variable">series_13</span> = <span class="cm-variable">Series</span>([<span class="cm-string">'Dave Smith'</span>, <span class="cm-string">'Jane Doe'</span>, <span class="cm-string">'Carl James'</span>, <span class="cm-string">'Jim Hunt'</span>])</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">126</span>]: <span class="cm-variable">series_13</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">126</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">0</span> &nbsp;  <span class="cm-variable">Dave</span> <span class="cm-variable">Smith</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">1</span> &nbsp; &nbsp;  <span class="cm-variable">Jane</span> <span class="cm-variable">Doe</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">2</span> &nbsp;  <span class="cm-variable">Carl</span> <span class="cm-variable">James</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">3</span> &nbsp; &nbsp;  <span class="cm-variable">Jim</span> <span class="cm-variable">Hunt</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">dtype</span>: <span class="cm-builtin">object</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Find the length of each name &nbsp;  </span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">126</span>]: <span class="cm-variable">series_13</span>.<span class="cm-property">map</span>(<span class="cm-keyword">lambda</span> <span class="cm-variable">x</span>: <span class="cm-builtin">len</span>(<span class="cm-variable">x</span>))</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">126</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">0</span> &nbsp;  <span class="cm-number">10</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">1</span> &nbsp; &nbsp; <span class="cm-number">8</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">2</span> &nbsp;  <span class="cm-number">10</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">3</span> &nbsp; &nbsp; <span class="cm-number">8</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">dtype</span>: <span class="cm-variable">int64</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Find the initials &nbsp;  </span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">127</span>]: <span class="cm-variable">series_13</span>.<span class="cm-property">map</span>(<span class="cm-keyword">lambda</span> <span class="cm-variable">x</span>: <span class="cm-string">'.'</span>.<span class="cm-property">join</span>([<span class="cm-variable">i</span>[<span class="cm-number">0</span>] <span class="cm-keyword">for</span> <span class="cm-variable">i</span> <span class="cm-keyword">in</span> <span class="cm-variable">x</span>.<span class="cm-property">split</span>(<span class="cm-string">' '</span>)]))</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">127</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">0</span> &nbsp;  <span class="cm-variable">D</span>.<span class="cm-property">S</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">1</span> &nbsp;  <span class="cm-variable">J</span>.<span class="cm-property">D</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">2</span> &nbsp;  <span class="cm-variable">C</span>.<span class="cm-property">J</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">3</span> &nbsp;  <span class="cm-variable">J</span>.<span class="cm-property">H</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">dtype</span>: <span class="cm-builtin">object</span> &nbsp;  </span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 754px;"></div></div></div></pre><p></p><h4><a name='header-c558' class='md-header-anchor '></a>Visualize the Data</h4><ul><li>The <code>plot</code> method is a gateway to a treasure trove of potential visualizations like histograms, bar charts, scatterplots, boxplots and more. As examples, we will visualize a bar chart for a categorical series and the histogram of a numeric variable.</li></ul><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Create a categorical series</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">148</span>]: <span class="cm-variable">series_14</span> = <span class="cm-variable">Series</span>(<span class="cm-builtin">list</span>(<span class="cm-string">'a'</span> <span class="cm-operator">*</span> <span class="cm-number">3</span>) <span class="cm-operator">+</span> <span class="cm-builtin">list</span>(<span class="cm-string">'b'</span> <span class="cm-operator">*</span> <span class="cm-number">5</span>) <span class="cm-operator">+</span> <span class="cm-builtin">list</span>(<span class="cm-string">'c'</span> <span class="cm-operator">*</span> <span class="cm-number">9</span>) <span class="cm-operator">+</span> <span class="cm-builtin">list</span>(<span class="cm-string">'d'</span> <span class="cm-operator">*</span> <span class="cm-number">2</span>))</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">149</span>]: <span class="cm-variable">series_14</span>.<span class="cm-property">head</span>()</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">149</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">0</span> &nbsp;  <span class="cm-variable">a</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">1</span> &nbsp;  <span class="cm-variable">a</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">2</span> &nbsp;  <span class="cm-variable">a</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">3</span> &nbsp;  <span class="cm-variable">b</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">4</span> &nbsp;  <span class="cm-variable">b</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">dtype</span>: <span class="cm-builtin">object</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">150</span>]: <span class="cm-variable">series_14</span>.<span class="cm-property">value_counts</span>().<span class="cm-property">plot</span>.<span class="cm-property">bar</span>() &nbsp;  </span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 364px;"></div></div></div></pre><p><img src='series_plot_2.png' alt='' /></p><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">151</span>]: <span class="cm-variable">series_15</span> = <span class="cm-variable">Series</span>(<span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">1000</span>))</span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">151</span>]: <span class="cm-variable">series_15</span>.<span class="cm-property">head</span>()</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">151</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">0</span> &nbsp;  <span class="cm-number">1.796526</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">1</span> &nbsp;  <span class="cm-number">0.323100</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">2</span> &nbsp; <span class="cm-operator">-</span><span class="cm-number">1.747839</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">3</span> &nbsp; <span class="cm-operator">-</span><span class="cm-number">0.435137</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">4</span> &nbsp;  <span class="cm-number">0.182139</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">dtype</span>: <span class="cm-variable">float64</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">152</span>]: <span class="cm-variable">series_15</span>.<span class="cm-property">plot</span>.<span class="cm-property">hist</span>()</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 312px;"></div></div></div></pre><p><img src='series_plot_1.png' alt='' /></p><p>There are extensive customiztions that we can make to the aesthetics of these plots, but we will explore those features of <code>plot</code> in more detail in the next chapter on Visualizing data. </p><hr /><h2><a name='header-c572' class='md-header-anchor '></a>2. DataFrame</h2><p>It is 2-dimensional <strong>heterogeneous,</strong> <strong>mutable</strong> data structure. It is fundamentally different from NumPy 2D arrays in the sense that here each column can be a different <code>dtype</code>. </p><ul><li><p>Has both a <strong>row and column index</strong> for</p><ul><li>Fast lookups</li><li>Data alignment and joins</li></ul></li><li><p>Is operationally identical tothe R <em>data.frame</em> </p></li><li><p>Can contain <strong>columns of different data types</strong> </p></li><li><p>Can be thought of a dictionary of Series objects. </p></li><li><p>Has a number of associated methods that make data wrangling tasks and basic statisitical analysis very straightforward</p></li></ul><h4><a name='header-c598' class='md-header-anchor '></a>2.1 Creating a DataFrame</h4><p>One of the most common ways of creating a dataframe is from a dictionary of arrays or lists or from NumPy 2D arrays. Here&#39;s the syntax,</p><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">DataFrame</span>(<span class="cm-variable">data</span>=, <span class="cm-variable">index</span>=, <span class="cm-variable">columns</span>=)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 26px;"></div></div></div></pre><p>As was the case with Series, if the <code>index</code> and the <code>columns</code> parameters are not specified, default numeric sequences running from 0 to N-1 will be used.</p><h4><a name='header-c604' class='md-header-anchor '></a>From a 2D Array</h4><p>First we create a DataFrame using all defaults, and then another where we pass index and column labels.</p><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap "><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code " style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre><span style="padding-right: 0.1px;"><span class="cm-comment"># DataFrame with default index and column labels</span></span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">152</span>]: <span class="cm-variable">df_1</span> = <span class="cm-variable">DataFrame</span>(<span class="cm-variable">np</span>.<span class="cm-property">arange</span>(<span class="cm-number">20</span>, <span class="cm-number">32</span>).<span class="cm-property">reshape</span>(<span class="cm-number">3</span>, <span class="cm-number">4</span>))</span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">153</span>]: <span class="cm-variable">df_1</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">153</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-number">0</span> &nbsp; <span class="cm-number">1</span> &nbsp; <span class="cm-number">2</span> &nbsp; <span class="cm-number">3</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">0</span>  <span class="cm-number">20</span>  <span class="cm-number">21</span>  <span class="cm-number">22</span>  <span class="cm-number">23</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">1</span>  <span class="cm-number">24</span>  <span class="cm-number">25</span>  <span class="cm-number">26</span>  <span class="cm-number">27</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">2</span>  <span class="cm-number">28</span>  <span class="cm-number">29</span>  <span class="cm-number">30</span>  <span class="cm-number">31</span></span></pre><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"> </span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># DataFrame with explicit index and column labels</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">155</span>]: <span class="cm-variable">df_2</span> = <span class="cm-variable">DataFrame</span>(<span class="cm-variable">data</span> = <span class="cm-variable">np</span>.<span class="cm-property">arange</span>(<span class="cm-number">20</span>, <span class="cm-number">32</span>).<span class="cm-property">reshape</span>(<span class="cm-number">3</span>, <span class="cm-number">4</span>), </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">columns</span> = <span class="cm-builtin">list</span>(<span class="cm-string">'WXYZ'</span>), </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">index</span> = <span class="cm-builtin">list</span>(<span class="cm-string">'ABC'</span>))</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">156</span>]: <span class="cm-variable">df_2</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">156</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-variable">W</span> &nbsp; <span class="cm-variable">X</span> &nbsp; <span class="cm-variable">Y</span> &nbsp; <span class="cm-variable">Z</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">A</span>  <span class="cm-number">20</span>  <span class="cm-number">21</span>  <span class="cm-number">22</span>  <span class="cm-number">23</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">B</span>  <span class="cm-number">24</span>  <span class="cm-number">25</span>  <span class="cm-number">26</span>  <span class="cm-number">27</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">C</span>  <span class="cm-number">28</span>  <span class="cm-number">29</span>  <span class="cm-number">30</span>  <span class="cm-number">31</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 520px;"></div></div></div></pre><p></p><h4><a name='header-c610' class='md-header-anchor '></a>Using a Dict of equal length Lists</h4><p>The keys of the dictionary will be used as column names, the values will form the data in the table. We can optionally provide a list of strings to be used as the index labels.</p><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap "><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code  " style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">157</span>]: <span class="cm-variable">dict_1</span> = {<span class="cm-string">'ints'</span>: <span class="cm-variable">np</span>.<span class="cm-property">arange</span>(<span class="cm-number">5</span>),</span></pre></div><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-string">'floats'</span>: <span class="cm-variable">np</span>.<span class="cm-property">arange</span>(<span class="cm-number">0.1</span>, <span class="cm-number">0.6</span>, <span class="cm-number">0.1</span>),</span></pre><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-string">'strings'</span>: <span class="cm-builtin">list</span>(<span class="cm-string">'abcde'</span>)}</span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">158</span>]: <span class="cm-variable">df3</span> = <span class="cm-variable">DataFrame</span>(<span class="cm-variable">dict_1</span>, <span class="cm-variable">index</span>=<span class="cm-builtin">list</span>(<span class="cm-string">'vwxyz'</span>))</span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  </span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">159</span>]: <span class="cm-variable">df3</span></span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">159</span>]: </span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"> &nbsp; <span class="cm-variable cm-error">floats</span>  <span class="cm-variable">ints</span> <span class="cm-variable">strings</span></span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">v</span> &nbsp; &nbsp; <span class="cm-number">0.1</span> &nbsp; &nbsp; <span class="cm-number">0</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">a</span></span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">w</span> &nbsp; &nbsp; <span class="cm-number">0.2</span> &nbsp; &nbsp; <span class="cm-number">1</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">b</span></span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">x</span> &nbsp; &nbsp; <span class="cm-number">0.3</span> &nbsp; &nbsp; <span class="cm-number">2</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">c</span></span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">y</span> &nbsp; &nbsp; <span class="cm-number">0.4</span> &nbsp; &nbsp; <span class="cm-number">3</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">d</span></span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">z</span> &nbsp; &nbsp; <span class="cm-number">0.5</span> &nbsp; &nbsp; <span class="cm-number">4</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">e</span> &nbsp;  </span></pre></div></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 364px;"></div></div></div></pre><p></p><h4><a name='header-c617' class='md-header-anchor '></a>DataFrame Attributes</h4><p>Some of the most commonly used ones are – <code>index, columns, dtypes, shape, info</code></p><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Get row labels</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">161</span>]: <span class="cm-variable">df3</span>.<span class="cm-property">index</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">161</span>]: <span class="cm-variable">Index</span>([<span class="cm-string">u'v'</span>, <span class="cm-string">u'w'</span>, <span class="cm-string">u'x'</span>, <span class="cm-string">u'y'</span>, <span class="cm-string">u'z'</span>], <span class="cm-variable">dtype</span>=<span class="cm-string">'object'</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Get column labels</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">162</span>]: <span class="cm-variable">df3</span>.<span class="cm-property">columns</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">162</span>]: <span class="cm-variable">Index</span>([<span class="cm-string">u'floats'</span>, <span class="cm-string">u'ints'</span>, <span class="cm-string">u'strings'</span>], <span class="cm-variable">dtype</span>=<span class="cm-string">'object'</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Get data types for each column</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">163</span>]: <span class="cm-variable">df3</span>.<span class="cm-property">dtypes</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">163</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">floats</span> &nbsp; &nbsp; <span class="cm-variable">float64</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">ints</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">int64</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">strings</span> &nbsp; &nbsp; <span class="cm-builtin">object</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">dtype</span>: <span class="cm-builtin">object</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Get number of rows, columns</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">164</span>]: <span class="cm-variable">df3</span>.<span class="cm-property">shape</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">164</span>]: (<span class="cm-number">5</span>, <span class="cm-number">3</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Get overview of the dataset</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">165</span>]: <span class="cm-variable">df3</span>.<span class="cm-property">info</span>()</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-operator">&lt;</span><span class="cm-keyword">class</span> <span class="cm-string">'pandas.core.frame.DataFrame'</span><span class="cm-operator">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Index</span>: <span class="cm-number">5</span> <span class="cm-variable">entries</span>, <span class="cm-variable">v</span> <span class="cm-variable">to</span> <span class="cm-variable">z</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Data</span> <span class="cm-variable">columns</span> (<span class="cm-variable">total</span> <span class="cm-number">3</span> <span class="cm-variable">columns</span>):</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">floats</span> &nbsp; &nbsp; <span class="cm-number">5</span> <span class="cm-variable">non</span><span class="cm-operator">-</span><span class="cm-variable">null</span> <span class="cm-variable">float64</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">ints</span> &nbsp; &nbsp; &nbsp; <span class="cm-number">5</span> <span class="cm-variable">non</span><span class="cm-operator">-</span><span class="cm-variable">null</span> <span class="cm-variable">int64</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">strings</span> &nbsp;  <span class="cm-number">5</span> <span class="cm-variable">non</span><span class="cm-operator">-</span><span class="cm-variable">null</span> <span class="cm-builtin">object</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">dtypes</span>: <span class="cm-variable">float64</span>(<span class="cm-number">1</span>), <span class="cm-variable">int64</span>(<span class="cm-number">1</span>), <span class="cm-builtin">object</span>(<span class="cm-number">1</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">memory</span> <span class="cm-variable">usage</span>: <span class="cm-number">160.0</span><span class="cm-operator">+</span> <span class="cm-variable">bytes</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 780px;"></div></div></div></pre><h2><a name='header-c621' class='md-header-anchor '></a>Subsetting DataFrames</h2><p>Pandas allows us to subset DataFrames in a variety of ways to extract from a given dataset </p><ul><li>a value</li><li>a row or a column (returns a Series)</li><li>multiple rows/columns (returns a subset of the DataFrame )</li></ul><p>Let&#39;s look at a few examples of these</p><h4><a name='header-c636' class='md-header-anchor '></a>Selecting a single Row/Column</h4><p>For a DataFrame, basic indexing selects the columns.  An individual column can be retrieved as a Series using (a) the square bracket accessor (b) the dot accessor, or (c) one of the accessors - <code>loc, iloc, ix</code> etc.</p><p><strong>Syntax</strong></p><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap "><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">df</span>[<span class="cm-string">'column_name'</span>]</span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">df</span>.<span class="cm-property">column_name</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">df</span>.<span class="cm-property">loc</span>[:, <span class="cm-string">'column_name'</span>]</span></pre><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">df</span>.<span class="cm-property">iloc</span>[:, <span class="cm-variable">column_number</span>]</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 156px;"></div></div></div></pre><p><strong>Examples</strong></p><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># The DataFrame</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">169</span>]: <span class="cm-variable">df3</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">169</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; <span class="cm-variable cm-error">floats</span>  <span class="cm-variable">ints</span> <span class="cm-variable">strings</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">v</span> &nbsp; &nbsp; <span class="cm-number">0.1</span> &nbsp; &nbsp; <span class="cm-number">0</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">a</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">w</span> &nbsp; &nbsp; <span class="cm-number">0.2</span> &nbsp; &nbsp; <span class="cm-number">1</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">b</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">x</span> &nbsp; &nbsp; <span class="cm-number">0.3</span> &nbsp; &nbsp; <span class="cm-number">2</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">c</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">y</span> &nbsp; &nbsp; <span class="cm-number">0.4</span> &nbsp; &nbsp; <span class="cm-number">3</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">d</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">z</span> &nbsp; &nbsp; <span class="cm-number">0.5</span> &nbsp; &nbsp; <span class="cm-number">4</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">e</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Using a column label with the square bracket accessor</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">170</span>]: <span class="cm-variable">df3</span>[<span class="cm-string">'floats'</span>]</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">170</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">v</span> &nbsp;  <span class="cm-number">0.1</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">w</span> &nbsp;  <span class="cm-number">0.2</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">x</span> &nbsp;  <span class="cm-number">0.3</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">y</span> &nbsp;  <span class="cm-number">0.4</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">z</span> &nbsp;  <span class="cm-number">0.5</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Name</span>: <span class="cm-variable">floats</span>, <span class="cm-variable">dtype</span>: <span class="cm-variable">float64</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Using a column label with the dot accessor</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">171</span>]: <span class="cm-variable">df3</span>.<span class="cm-property">ints</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">171</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">v</span> &nbsp;  <span class="cm-number">0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">w</span> &nbsp;  <span class="cm-number">1</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">x</span> &nbsp;  <span class="cm-number">2</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">y</span> &nbsp;  <span class="cm-number">3</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">z</span> &nbsp;  <span class="cm-number">4</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Name</span>: <span class="cm-variable">ints</span>, <span class="cm-variable">dtype</span>: <span class="cm-variable">int64</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Using .loc and a column label</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">172</span>]: <span class="cm-variable">df3</span>.<span class="cm-property">loc</span>[:, <span class="cm-string">'strings'</span>]</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">172</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">v</span> &nbsp;  <span class="cm-variable">a</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">w</span> &nbsp;  <span class="cm-variable">b</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">x</span> &nbsp;  <span class="cm-variable">c</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">y</span> &nbsp;  <span class="cm-variable">d</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">z</span> &nbsp;  <span class="cm-variable">e</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Name</span>: <span class="cm-variable">strings</span>, <span class="cm-variable">dtype</span>: <span class="cm-builtin">object</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Using .iloc and a column position &nbsp; &nbsp;  </span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">173</span>]: <span class="cm-variable">df3</span>.<span class="cm-property">iloc</span>[:, <span class="cm-number">0</span>]</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">173</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">v</span> &nbsp;  <span class="cm-number">0.1</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">w</span> &nbsp;  <span class="cm-number">0.2</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">x</span> &nbsp;  <span class="cm-number">0.3</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">y</span> &nbsp;  <span class="cm-number">0.4</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">z</span> &nbsp;  <span class="cm-number">0.5</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Name</span>: <span class="cm-variable">floats</span>, <span class="cm-variable">dtype</span>: <span class="cm-variable">float64</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Using .loc and a row label &nbsp; &nbsp; &nbsp;  </span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">174</span>]: <span class="cm-variable">df3</span>.<span class="cm-property">loc</span>[<span class="cm-string">'v'</span>]</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">174</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">floats</span> &nbsp; &nbsp; <span class="cm-number">0.1</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">ints</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">strings</span> &nbsp; &nbsp;  <span class="cm-variable">a</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Name</span>: <span class="cm-variable">v</span>, <span class="cm-variable">dtype</span>: <span class="cm-builtin">object</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Using .iloc and a row position &nbsp; &nbsp; &nbsp;  </span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">175</span>]: <span class="cm-variable">df3</span>.<span class="cm-property">iloc</span>[<span class="cm-number">3</span>]</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">175</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">floats</span> &nbsp; &nbsp; <span class="cm-number">0.4</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">ints</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">3</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">strings</span> &nbsp; &nbsp;  <span class="cm-variable">d</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Name</span>: <span class="cm-variable">y</span>, <span class="cm-variable">dtype</span>: <span class="cm-builtin">object</span> &nbsp; &nbsp; &nbsp;  </span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1690px;"></div></div></div></pre><p></p><h4><a name='header-c647' class='md-header-anchor '></a>Selecting 2 or more rows/columns</h4><p>This can be accomplished by</p><ul><li>passing a list of column labels to the double square bracket accessor like <code>[[list-of-columns]]</code></li><li>passing a list or slice of row/column labels/positions to <code>loc, iloc, ix</code></li><li>passing a boolean series to <code>loc, iloc, ix</code> for selecting particular rows/columns</li></ul><p>Each time we subset 2 or more rows/columns from a DataFrame, the result will be a DataFrame.</p><p><strong>Syntax</strong> for <code>loc, iloc, ix</code></p><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap "><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code     " style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># loc is label based</span></span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">df</span>.<span class="cm-property">loc</span>[<span class="cm-variable">list_or_slice_of_row_labels</span>, <span class="cm-variable">list_or_slice_of_column_labels</span>]</span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">df</span>.<span class="cm-property">loc</span>[<span class="cm-variable">boolean_for_rows</span>, <span class="cm-variable">boolean_for_columns</span>]</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># iloc is integer based</span></span></pre><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">df</span>.<span class="cm-property">iloc</span>[<span class="cm-variable">row_positions</span>, <span class="cm-variable">column_positions</span>]</span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># ix is a mix of the two (takes both labels, positions)</span></span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">df</span>.<span class="cm-property">ix</span>[<span class="cm-variable">row_positions_or_labels</span>, <span class="cm-variable">column_position_or_labels</span>]</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 234px;"></div></div></div></pre><p><strong>Examples</strong></p><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap "><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Create a new DataFrame</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">183</span>]: <span class="cm-variable">df4</span> = <span class="cm-variable">DataFrame</span>(<span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randint</span>(<span class="cm-number">0</span>, <span class="cm-number">100</span>, <span class="cm-number">25</span>).<span class="cm-property">reshape</span>(<span class="cm-number">5</span>, <span class="cm-number">5</span>), </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-variable">index</span>=<span class="cm-builtin">list</span>(<span class="cm-string">'ABCDE'</span>), <span class="cm-variable">columns</span>=<span class="cm-builtin">list</span>(<span class="cm-string">'PQRST'</span>))</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">184</span>]: <span class="cm-variable">df4</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">184</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-variable">P</span> &nbsp; <span class="cm-variable">Q</span> &nbsp; <span class="cm-variable">R</span> &nbsp; <span class="cm-variable">S</span> &nbsp; <span class="cm-variable">T</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">A</span>  <span class="cm-number">42</span>  <span class="cm-number">22</span> &nbsp; <span class="cm-number">5</span>  <span class="cm-number">10</span>  <span class="cm-number">28</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">B</span>  <span class="cm-number">17</span>  <span class="cm-number">85</span>  <span class="cm-number">17</span>  <span class="cm-number">26</span>  <span class="cm-number">20</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">C</span>  <span class="cm-number">48</span>  <span class="cm-number">53</span> &nbsp; <span class="cm-number">3</span>  <span class="cm-number">35</span>  <span class="cm-number">79</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">D</span>  <span class="cm-number">80</span>  <span class="cm-number">29</span> &nbsp; <span class="cm-number">0</span>  <span class="cm-number">24</span>  <span class="cm-number">85</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">E</span>  <span class="cm-number">71</span>  <span class="cm-number">66</span>  <span class="cm-number">30</span>  <span class="cm-number">31</span>  <span class="cm-number">32</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Subset multiple columns using [[]]</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">185</span>]: <span class="cm-variable">df4</span>[[<span class="cm-string">'R'</span>, <span class="cm-string">'S'</span>, <span class="cm-string">'T'</span>]]</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">185</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-variable">R</span> &nbsp; <span class="cm-variable">S</span> &nbsp; <span class="cm-variable">T</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">A</span> &nbsp; <span class="cm-number">5</span>  <span class="cm-number">10</span>  <span class="cm-number">28</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">B</span>  <span class="cm-number">17</span>  <span class="cm-number">26</span>  <span class="cm-number">20</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">C</span> &nbsp; <span class="cm-number">3</span>  <span class="cm-number">35</span>  <span class="cm-number">79</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">D</span> &nbsp; <span class="cm-number">0</span>  <span class="cm-number">24</span>  <span class="cm-number">85</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">E</span>  <span class="cm-number">30</span>  <span class="cm-number">31</span>  <span class="cm-number">32</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Subset multiple columns using .loc</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">187</span>]: <span class="cm-variable">df4</span>.<span class="cm-property">loc</span>[:, [<span class="cm-string">'R'</span>, <span class="cm-string">'S'</span>, <span class="cm-string">'T'</span>]] </span></pre><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; <span class="cm-comment"># or df4.loc[:, ['R':'T']] &nbsp; &nbsp; </span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">187</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-variable">R</span> &nbsp; <span class="cm-variable">S</span> &nbsp; <span class="cm-variable">T</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">A</span> &nbsp; <span class="cm-number">5</span>  <span class="cm-number">10</span>  <span class="cm-number">28</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">B</span>  <span class="cm-number">17</span>  <span class="cm-number">26</span>  <span class="cm-number">20</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">C</span> &nbsp; <span class="cm-number">3</span>  <span class="cm-number">35</span>  <span class="cm-number">79</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">D</span> &nbsp; <span class="cm-number">0</span>  <span class="cm-number">24</span>  <span class="cm-number">85</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">E</span>  <span class="cm-number">30</span>  <span class="cm-number">31</span>  <span class="cm-number">32</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Subset multiple columns using .iloc</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">188</span>]: <span class="cm-variable">df4</span>.<span class="cm-property">iloc</span>[:, <span class="cm-number">2</span>:]</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">188</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-variable">R</span> &nbsp; <span class="cm-variable">S</span> &nbsp; <span class="cm-variable">T</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">A</span> &nbsp; <span class="cm-number">5</span>  <span class="cm-number">10</span>  <span class="cm-number">28</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">B</span>  <span class="cm-number">17</span>  <span class="cm-number">26</span>  <span class="cm-number">20</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">C</span> &nbsp; <span class="cm-number">3</span>  <span class="cm-number">35</span>  <span class="cm-number">79</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">D</span> &nbsp; <span class="cm-number">0</span>  <span class="cm-number">24</span>  <span class="cm-number">85</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">E</span>  <span class="cm-number">30</span>  <span class="cm-number">31</span>  <span class="cm-number">32</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Select multiple rows using []</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">186</span>]: <span class="cm-variable">df4</span>[<span class="cm-string">'C'</span>:<span class="cm-string">'E'</span>]</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">186</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-variable">P</span> &nbsp; <span class="cm-variable">Q</span> &nbsp; <span class="cm-variable">R</span> &nbsp; <span class="cm-variable">S</span> &nbsp; <span class="cm-variable">T</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">C</span>  <span class="cm-number">48</span>  <span class="cm-number">53</span> &nbsp; <span class="cm-number">3</span>  <span class="cm-number">35</span>  <span class="cm-number">79</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">D</span>  <span class="cm-number">80</span>  <span class="cm-number">29</span> &nbsp; <span class="cm-number">0</span>  <span class="cm-number">24</span>  <span class="cm-number">85</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">E</span>  <span class="cm-number">71</span>  <span class="cm-number">66</span>  <span class="cm-number">30</span>  <span class="cm-number">31</span>  <span class="cm-number">32</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Subset multiple rows using .loc</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">189</span>]: <span class="cm-variable">df4</span>.<span class="cm-property">loc</span>[<span class="cm-string">'B'</span>:<span class="cm-string">'D'</span>, :]</span></pre><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; <span class="cm-comment"># or df4.loc[['B', 'C', 'D'], :]  </span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">189</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-variable">P</span> &nbsp; <span class="cm-variable">Q</span> &nbsp; <span class="cm-variable">R</span> &nbsp; <span class="cm-variable">S</span> &nbsp; <span class="cm-variable">T</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">B</span>  <span class="cm-number">17</span>  <span class="cm-number">85</span>  <span class="cm-number">17</span>  <span class="cm-number">26</span>  <span class="cm-number">20</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">C</span>  <span class="cm-number">48</span>  <span class="cm-number">53</span> &nbsp; <span class="cm-number">3</span>  <span class="cm-number">35</span>  <span class="cm-number">79</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">D</span>  <span class="cm-number">80</span>  <span class="cm-number">29</span> &nbsp; <span class="cm-number">0</span>  <span class="cm-number">24</span>  <span class="cm-number">85</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Subset multiple rows using .iloc</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">191</span>]: <span class="cm-variable">df4</span>.<span class="cm-property">iloc</span>[<span class="cm-number">2</span>:<span class="cm-number">4</span>, :]</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">191</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-variable">P</span> &nbsp; <span class="cm-variable">Q</span>  <span class="cm-variable">R</span> &nbsp; <span class="cm-variable">S</span> &nbsp; <span class="cm-variable">T</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">C</span>  <span class="cm-number">48</span>  <span class="cm-number">53</span>  <span class="cm-number">3</span>  <span class="cm-number">35</span>  <span class="cm-number">79</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">D</span>  <span class="cm-number">80</span>  <span class="cm-number">29</span>  <span class="cm-number">0</span>  <span class="cm-number">24</span>  <span class="cm-number">85</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Mixed subsetting with ix</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">194</span>]: <span class="cm-variable">df4</span>.<span class="cm-property">ix</span>[<span class="cm-number">2</span>:<span class="cm-number">4</span>, <span class="cm-string">'P'</span>:<span class="cm-string">'R'</span>]</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">194</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-variable">P</span> &nbsp; <span class="cm-variable">Q</span>  <span class="cm-variable">R</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">C</span>  <span class="cm-number">48</span>  <span class="cm-number">53</span>  <span class="cm-number">3</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">D</span>  <span class="cm-number">80</span>  <span class="cm-number">29</span>  <span class="cm-number">0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">195</span>]: <span class="cm-variable">df4</span>.<span class="cm-property">ix</span>[<span class="cm-number">3</span>:, [<span class="cm-string">'S'</span>, <span class="cm-string">'T'</span>]]</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">195</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-variable">S</span> &nbsp; <span class="cm-variable">T</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">D</span>  <span class="cm-number">24</span>  <span class="cm-number">85</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">E</span>  <span class="cm-number">31</span>  <span class="cm-number">32</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 2054px;"></div></div></div></pre><p>For a beginner, so many ways of subsetting data may seem intimidating at first and confusing at worst. The prudent thing to do here would be to pick your favorite method of subsetting data from a DataFrame, and stick to it. If you find that you&#39;re more comfortable using <code>ix</code> over <code>loc, iloc</code>, by all means, use that method. Remember that these are just <em>tools</em> and your focus should be more on the analysis and less on the selection of the best tool for the job. </p><blockquote><p><em>[NOTE] The columns returned when indexing a DataFrame are a view on the underlying data, not a copy. Thus, any in-place modifications to the Series will be reflected in the original DataFrame. The column can be explicitly copied using the Series <code>.copy()</code> method.</em></p></blockquote><h2><a name='header-c675' class='md-header-anchor '></a>Adding, Removing, Renaming Columns or Rows</h2><p>The DataFrame methods <code>assign, drop</code> and <code>rename</code> come in handy for these tasks.</p><ul><li>New variables may  be created by simply using a column label that doesn&#39;t exist in our data with the square bracket or the <code>loc</code> accessor. This method permanently adds a new column to the data.</li><li><code>assign</code> is for creating new variables on the fly, or for deriving new columns from existing ones. This method returns a copy of the DataFrame, so you should overwrite the original if you want to retain the created column in subsequent operations. 

Note the peculiar syntax in the code box below. Lambda functions are required.</li></ul><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap "><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code  " style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># for creating permanent new columns</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">205</span>]: <span class="cm-variable">df4</span>[<span class="cm-string">'U'</span>] = <span class="cm-variable">df4</span>[<span class="cm-string">'P'</span>] <span class="cm-operator">+</span> <span class="cm-variable">df4</span>[<span class="cm-string">'Q'</span>]</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">206</span>]: <span class="cm-variable">df4</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">206</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-variable">P</span> &nbsp; <span class="cm-variable">Q</span> &nbsp; <span class="cm-variable">R</span> &nbsp; <span class="cm-variable">S</span> &nbsp; <span class="cm-variable">T</span> &nbsp;  <span class="cm-variable">U</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">A</span>  <span class="cm-number">42</span>  <span class="cm-number">22</span> &nbsp; <span class="cm-number">5</span>  <span class="cm-number">10</span>  <span class="cm-number">28</span> &nbsp; <span class="cm-number">64</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">B</span>  <span class="cm-number">17</span>  <span class="cm-number">85</span>  <span class="cm-number">17</span>  <span class="cm-number">26</span>  <span class="cm-number">20</span>  <span class="cm-number">102</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">C</span>  <span class="cm-number">48</span>  <span class="cm-number">53</span> &nbsp; <span class="cm-number">3</span>  <span class="cm-number">35</span>  <span class="cm-number">79</span>  <span class="cm-number">101</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">D</span>  <span class="cm-number">80</span>  <span class="cm-number">29</span> &nbsp; <span class="cm-number">0</span>  <span class="cm-number">24</span>  <span class="cm-number">85</span>  <span class="cm-number">109</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">E</span>  <span class="cm-number">71</span>  <span class="cm-number">66</span>  <span class="cm-number">30</span>  <span class="cm-number">31</span>  <span class="cm-number">32</span>  <span class="cm-number">137</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># for creating columns on the fly</span></span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">207</span>]: <span class="cm-variable">df4</span>.<span class="cm-property">assign</span>(<span class="cm-variable">U</span> = <span class="cm-keyword">lambda</span> <span class="cm-variable">x</span>: <span class="cm-variable">x</span>[<span class="cm-string">'P'</span>] <span class="cm-operator">+</span> <span class="cm-variable">x</span>[<span class="cm-string">'Q'</span>])</span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">207</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-variable">P</span> &nbsp; <span class="cm-variable">Q</span> &nbsp; <span class="cm-variable">R</span> &nbsp; <span class="cm-variable">S</span> &nbsp; <span class="cm-variable">T</span> &nbsp;  <span class="cm-variable">U</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">A</span>  <span class="cm-number">42</span>  <span class="cm-number">22</span> &nbsp; <span class="cm-number">5</span>  <span class="cm-number">10</span>  <span class="cm-number">28</span> &nbsp; <span class="cm-number">64</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">B</span>  <span class="cm-number">17</span>  <span class="cm-number">85</span>  <span class="cm-number">17</span>  <span class="cm-number">26</span>  <span class="cm-number">20</span>  <span class="cm-number">102</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">C</span>  <span class="cm-number">48</span>  <span class="cm-number">53</span> &nbsp; <span class="cm-number">3</span>  <span class="cm-number">35</span>  <span class="cm-number">79</span>  <span class="cm-number">101</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">D</span>  <span class="cm-number">80</span>  <span class="cm-number">29</span> &nbsp; <span class="cm-number">0</span>  <span class="cm-number">24</span>  <span class="cm-number">85</span>  <span class="cm-number">109</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">E</span>  <span class="cm-number">71</span>  <span class="cm-number">66</span>  <span class="cm-number">30</span>  <span class="cm-number">31</span>  <span class="cm-number">32</span>  <span class="cm-number">137</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 520px;"></div></div></div></pre><p></p><ul><li><code>drop</code> returns a copy of the DataFrame after deleting the rows and columns specified as a list of index or column labels. The <code>axis=</code> parameter controls which axis (row or column) we want to drop the Series from.  The <code>inplace=</code> parameter decides whether the change must be made permanent.
Also see <code>dropna</code>, which helps us get rid of rows with missing data.</li></ul><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># The DataFrame</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">196</span>]: <span class="cm-variable">df4</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">196</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-variable">P</span> &nbsp; <span class="cm-variable">Q</span> &nbsp; <span class="cm-variable">R</span> &nbsp; <span class="cm-variable">S</span> &nbsp; <span class="cm-variable">T</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">A</span>  <span class="cm-number">42</span>  <span class="cm-number">22</span> &nbsp; <span class="cm-number">5</span>  <span class="cm-number">10</span>  <span class="cm-number">28</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">B</span>  <span class="cm-number">17</span>  <span class="cm-number">85</span>  <span class="cm-number">17</span>  <span class="cm-number">26</span>  <span class="cm-number">20</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">C</span>  <span class="cm-number">48</span>  <span class="cm-number">53</span> &nbsp; <span class="cm-number">3</span>  <span class="cm-number">35</span>  <span class="cm-number">79</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">D</span>  <span class="cm-number">80</span>  <span class="cm-number">29</span> &nbsp; <span class="cm-number">0</span>  <span class="cm-number">24</span>  <span class="cm-number">85</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">E</span>  <span class="cm-number">71</span>  <span class="cm-number">66</span>  <span class="cm-number">30</span>  <span class="cm-number">31</span>  <span class="cm-number">32</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Dropping a single row (axis=0 is set by default)</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">197</span>]: <span class="cm-variable">df4</span>.<span class="cm-property">drop</span>(<span class="cm-string">'A'</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">197</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-variable">P</span> &nbsp; <span class="cm-variable">Q</span> &nbsp; <span class="cm-variable">R</span> &nbsp; <span class="cm-variable">S</span> &nbsp; <span class="cm-variable">T</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">B</span>  <span class="cm-number">17</span>  <span class="cm-number">85</span>  <span class="cm-number">17</span>  <span class="cm-number">26</span>  <span class="cm-number">20</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">C</span>  <span class="cm-number">48</span>  <span class="cm-number">53</span> &nbsp; <span class="cm-number">3</span>  <span class="cm-number">35</span>  <span class="cm-number">79</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">D</span>  <span class="cm-number">80</span>  <span class="cm-number">29</span> &nbsp; <span class="cm-number">0</span>  <span class="cm-number">24</span>  <span class="cm-number">85</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">E</span>  <span class="cm-number">71</span>  <span class="cm-number">66</span>  <span class="cm-number">30</span>  <span class="cm-number">31</span>  <span class="cm-number">32</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># We can drop multiple columns by providing a list of labels</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">199</span>]: <span class="cm-variable">df4</span>.<span class="cm-property">drop</span>([<span class="cm-string">'A'</span>, <span class="cm-string">'E'</span>])</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">199</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-variable">P</span> &nbsp; <span class="cm-variable">Q</span> &nbsp; <span class="cm-variable">R</span> &nbsp; <span class="cm-variable">S</span> &nbsp; <span class="cm-variable">T</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">B</span>  <span class="cm-number">17</span>  <span class="cm-number">85</span>  <span class="cm-number">17</span>  <span class="cm-number">26</span>  <span class="cm-number">20</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">C</span>  <span class="cm-number">48</span>  <span class="cm-number">53</span> &nbsp; <span class="cm-number">3</span>  <span class="cm-number">35</span>  <span class="cm-number">79</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">D</span>  <span class="cm-number">80</span>  <span class="cm-number">29</span> &nbsp; <span class="cm-number">0</span>  <span class="cm-number">24</span>  <span class="cm-number">85</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># This has the same effect; axis=0 is default (can be omitted)</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">200</span>]: <span class="cm-variable">df4</span>.<span class="cm-property">drop</span>([<span class="cm-string">'A'</span>, <span class="cm-string">'E'</span>], <span class="cm-variable">axis</span>=<span class="cm-number">0</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">200</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-variable">P</span> &nbsp; <span class="cm-variable">Q</span> &nbsp; <span class="cm-variable">R</span> &nbsp; <span class="cm-variable">S</span> &nbsp; <span class="cm-variable">T</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">B</span>  <span class="cm-number">17</span>  <span class="cm-number">85</span>  <span class="cm-number">17</span>  <span class="cm-number">26</span>  <span class="cm-number">20</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">C</span>  <span class="cm-number">48</span>  <span class="cm-number">53</span> &nbsp; <span class="cm-number">3</span>  <span class="cm-number">35</span>  <span class="cm-number">79</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">D</span>  <span class="cm-number">80</span>  <span class="cm-number">29</span> &nbsp; <span class="cm-number">0</span>  <span class="cm-number">24</span>  <span class="cm-number">85</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Pass axis=1 to drop columns</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">201</span>]: <span class="cm-variable">df4</span>.<span class="cm-property">drop</span>([<span class="cm-string">'P'</span>, <span class="cm-string">'R'</span>, <span class="cm-string">'T'</span>], <span class="cm-variable">axis</span>=<span class="cm-number">1</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">201</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-variable">Q</span> &nbsp; <span class="cm-variable">S</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">A</span>  <span class="cm-number">22</span>  <span class="cm-number">10</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">B</span>  <span class="cm-number">85</span>  <span class="cm-number">26</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">C</span>  <span class="cm-number">53</span>  <span class="cm-number">35</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">D</span>  <span class="cm-number">29</span>  <span class="cm-number">24</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">E</span>  <span class="cm-number">66</span>  <span class="cm-number">31</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1144px;"></div></div></div></pre><ul><li><p><code>rename</code> takes a DataFrame as input and a dictionary that maps old names to new names for columns. This method is particularly useful right in the beginning of data analysis, as sometimes when we get data we find that the column names are all messed up (have spaces or unwanted characters in them.)</p><p>[Pro Tip] Use dictionary comprehensions to create the substitution dict.</p></li></ul><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">203</span>]: <span class="cm-variable">df4</span>.<span class="cm-property">rename</span>(<span class="cm-variable">columns</span>={<span class="cm-string">'P'</span>:<span class="cm-string">'P_new'</span>, <span class="cm-string">'R'</span>:<span class="cm-string">'R_new'</span>})</span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">203</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; <span class="cm-variable cm-error">P_new</span> &nbsp; <span class="cm-variable">Q</span>  <span class="cm-variable">R_new</span> &nbsp; <span class="cm-variable">S</span> &nbsp; <span class="cm-variable">T</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">A</span> &nbsp; &nbsp; <span class="cm-number">42</span>  <span class="cm-number">22</span> &nbsp; &nbsp;  <span class="cm-number">5</span>  <span class="cm-number">10</span>  <span class="cm-number">28</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">B</span> &nbsp; &nbsp; <span class="cm-number">17</span>  <span class="cm-number">85</span> &nbsp; &nbsp; <span class="cm-number">17</span>  <span class="cm-number">26</span>  <span class="cm-number">20</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">C</span> &nbsp; &nbsp; <span class="cm-number">48</span>  <span class="cm-number">53</span> &nbsp; &nbsp;  <span class="cm-number">3</span>  <span class="cm-number">35</span>  <span class="cm-number">79</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">D</span> &nbsp; &nbsp; <span class="cm-number">80</span>  <span class="cm-number">29</span> &nbsp; &nbsp;  <span class="cm-number">0</span>  <span class="cm-number">24</span>  <span class="cm-number">85</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">E</span> &nbsp; &nbsp; <span class="cm-number">71</span>  <span class="cm-number">66</span> &nbsp; &nbsp; <span class="cm-number">30</span>  <span class="cm-number">31</span>  <span class="cm-number">32</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 208px;"></div></div></div></pre><h2><a name='header-c701' class='md-header-anchor '></a>Math/Stats Operations</h2><p>These sets of methods are one of the major reasons why so many people love pandas for data wrangling. By default, when you call a mathematical operation (like <code>sum</code>)  or a statistical operation (like <code>std</code>) on a DataFrame the results are produced for <em>all numeric columns.</em> </p><p>Other languages like R require you to either use an <em>apply</em> function or to use one of their specialized functions like <code>colMeans, rowMeans</code> to achieve this. Pandas, however, requires that you only pass the <code>axis=</code> parameter to control whether math/stat summaries should be produced for rows or columns. These methods also take a <code>skipna=</code> parameter that signals whether to exclude missing data (<code>True</code> by default) or not.</p><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Column Sums</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">208</span>]: <span class="cm-variable">df4</span>.<span class="cm-property">sum</span>(<span class="cm-variable">axis</span>=<span class="cm-number">0</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">208</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">P</span> &nbsp;  <span class="cm-number">258</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Q</span> &nbsp;  <span class="cm-number">255</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">R</span> &nbsp; &nbsp; <span class="cm-number">55</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">S</span> &nbsp;  <span class="cm-number">126</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">T</span> &nbsp;  <span class="cm-number">244</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">U</span> &nbsp;  <span class="cm-number">513</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">dtype</span>: <span class="cm-variable">int64</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Row Sums &nbsp;  </span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">209</span>]: <span class="cm-variable">df4</span>.<span class="cm-property">sum</span>(<span class="cm-variable">axis</span>=<span class="cm-number">1</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">209</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">A</span> &nbsp;  <span class="cm-number">171</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">B</span> &nbsp;  <span class="cm-number">267</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">C</span> &nbsp;  <span class="cm-number">319</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">D</span> &nbsp;  <span class="cm-number">327</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">E</span> &nbsp;  <span class="cm-number">367</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">dtype</span>: <span class="cm-variable">int64</span> &nbsp;  </span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 520px;"></div></div></div></pre><p>Try the above with other methods like <code>mean, std, var</code> to produce statistical summaries of your data. Below is a list of all math/stat methods available to objects of the DataFrame class.</p><p><img src='df_math.png' alt='' /></p><h4><a name='header-c709' class='md-header-anchor '></a>The <code>describe()</code> method</h4><p>One method, however, stands apart from the rest in its usefulness. The <code>.describe()</code> method applied to a DataFrame wil produce summary statistics for <strong>all numeric variables</strong> in the data and return the result in a neat DataFrame. Note that here too, NAs are excluded by default.</p><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">213</span>]: <span class="cm-variable">df4</span>.<span class="cm-property">describe</span>()</span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">213</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">P</span> &nbsp; &nbsp;  <span class="cm-variable">Q</span> &nbsp; &nbsp;  <span class="cm-variable">R</span> &nbsp; &nbsp;  <span class="cm-variable">S</span> &nbsp; &nbsp;  <span class="cm-variable">T</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">U</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">count</span> &nbsp; <span class="cm-number">5.00</span> &nbsp; <span class="cm-number">5.00</span> &nbsp; <span class="cm-number">5.00</span> &nbsp; <span class="cm-number">5.00</span> &nbsp; <span class="cm-number">5.00</span> &nbsp;  <span class="cm-number">5.00</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">mean</span> &nbsp; <span class="cm-number">51.60</span>  <span class="cm-number">51.00</span>  <span class="cm-number">11.00</span>  <span class="cm-number">25.20</span>  <span class="cm-number">48.80</span>  <span class="cm-number">102.60</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">std</span> &nbsp;  <span class="cm-number">24.93</span>  <span class="cm-number">26.03</span>  <span class="cm-number">12.43</span> &nbsp; <span class="cm-number">9.52</span>  <span class="cm-number">30.69</span> &nbsp; <span class="cm-number">26.06</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-builtin">min</span> &nbsp;  <span class="cm-number">17.00</span>  <span class="cm-number">22.00</span> &nbsp; <span class="cm-number">0.00</span>  <span class="cm-number">10.00</span>  <span class="cm-number">20.00</span> &nbsp; <span class="cm-number">64.00</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">25</span><span class="cm-operator">%</span> &nbsp;  <span class="cm-number">42.00</span>  <span class="cm-number">29.00</span> &nbsp; <span class="cm-number">3.00</span>  <span class="cm-number">24.00</span>  <span class="cm-number">28.00</span>  <span class="cm-number">101.00</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">50</span><span class="cm-operator">%</span> &nbsp;  <span class="cm-number">48.00</span>  <span class="cm-number">53.00</span> &nbsp; <span class="cm-number">5.00</span>  <span class="cm-number">26.00</span>  <span class="cm-number">32.00</span>  <span class="cm-number">102.00</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">75</span><span class="cm-operator">%</span> &nbsp;  <span class="cm-number">71.00</span>  <span class="cm-number">66.00</span>  <span class="cm-number">17.00</span>  <span class="cm-number">31.00</span>  <span class="cm-number">79.00</span>  <span class="cm-number">109.00</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-builtin">max</span> &nbsp;  <span class="cm-number">80.00</span>  <span class="cm-number">85.00</span>  <span class="cm-number">30.00</span>  <span class="cm-number">35.00</span>  <span class="cm-number">85.00</span>  <span class="cm-number">137.00</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 286px;"></div></div></div></pre><p>We can specift exactly which percentiles to evaluate (but the median will always be printed by default.)</p><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">215</span>]: <span class="cm-variable">df4</span>.<span class="cm-property">describe</span>(<span class="cm-variable">percentiles</span>=[<span class="cm-number">.01</span>, <span class="cm-number">.05</span>, <span class="cm-number">.95</span>, <span class="cm-number">.99</span>]).<span class="cm-property">round</span>(<span class="cm-number">2</span>)</span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">215</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">P</span> &nbsp; &nbsp;  <span class="cm-variable">Q</span> &nbsp; &nbsp;  <span class="cm-variable">R</span> &nbsp; &nbsp;  <span class="cm-variable">S</span> &nbsp; &nbsp;  <span class="cm-variable">T</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">U</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">count</span> &nbsp; <span class="cm-number">5.00</span> &nbsp; <span class="cm-number">5.00</span> &nbsp; <span class="cm-number">5.00</span> &nbsp; <span class="cm-number">5.00</span> &nbsp; <span class="cm-number">5.00</span> &nbsp;  <span class="cm-number">5.00</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">mean</span> &nbsp; <span class="cm-number">51.60</span>  <span class="cm-number">51.00</span>  <span class="cm-number">11.00</span>  <span class="cm-number">25.20</span>  <span class="cm-number">48.80</span>  <span class="cm-number">102.60</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">std</span> &nbsp;  <span class="cm-number">24.93</span>  <span class="cm-number">26.03</span>  <span class="cm-number">12.43</span> &nbsp; <span class="cm-number">9.52</span>  <span class="cm-number">30.69</span> &nbsp; <span class="cm-number">26.06</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-builtin">min</span> &nbsp;  <span class="cm-number">17.00</span>  <span class="cm-number">22.00</span> &nbsp; <span class="cm-number">0.00</span>  <span class="cm-number">10.00</span>  <span class="cm-number">20.00</span> &nbsp; <span class="cm-number">64.00</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">1</span><span class="cm-operator">%</span> &nbsp; &nbsp; <span class="cm-number">18.00</span>  <span class="cm-number">22.28</span> &nbsp; <span class="cm-number">0.12</span>  <span class="cm-number">10.56</span>  <span class="cm-number">20.32</span> &nbsp; <span class="cm-number">65.48</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">5</span><span class="cm-operator">%</span> &nbsp; &nbsp; <span class="cm-number">22.00</span>  <span class="cm-number">23.40</span> &nbsp; <span class="cm-number">0.60</span>  <span class="cm-number">12.80</span>  <span class="cm-number">21.60</span> &nbsp; <span class="cm-number">71.40</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">50</span><span class="cm-operator">%</span> &nbsp;  <span class="cm-number">48.00</span>  <span class="cm-number">53.00</span> &nbsp; <span class="cm-number">5.00</span>  <span class="cm-number">26.00</span>  <span class="cm-number">32.00</span>  <span class="cm-number">102.00</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">95</span><span class="cm-operator">%</span> &nbsp;  <span class="cm-number">78.20</span>  <span class="cm-number">81.20</span>  <span class="cm-number">27.40</span>  <span class="cm-number">34.20</span>  <span class="cm-number">83.80</span>  <span class="cm-number">131.40</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">99</span><span class="cm-operator">%</span> &nbsp;  <span class="cm-number">79.64</span>  <span class="cm-number">84.24</span>  <span class="cm-number">29.48</span>  <span class="cm-number">34.84</span>  <span class="cm-number">84.76</span>  <span class="cm-number">135.88</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-builtin">max</span> &nbsp;  <span class="cm-number">80.00</span>  <span class="cm-number">85.00</span>  <span class="cm-number">30.00</span>  <span class="cm-number">35.00</span>  <span class="cm-number">85.00</span>  <span class="cm-number">137.00</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 338px;"></div></div></div></pre><p>For categorical data, <code>describe()</code> will give a simple summary of the number of unique values and most frequently occurring values</p><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">217</span>]: <span class="cm-variable">s</span> = <span class="cm-variable">pd</span>.<span class="cm-property">Series</span>([<span class="cm-string">'a'</span>, <span class="cm-string">'a'</span>, <span class="cm-string">'b'</span>, <span class="cm-string">'b'</span>, <span class="cm-string">'a'</span>, <span class="cm-string">'a'</span>, <span class="cm-variable">np</span>.<span class="cm-property">nan</span>, <span class="cm-string">'c'</span>, <span class="cm-string">'d'</span>, <span class="cm-string">'a'</span>])</span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">218</span>]: <span class="cm-variable">s</span>.<span class="cm-property">describe</span>()</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">218</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">count</span> &nbsp; &nbsp; <span class="cm-number">9</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">unique</span> &nbsp;  <span class="cm-number">4</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">top</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">a</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">freq</span> &nbsp; &nbsp;  <span class="cm-number">5</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">dtype</span>: <span class="cm-builtin">object</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 234px;"></div></div></div></pre><p>We can pass the <code>include=</code> parameter to <code>describe</code> to control whether the summaries are printed for numeric or categorical variables by default.</p><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap "><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Our DataFrame with mixed types</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">223</span>]: <span class="cm-variable">df3</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">223</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; <span class="cm-variable cm-error">floats</span>  <span class="cm-variable">ints</span> <span class="cm-variable">strings</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">v</span> &nbsp; &nbsp; <span class="cm-number">0.1</span> &nbsp; &nbsp; <span class="cm-number">0</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">a</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">w</span> &nbsp; &nbsp; <span class="cm-number">0.2</span> &nbsp; &nbsp; <span class="cm-number">1</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">b</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">x</span> &nbsp; &nbsp; <span class="cm-number">0.3</span> &nbsp; &nbsp; <span class="cm-number">2</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">c</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">y</span> &nbsp; &nbsp; <span class="cm-number">0.4</span> &nbsp; &nbsp; <span class="cm-number">3</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">d</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">z</span> &nbsp; &nbsp; <span class="cm-number">0.5</span> &nbsp; &nbsp; <span class="cm-number">4</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">e</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Default behavior</span></span></pre><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># same as df3.describe(include=['number'])</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">224</span>]: <span class="cm-variable">df3</span>.<span class="cm-property">describe</span>()</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">224</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">floats</span> &nbsp; &nbsp;  <span class="cm-variable">ints</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">count</span>  <span class="cm-number">5.000000</span>  <span class="cm-number">5.000000</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">mean</span> &nbsp; <span class="cm-number">0.300000</span>  <span class="cm-number">2.000000</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">std</span> &nbsp;  <span class="cm-number">0.158114</span>  <span class="cm-number">1.581139</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-builtin">min</span> &nbsp;  <span class="cm-number">0.100000</span>  <span class="cm-number">0.000000</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">25</span><span class="cm-operator">%</span> &nbsp;  <span class="cm-number">0.200000</span>  <span class="cm-number">1.000000</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">50</span><span class="cm-operator">%</span> &nbsp;  <span class="cm-number">0.300000</span>  <span class="cm-number">2.000000</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">75</span><span class="cm-operator">%</span> &nbsp;  <span class="cm-number">0.400000</span>  <span class="cm-number">3.000000</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-builtin">max</span> &nbsp;  <span class="cm-number">0.500000</span>  <span class="cm-number">4.000000</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># To get summaries for categorical variables only</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">225</span>]: <span class="cm-variable">df3</span>.<span class="cm-property">describe</span>(<span class="cm-variable">include</span>=[<span class="cm-string">'object'</span>])</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">225</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; <span class="cm-variable">strings</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">count</span> &nbsp; &nbsp; &nbsp;  <span class="cm-number">5</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">unique</span> &nbsp; &nbsp; &nbsp; <span class="cm-number">5</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">top</span> &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-variable">d</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">freq</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">1</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Get summaries for all variables</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">228</span>]: <span class="cm-variable">df3</span>.<span class="cm-property">describe</span>(<span class="cm-variable">include</span>=<span class="cm-string">'all'</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">228</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-variable">floats</span> &nbsp; &nbsp;  <span class="cm-variable">ints</span> <span class="cm-variable">strings</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">count</span> &nbsp; <span class="cm-number">5.000000</span>  <span class="cm-number">5.000000</span> &nbsp; &nbsp; &nbsp; <span class="cm-number">5</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">unique</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">NaN</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">NaN</span> &nbsp; &nbsp; &nbsp; <span class="cm-number">5</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">top</span> &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-variable">NaN</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">NaN</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">d</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">freq</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">NaN</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">NaN</span> &nbsp; &nbsp; &nbsp; <span class="cm-number">1</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">mean</span> &nbsp;  <span class="cm-number">0.300000</span>  <span class="cm-number">2.000000</span> &nbsp; &nbsp; <span class="cm-variable">NaN</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">std</span> &nbsp; &nbsp; <span class="cm-number">0.158114</span>  <span class="cm-number">1.581139</span> &nbsp; &nbsp; <span class="cm-variable">NaN</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-builtin">min</span> &nbsp; &nbsp; <span class="cm-number">0.100000</span>  <span class="cm-number">0.000000</span> &nbsp; &nbsp; <span class="cm-variable">NaN</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">25</span><span class="cm-operator">%</span> &nbsp; &nbsp; <span class="cm-number">0.200000</span>  <span class="cm-number">1.000000</span> &nbsp; &nbsp; <span class="cm-variable">NaN</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">50</span><span class="cm-operator">%</span> &nbsp; &nbsp; <span class="cm-number">0.300000</span>  <span class="cm-number">2.000000</span> &nbsp; &nbsp; <span class="cm-variable">NaN</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">75</span><span class="cm-operator">%</span> &nbsp; &nbsp; <span class="cm-number">0.400000</span>  <span class="cm-number">3.000000</span> &nbsp; &nbsp; <span class="cm-variable">NaN</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-builtin">max</span> &nbsp; &nbsp; <span class="cm-number">0.500000</span>  <span class="cm-number">4.000000</span> &nbsp; &nbsp; <span class="cm-variable">Na</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1248px;"></div></div></div></pre><h2><a name='header-c724' class='md-header-anchor '></a>Handling Missing Values</h2><p> By <em>missing</em> data we simply mean that the value is  <strong>null</strong> or <em>&#39;not present for whatever reason&#39;</em>. Many phenomena could give rise to missing data but mostly it is just a matter of  either the data existed and was not collected or it never existed. </p><p>Pandas treats the NumPy <code>np.nan</code> and the Python <code>None</code> as missing values. The approach for handling missing values in DataFrames is the same as that for Series. Recall that a Dataframe is just a list of Series objects.</p><ul><li>Missings can be <strong>detected</strong> in a Series or DataFrame using <code>isnull(), notnull()</code> which return booleans.</li><li>To <strong>filter out missing data</strong> from a Series or DataFrame, or to remove rows (default action) or columns with missing data in a DataFrame, we use <code>dropna()</code> with the <code>axis=</code> and <code>inplace=</code> parameters.</li><li>Missing Value imputation is done using the <code>fillna()</code> method (along with options like  <code>ffill, bfill</code>  and <code>method=</code>)</li></ul><blockquote><p><em>[Note] In earlier versions of pandas, <code>inf</code> and <code>-inf</code> were also treated as missing values. This is no longer the case by default. Please use the <code>mode.use_inf_as_null</code> option to enable this functionality if required.</em></p></blockquote><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap  "><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Create some mising data</span></span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">231</span>]: <span class="cm-variable">df4</span>.<span class="cm-property">ix</span>[::<span class="cm-number">2</span>] = <span class="cm-variable">np</span>.<span class="cm-property">nan</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">232</span>]: <span class="cm-variable">df4</span></span></pre><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">232</span>]: </span></pre></div><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp;  <span class="cm-variable">P</span> &nbsp; &nbsp; <span class="cm-variable">Q</span> &nbsp; &nbsp; <span class="cm-variable">R</span> &nbsp; &nbsp; <span class="cm-variable">S</span> &nbsp; &nbsp; <span class="cm-variable">T</span> &nbsp; &nbsp;  <span class="cm-variable">U</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">A</span> &nbsp; <span class="cm-variable">NaN</span> &nbsp; <span class="cm-variable">NaN</span> &nbsp; <span class="cm-variable">NaN</span> &nbsp; <span class="cm-variable">NaN</span> &nbsp; <span class="cm-variable">NaN</span> &nbsp;  <span class="cm-variable">NaN</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">B</span>  <span class="cm-number">17.0</span>  <span class="cm-number">85.0</span>  <span class="cm-number">17.0</span>  <span class="cm-number">26.0</span>  <span class="cm-number">20.0</span>  <span class="cm-number">102.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">C</span> &nbsp; <span class="cm-variable">NaN</span> &nbsp; <span class="cm-variable">NaN</span> &nbsp; <span class="cm-variable">NaN</span> &nbsp; <span class="cm-variable">NaN</span> &nbsp; <span class="cm-variable">NaN</span> &nbsp;  <span class="cm-variable">NaN</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">D</span>  <span class="cm-number">80.0</span>  <span class="cm-number">29.0</span> &nbsp; <span class="cm-number">0.0</span>  <span class="cm-number">24.0</span>  <span class="cm-number">85.0</span>  <span class="cm-number">109.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">E</span> &nbsp; <span class="cm-variable">NaN</span> &nbsp; <span class="cm-variable">NaN</span> &nbsp; <span class="cm-variable">NaN</span> &nbsp; <span class="cm-variable">NaN</span> &nbsp; <span class="cm-variable">NaN</span> &nbsp;  <span class="cm-variable">NaN</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Detect Missing data</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">233</span>]: <span class="cm-variable">df4</span>.<span class="cm-property">isnull</span>()</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">233</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; <span class="cm-variable">P</span> &nbsp; &nbsp;  <span class="cm-variable">Q</span> &nbsp; &nbsp;  <span class="cm-variable">R</span> &nbsp; &nbsp;  <span class="cm-variable">S</span> &nbsp; &nbsp;  <span class="cm-variable">T</span> &nbsp; &nbsp;  <span class="cm-variable">U</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">A</span> &nbsp; <span class="cm-builtin">True</span> &nbsp; <span class="cm-builtin">True</span> &nbsp; <span class="cm-builtin">True</span> &nbsp; <span class="cm-builtin">True</span> &nbsp; <span class="cm-builtin">True</span> &nbsp; <span class="cm-builtin">True</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">B</span>  <span class="cm-builtin">False</span>  <span class="cm-builtin">False</span>  <span class="cm-builtin">False</span>  <span class="cm-builtin">False</span>  <span class="cm-builtin">False</span>  <span class="cm-builtin">False</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">C</span> &nbsp; <span class="cm-builtin">True</span> &nbsp; <span class="cm-builtin">True</span> &nbsp; <span class="cm-builtin">True</span> &nbsp; <span class="cm-builtin">True</span> &nbsp; <span class="cm-builtin">True</span> &nbsp; <span class="cm-builtin">True</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">D</span>  <span class="cm-builtin">False</span>  <span class="cm-builtin">False</span>  <span class="cm-builtin">False</span>  <span class="cm-builtin">False</span>  <span class="cm-builtin">False</span>  <span class="cm-builtin">False</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">E</span> &nbsp; <span class="cm-builtin">True</span> &nbsp; <span class="cm-builtin">True</span> &nbsp; <span class="cm-builtin">True</span> &nbsp; <span class="cm-builtin">True</span> &nbsp; <span class="cm-builtin">True</span> &nbsp; <span class="cm-builtin">True</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Replace missings with 0 (manually)</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">241</span>]: <span class="cm-variable">df4</span>[<span class="cm-variable">df4</span>.<span class="cm-property">isnull</span>()] = <span class="cm-number">0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">242</span>]: <span class="cm-variable">df4</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">242</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-variable">P</span> &nbsp; <span class="cm-variable">Q</span> &nbsp; <span class="cm-variable">R</span> &nbsp; <span class="cm-variable">S</span> &nbsp; <span class="cm-variable">T</span> &nbsp;  <span class="cm-variable">U</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">A</span> &nbsp; <span class="cm-number">0</span> &nbsp; <span class="cm-number">0</span> &nbsp; <span class="cm-number">0</span> &nbsp; <span class="cm-number">0</span> &nbsp; <span class="cm-number">0</span> &nbsp;  <span class="cm-number">0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">B</span>  <span class="cm-number">17</span>  <span class="cm-number">85</span>  <span class="cm-number">17</span>  <span class="cm-number">26</span>  <span class="cm-number">20</span>  <span class="cm-number">102</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">C</span> &nbsp; <span class="cm-number">0</span> &nbsp; <span class="cm-number">0</span> &nbsp; <span class="cm-number">0</span> &nbsp; <span class="cm-number">0</span> &nbsp; <span class="cm-number">0</span> &nbsp;  <span class="cm-number">0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">D</span>  <span class="cm-number">80</span>  <span class="cm-number">29</span> &nbsp; <span class="cm-number">0</span>  <span class="cm-number">24</span>  <span class="cm-number">85</span>  <span class="cm-number">109</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">E</span> &nbsp; <span class="cm-number">0</span> &nbsp; <span class="cm-number">0</span> &nbsp; <span class="cm-number">0</span> &nbsp; <span class="cm-number">0</span> &nbsp; <span class="cm-number">0</span> &nbsp;  <span class="cm-number">0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Replace missings with 0 (using fillna)</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">243</span>]: <span class="cm-variable">df4</span>.<span class="cm-property">fillna</span>(<span class="cm-number">0</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">243</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp;  <span class="cm-variable">P</span> &nbsp; &nbsp; <span class="cm-variable">Q</span> &nbsp; &nbsp; <span class="cm-variable">R</span> &nbsp; &nbsp; <span class="cm-variable">S</span> &nbsp; &nbsp; <span class="cm-variable">T</span> &nbsp; &nbsp;  <span class="cm-variable">U</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">A</span> &nbsp; <span class="cm-number">0.0</span> &nbsp; <span class="cm-number">0.0</span> &nbsp; <span class="cm-number">0.0</span> &nbsp; <span class="cm-number">0.0</span> &nbsp; <span class="cm-number">0.0</span> &nbsp;  <span class="cm-number">0.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">B</span>  <span class="cm-number">17.0</span>  <span class="cm-number">85.0</span>  <span class="cm-number">17.0</span>  <span class="cm-number">26.0</span>  <span class="cm-number">20.0</span>  <span class="cm-number">102.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">C</span> &nbsp; <span class="cm-number">0.0</span> &nbsp; <span class="cm-number">0.0</span> &nbsp; <span class="cm-number">0.0</span> &nbsp; <span class="cm-number">0.0</span> &nbsp; <span class="cm-number">0.0</span> &nbsp;  <span class="cm-number">0.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">D</span>  <span class="cm-number">80.0</span>  <span class="cm-number">29.0</span> &nbsp; <span class="cm-number">0.0</span>  <span class="cm-number">24.0</span>  <span class="cm-number">85.0</span>  <span class="cm-number">109.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">E</span> &nbsp; <span class="cm-number">0.0</span> &nbsp; <span class="cm-number">0.0</span> &nbsp; <span class="cm-number">0.0</span> &nbsp; <span class="cm-number">0.0</span> &nbsp; <span class="cm-number">0.0</span> &nbsp;  <span class="cm-number">0.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Drop rows with missing data</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">247</span>]: <span class="cm-variable">df4</span>.<span class="cm-property">dropna</span>()</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">247</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-variable">P</span> &nbsp; <span class="cm-variable">Q</span> &nbsp; <span class="cm-variable">R</span> &nbsp; <span class="cm-variable">S</span> &nbsp; <span class="cm-variable">T</span> &nbsp;  <span class="cm-variable">U</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">B</span>  <span class="cm-number">17</span>  <span class="cm-number">85</span>  <span class="cm-number">17</span>  <span class="cm-number">26</span>  <span class="cm-number">20</span>  <span class="cm-number">102</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">D</span>  <span class="cm-number">80</span>  <span class="cm-number">29</span> &nbsp; <span class="cm-number">0</span>  <span class="cm-number">24</span>  <span class="cm-number">85</span>  <span class="cm-number">109</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1248px;"></div></div></div></pre><h2><a name='header-c741' class='md-header-anchor '></a>Sorting Data</h2><p>Sorting data is a basic task that allows us to figure out if a given variable has outliers by looking at the values at its extremes. Both sort functions in Pandas take an <code>ascending=</code> parameter to control the nature of the sort. By default, it takes <code>True</code> so if you want to get the Series/DataFrame sorted in descending order, pass <code>ascending=False</code></p><ul><li>For reordering rows or columns <strong>by labels</strong> we use <code>sort_index()</code></li><li>For Sorting <strong>by values</strong> use  <code>sort_values()</code> which takes a <code>by=</code> parameter through which we may specify the column(s) on which we want to sort the data. </li></ul><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap "><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code     " style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">249</span>]: <span class="cm-variable">df5</span> = <span class="cm-variable">DataFrame</span>(<span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">9</span>).<span class="cm-property">reshape</span>(<span class="cm-number">3</span>,<span class="cm-number">3</span>),</span></pre></div><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-variable">index</span>=<span class="cm-builtin">list</span>(<span class="cm-string">'cba'</span>), </span></pre><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-variable">columns</span>=<span class="cm-builtin">list</span>(<span class="cm-string">'prq'</span>))</span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">249</span>]: <span class="cm-variable">df5</span></span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">249</span>]: </span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-variable">p</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">r</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">q</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">c</span> <span class="cm-operator">-</span><span class="cm-number">0.091751</span> <span class="cm-operator">-</span><span class="cm-number">0.617904</span>  <span class="cm-number">0.267026</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">b</span> <span class="cm-operator">-</span><span class="cm-number">0.156745</span> <span class="cm-operator">-</span><span class="cm-number">0.182804</span> <span class="cm-operator">-</span><span class="cm-number">0.255996</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">a</span>  <span class="cm-number">1.864256</span>  <span class="cm-number">0.944659</span>  <span class="cm-number">2.858450</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># without arguments, sort_index() will sort the index (rows) of the DataFrame</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">250</span>]: <span class="cm-variable">df5</span>.<span class="cm-property">sort_index</span>()</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">250</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-variable">p</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">r</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">q</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">a</span>  <span class="cm-number">1.864256</span>  <span class="cm-number">0.944659</span>  <span class="cm-number">2.858450</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">b</span> <span class="cm-operator">-</span><span class="cm-number">0.156745</span> <span class="cm-operator">-</span><span class="cm-number">0.182804</span> <span class="cm-operator">-</span><span class="cm-number">0.255996</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">c</span> <span class="cm-operator">-</span><span class="cm-number">0.091751</span> <span class="cm-operator">-</span><span class="cm-number">0.617904</span>  <span class="cm-number">0.267026</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># To sort column names</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">251</span>]: <span class="cm-variable">df5</span>.<span class="cm-property">sort_index</span>(<span class="cm-variable">axis</span>=<span class="cm-number">1</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">251</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-variable">p</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">q</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">r</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">c</span> <span class="cm-operator">-</span><span class="cm-number">0.091751</span>  <span class="cm-number">0.267026</span> <span class="cm-operator">-</span><span class="cm-number">0.617904</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">b</span> <span class="cm-operator">-</span><span class="cm-number">0.156745</span> <span class="cm-operator">-</span><span class="cm-number">0.255996</span> <span class="cm-operator">-</span><span class="cm-number">0.182804</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">a</span>  <span class="cm-number">1.864256</span>  <span class="cm-number">2.858450</span>  <span class="cm-number">0.944659</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Sort the data by the values of a column</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">252</span>]: <span class="cm-variable">df5</span>.<span class="cm-property">sort_values</span>(<span class="cm-variable">by</span>=[<span class="cm-string">'p'</span>])</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">252</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-variable">p</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">r</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">q</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">b</span> <span class="cm-operator">-</span><span class="cm-number">0.156745</span> <span class="cm-operator">-</span><span class="cm-number">0.182804</span> <span class="cm-operator">-</span><span class="cm-number">0.255996</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">c</span> <span class="cm-operator">-</span><span class="cm-number">0.091751</span> <span class="cm-operator">-</span><span class="cm-number">0.617904</span>  <span class="cm-number">0.267026</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">a</span>  <span class="cm-number">1.864256</span>  <span class="cm-number">0.944659</span>  <span class="cm-number">2.858450</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Sort the data by the values of 2 columns</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">253</span>]: <span class="cm-variable">df5</span>.<span class="cm-property">sort_values</span>(<span class="cm-variable">by</span>=[<span class="cm-string">'p'</span>, <span class="cm-string">'r'</span>], <span class="cm-variable">ascending</span>=<span class="cm-builtin">False</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">253</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-variable">p</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">r</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">q</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">a</span>  <span class="cm-number">1.864256</span>  <span class="cm-number">0.944659</span>  <span class="cm-number">2.858450</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">c</span> <span class="cm-operator">-</span><span class="cm-number">0.091751</span> <span class="cm-operator">-</span><span class="cm-number">0.617904</span>  <span class="cm-number">0.267026</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">b</span> <span class="cm-operator">-</span><span class="cm-number">0.156745</span> <span class="cm-operator">-</span><span class="cm-number">0.182804</span> <span class="cm-operator">-</span><span class="cm-number">0.255996</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1066px;"></div></div></div></pre><h2><a name='header-c754' class='md-header-anchor '></a>Handling Duplicates</h2><p>The methods <code>duplicated()</code> and <code>drop_duplicates()</code> help us in identifying rows that are duplicates of other rows, and to ignore those rows from the data respectively.</p><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Create a duplicate row in the data</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">260</span>]: <span class="cm-variable">df5</span>.<span class="cm-property">loc</span>[<span class="cm-string">'x'</span>, :] = <span class="cm-variable">df5</span>.<span class="cm-property">loc</span>[<span class="cm-string">'c'</span>, :]</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">261</span>]: <span class="cm-variable">df5</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">261</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-variable">p</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">r</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">q</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">c</span> <span class="cm-operator">-</span><span class="cm-number">0.091751</span> <span class="cm-operator">-</span><span class="cm-number">0.617904</span>  <span class="cm-number">0.267026</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">b</span> <span class="cm-operator">-</span><span class="cm-number">0.156745</span> <span class="cm-operator">-</span><span class="cm-number">0.182804</span> <span class="cm-operator">-</span><span class="cm-number">0.255996</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">a</span>  <span class="cm-number">1.864256</span>  <span class="cm-number">0.944659</span>  <span class="cm-number">2.858450</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">x</span> <span class="cm-operator">-</span><span class="cm-number">0.091751</span> <span class="cm-operator">-</span><span class="cm-number">0.617904</span>  <span class="cm-number">0.267026</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Detect duplicates</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">262</span>]: <span class="cm-variable">df5</span>.<span class="cm-property">duplicated</span>()</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">262</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">c</span> &nbsp;  <span class="cm-builtin">False</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">b</span> &nbsp;  <span class="cm-builtin">False</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">a</span> &nbsp;  <span class="cm-builtin">False</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">x</span> &nbsp; &nbsp; <span class="cm-builtin">True</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">dtype</span>: <span class="cm-builtin">bool</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Ignore duplicates</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">263</span>]: <span class="cm-variable">df5</span>.<span class="cm-property">drop_duplicates</span>()</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">263</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-variable">p</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">r</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">q</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">c</span> <span class="cm-operator">-</span><span class="cm-number">0.091751</span> <span class="cm-operator">-</span><span class="cm-number">0.617904</span>  <span class="cm-number">0.267026</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">b</span> <span class="cm-operator">-</span><span class="cm-number">0.156745</span> <span class="cm-operator">-</span><span class="cm-number">0.182804</span> <span class="cm-operator">-</span><span class="cm-number">0.255996</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">a</span>  <span class="cm-number">1.864256</span>  <span class="cm-number">0.944659</span>  <span class="cm-number">2.858450</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 676px;"></div></div></div></pre><h2><a name='header-c760' class='md-header-anchor '></a>Binning Data with <code>cut</code> and <code>qcut</code></h2><blockquote><p><em>&#39;Binning&#39;, or &#39;discretization&#39;, is the process of <strong>converting numeric variables to categoricals</strong>.</em> </p></blockquote><p>This technique finds widespread use in data science when we have numeric variables (such as Age, Salary) and we want to convert them into ranges (such a Age Groups, Salary Groups.) 
We might also want to convert a variable into quantile groups. Variable deciling is a popular example of this.</p><p></p><p>The <code>pd.cut()</code> and <code>pd.qcut()</code> functions are used for this purpose in <code>pandas</code>.</p><ul><li><p><code>cut</code> discretizes variables by <strong>following the underlying distribution</strong>.  Discretizing a normally-distributed variable with <code>cut()</code> would produce bins with more cases in the middle bins than the bins at the extremes.</p><blockquote><p> <em>With <code>cut()</code>, each bin will have the same width, but they may not have the same number of records.</em></p></blockquote></li><li><p><code>qcut</code> discretizes variables into <strong>equal-sized buckets</strong> by choosing bin thresholds accordingly. 
So if your data has 100 values, and you specify bins = 5, there will be 20 values in each bin.</p><blockquote><p> <em>With <code>qcut</code>, each bin will have the same number of records but they may not have the same width</em>.</p></blockquote></li></ul><p></p><p>Both these functions take as arguments the following -</p><ul><li><code>var</code>, the continuous variable to discretize</li><li><code>bins</code>, specified as a number (equal sized bins will be computed based on min/max) or a list of bin edges</li><li><code>right=</code> a boolean to include the edges or not</li><li><code>include_lowest=</code> a boolean to include the smallest value or not</li><li><code>labels=</code> for naming the bins</li></ul><p><strong>Example</strong></p><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Create an array (normally distributed data) </span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []: <span class="cm-variable">num_var</span> = (<span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">1000</span>) <span class="cm-operator">*</span> <span class="cm-number">100</span>).<span class="cm-property">astype</span>(<span class="cm-builtin">int</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []: <span class="cm-variable">num_var</span>[:<span class="cm-number">5</span>]</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[]: <span class="cm-variable">array</span>([<span class="cm-operator">-</span><span class="cm-number">114</span>, &nbsp; <span class="cm-number">58</span>, &nbsp;  <span class="cm-number">0</span>, <span class="cm-operator">-</span><span class="cm-number">122</span>,  <span class="cm-number">138</span>])</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Bins produced by pd.cut</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []: <span class="cm-variable">pd</span>.<span class="cm-property">cut</span>(<span class="cm-variable">num_var</span>, <span class="cm-number">10</span>)[:<span class="cm-number">5</span>]</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[]: </span></pre><pre class=""><span style="padding-right: 0.1px;">[(<span class="cm-operator">-</span><span class="cm-number">142.2</span>, <span class="cm-operator">-</span><span class="cm-number">73.6</span><span class="cm-error">]</span>, (<span class="cm-operator">-</span><span class="cm-number">5</span>, <span class="cm-number">63.6</span><span class="cm-error">]</span>, (<span class="cm-operator">-</span><span class="cm-number">5</span>, <span class="cm-number">63.6</span><span class="cm-error">]</span>, (<span class="cm-operator">-</span><span class="cm-number">142.2</span>, <span class="cm-operator">-</span><span class="cm-number">73.6</span><span class="cm-error">]</span>, (<span class="cm-number">132.2</span>, <span class="cm-number">200.8</span><span class="cm-error">]]</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Bins produced by pd.qcut &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  </span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []: <span class="cm-variable">pd</span>.<span class="cm-property">qcut</span>(<span class="cm-variable">num_var</span>, <span class="cm-number">10</span>)[:<span class="cm-number">5</span>]</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[]: </span></pre><pre class=""><span style="padding-right: 0.1px;">[(<span class="cm-operator">-</span><span class="cm-number">127</span>, <span class="cm-operator">-</span><span class="cm-number">83.2</span><span class="cm-error">]</span>, (<span class="cm-number">49</span>, <span class="cm-number">86.2</span><span class="cm-error">]</span>, (<span class="cm-operator">-</span><span class="cm-number">2</span>, <span class="cm-number">23</span><span class="cm-error">]</span>, (<span class="cm-operator">-</span><span class="cm-number">127</span>, <span class="cm-operator">-</span><span class="cm-number">83.2</span><span class="cm-error">]</span>, (<span class="cm-number">132.2</span>, <span class="cm-number">338</span><span class="cm-error">]]</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 364px;"></div></div></div></pre><p>Observe how bins created by <code>cut</code> are roughly equi-spaced. Running <code>value_counts()</code> on these binned variables reveals an interesting phenomenon.</p><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># No. of values in cut bins follow the underlying distribution</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []: <span class="cm-variable">pd</span>.<span class="cm-property">cut</span>(<span class="cm-variable">num_var</span>, <span class="cm-number">10</span>).<span class="cm-property">value_counts</span>()</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[]: </span></pre><pre class=""><span style="padding-right: 0.1px;">(<span class="cm-operator">-</span><span class="cm-number">348.686</span>, <span class="cm-operator">-</span><span class="cm-number">279.4</span><span class="cm-error">]</span> &nbsp; &nbsp;  <span class="cm-number">3</span></span></pre><pre class=""><span style="padding-right: 0.1px;">(<span class="cm-operator">-</span><span class="cm-number">279.4</span>, <span class="cm-operator">-</span><span class="cm-number">210.8</span><span class="cm-error">]</span> &nbsp; &nbsp; &nbsp; <span class="cm-number">13</span></span></pre><pre class=""><span style="padding-right: 0.1px;">(<span class="cm-operator">-</span><span class="cm-number">210.8</span>, <span class="cm-operator">-</span><span class="cm-number">142.2</span><span class="cm-error">]</span> &nbsp; &nbsp; &nbsp; <span class="cm-number">63</span></span></pre><pre class=""><span style="padding-right: 0.1px;">(<span class="cm-operator">-</span><span class="cm-number">142.2</span>, <span class="cm-operator">-</span><span class="cm-number">73.6</span><span class="cm-error">]</span> &nbsp; &nbsp; &nbsp; <span class="cm-number">142</span></span></pre><pre class=""><span style="padding-right: 0.1px;">(<span class="cm-operator">-</span><span class="cm-number">73.6</span>, <span class="cm-operator">-</span><span class="cm-number">5</span><span class="cm-error">]</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">265</span></span></pre><pre class=""><span style="padding-right: 0.1px;">(<span class="cm-operator">-</span><span class="cm-number">5</span>, <span class="cm-number">63.6</span><span class="cm-error">]</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-number">260</span></span></pre><pre class=""><span style="padding-right: 0.1px;">(<span class="cm-number">63.6</span>, <span class="cm-number">132.2</span><span class="cm-error">]</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">154</span></span></pre><pre class=""><span style="padding-right: 0.1px;">(<span class="cm-number">132.2</span>, <span class="cm-number">200.8</span><span class="cm-error">]</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">78</span></span></pre><pre class=""><span style="padding-right: 0.1px;">(<span class="cm-number">200.8</span>, <span class="cm-number">269.4</span><span class="cm-error">]</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">20</span></span></pre><pre class=""><span style="padding-right: 0.1px;">(<span class="cm-number">269.4</span>, <span class="cm-number">338</span><span class="cm-error">]</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-number">2</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">dtype</span>: <span class="cm-variable">int64</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># No. of values in qcut bins follow the uniform distribution</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []: <span class="cm-variable">pd</span>.<span class="cm-property">qcut</span>(<span class="cm-variable">num_var</span>, <span class="cm-number">10</span>).<span class="cm-property">value_counts</span>()</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[]: </span></pre><pre class=""><span style="padding-right: 0.1px;">[<span class="cm-operator">-</span><span class="cm-number">348</span>, <span class="cm-operator">-</span><span class="cm-number">127</span>] &nbsp; &nbsp;  <span class="cm-number">101</span></span></pre><pre class=""><span style="padding-right: 0.1px;">(<span class="cm-operator">-</span><span class="cm-number">127</span>, <span class="cm-operator">-</span><span class="cm-number">83.2</span><span class="cm-error">]</span> &nbsp; &nbsp;  <span class="cm-number">99</span></span></pre><pre class=""><span style="padding-right: 0.1px;">(<span class="cm-operator">-</span><span class="cm-number">83.2</span>, <span class="cm-operator">-</span><span class="cm-number">49.3</span><span class="cm-error">]</span> &nbsp;  <span class="cm-number">100</span></span></pre><pre class=""><span style="padding-right: 0.1px;">(<span class="cm-operator">-</span><span class="cm-number">49.3</span>, <span class="cm-operator">-</span><span class="cm-number">25</span><span class="cm-error">]</span> &nbsp; &nbsp;  <span class="cm-number">101</span></span></pre><pre class=""><span style="padding-right: 0.1px;">(<span class="cm-operator">-</span><span class="cm-number">25</span>, <span class="cm-operator">-</span><span class="cm-number">2</span><span class="cm-error">]</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">101</span></span></pre><pre class=""><span style="padding-right: 0.1px;">(<span class="cm-operator">-</span><span class="cm-number">2</span>, <span class="cm-number">23</span><span class="cm-error">]</span> &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-number">103</span></span></pre><pre class=""><span style="padding-right: 0.1px;">(<span class="cm-number">23</span>, <span class="cm-number">49</span><span class="cm-error">]</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">96</span></span></pre><pre class=""><span style="padding-right: 0.1px;">(<span class="cm-number">49</span>, <span class="cm-number">86.2</span><span class="cm-error">]</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">99</span></span></pre><pre class=""><span style="padding-right: 0.1px;">(<span class="cm-number">86.2</span>, <span class="cm-number">132.2</span><span class="cm-error">]</span> &nbsp; &nbsp; <span class="cm-number">100</span></span></pre><pre class=""><span style="padding-right: 0.1px;">(<span class="cm-number">132.2</span>, <span class="cm-number">338</span><span class="cm-error">]</span> &nbsp; &nbsp;  <span class="cm-number">100</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">dtype</span>: <span class="cm-variable">int64</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 754px;"></div></div></div></pre><p>If you wish to manually create the bins, you may pass the bin boundaries as a list to the <code>bins=</code> argument of <code>cut</code></p><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []: <span class="cm-variable">pd</span>.<span class="cm-property">cut</span>(<span class="cm-variable">num_var</span>, <span class="cm-variable">bins</span>=<span class="cm-builtin">range</span>(<span class="cm-operator">-</span><span class="cm-number">350</span>, <span class="cm-number">350</span>, <span class="cm-number">50</span>)).<span class="cm-property">value_counts</span>()</span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[]: </span></pre><pre class=""><span style="padding-right: 0.1px;">(<span class="cm-operator">-</span><span class="cm-number">350</span>, <span class="cm-operator">-</span><span class="cm-number">300</span><span class="cm-error">]</span> &nbsp; &nbsp;  <span class="cm-number">2</span></span></pre><pre class=""><span style="padding-right: 0.1px;">(<span class="cm-operator">-</span><span class="cm-number">300</span>, <span class="cm-operator">-</span><span class="cm-number">250</span><span class="cm-error">]</span> &nbsp; &nbsp;  <span class="cm-number">4</span></span></pre><pre class=""><span style="padding-right: 0.1px;">(<span class="cm-operator">-</span><span class="cm-number">250</span>, <span class="cm-operator">-</span><span class="cm-number">200</span><span class="cm-error">]</span> &nbsp; &nbsp; <span class="cm-number">19</span></span></pre><pre class=""><span style="padding-right: 0.1px;">(<span class="cm-operator">-</span><span class="cm-number">200</span>, <span class="cm-operator">-</span><span class="cm-number">150</span><span class="cm-error">]</span> &nbsp; &nbsp; <span class="cm-number">44</span></span></pre><pre class=""><span style="padding-right: 0.1px;">(<span class="cm-operator">-</span><span class="cm-number">150</span>, <span class="cm-operator">-</span><span class="cm-number">100</span><span class="cm-error">]</span> &nbsp; &nbsp; <span class="cm-number">94</span></span></pre><pre class=""><span style="padding-right: 0.1px;">(<span class="cm-operator">-</span><span class="cm-number">100</span>, <span class="cm-operator">-</span><span class="cm-number">50</span><span class="cm-error">]</span> &nbsp; &nbsp; <span class="cm-number">137</span></span></pre><pre class=""><span style="padding-right: 0.1px;">(<span class="cm-operator">-</span><span class="cm-number">50</span>, <span class="cm-number">0</span><span class="cm-error">]</span> &nbsp; &nbsp; &nbsp;  <span class="cm-number">218</span></span></pre><pre class=""><span style="padding-right: 0.1px;">(<span class="cm-number">0</span>, <span class="cm-number">50</span><span class="cm-error">]</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">188</span></span></pre><pre class=""><span style="padding-right: 0.1px;">(<span class="cm-number">50</span>, <span class="cm-number">100</span><span class="cm-error">]</span> &nbsp; &nbsp; &nbsp; <span class="cm-number">129</span></span></pre><pre class=""><span style="padding-right: 0.1px;">(<span class="cm-number">100</span>, <span class="cm-number">150</span><span class="cm-error">]</span> &nbsp; &nbsp; &nbsp; <span class="cm-number">97</span></span></pre><pre class=""><span style="padding-right: 0.1px;">(<span class="cm-number">150</span>, <span class="cm-number">200</span><span class="cm-error">]</span> &nbsp; &nbsp; &nbsp; <span class="cm-number">46</span></span></pre><pre class=""><span style="padding-right: 0.1px;">(<span class="cm-number">200</span>, <span class="cm-number">250</span><span class="cm-error">]</span> &nbsp; &nbsp; &nbsp; <span class="cm-number">17</span></span></pre><pre class=""><span style="padding-right: 0.1px;">(<span class="cm-number">250</span>, <span class="cm-number">300</span><span class="cm-error">]</span> &nbsp; &nbsp; &nbsp;  <span class="cm-number">4</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">dtype</span>: <span class="cm-variable">int64</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 416px;"></div></div></div></pre><p>[Pro Tip] If your data has a lot of missing values (or a lot of duplicate values - which is typically the case with skewed discrete distributions), it will cause <code>qcut</code> to fail as it would not be able to detect unqiue bin edges. Use missing value imputation with <code>fillna()</code> to avoid this.</p><h2><a name='header-c1988' class='md-header-anchor '></a>Creating Dummies from Categorical data</h2><blockquote><p> <em>A dummy variables is one that takes the value 0 or 1 to indicate the absence or presence of a particular level of a categorical variable.</em> </p></blockquote><p>Typically, for a categorical variable of length N and k levels, we can derive k dummy variables, each of length N, as a DataFrame. These find extensive applications in statistical learning, most notably in regression analysis and text mining. Many other machine learning models require the user to code all categorical data into dummy variables as a preprocessing step.</p><p>As a simple example, suppose <code>Gender</code> is one of the qualitative explanatory variables relevant to a data problem. Then, <code>female</code> and <code>male</code> would be the levels of this variable. We can create two dummy variables from this variable (let&#39;s call them <code>dummy_female</code> and <code>dummy_male</code>) where the former would take the value 1 whenever Gender takes the value female and vice-versa. </p><h3><a name='header-c814' class='md-header-anchor '></a>Creating Dummies Manually</h3><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap  "><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code      " style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Create a toy dataset with one numeric and one categorical variable</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []:</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">df_G</span> = <span class="cm-variable">DataFrame</span>({<span class="cm-string">'key'</span>: <span class="cm-builtin">list</span>(<span class="cm-string">'bbacccb'</span>),</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-string">'val'</span>: <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">7</span>) }).<span class="cm-property">round</span>(<span class="cm-number">2</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">df_G</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[]:</span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-variable cm-error">key</span> &nbsp; <span class="cm-variable">val</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">0</span> &nbsp; <span class="cm-variable">b</span> <span class="cm-operator">-</span><span class="cm-number">1.63</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">1</span> &nbsp; <span class="cm-variable">b</span> <span class="cm-operator">-</span><span class="cm-number">0.10</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">2</span> &nbsp; <span class="cm-variable">a</span>  <span class="cm-number">1.30</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">3</span> &nbsp; <span class="cm-variable">c</span>  <span class="cm-number">0.09</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">4</span> &nbsp; <span class="cm-variable">c</span>  <span class="cm-number">0.37</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">5</span> &nbsp; <span class="cm-variable">c</span>  <span class="cm-number">1.86</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">6</span> &nbsp; <span class="cm-variable">b</span>  <span class="cm-number">0.93</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Dummy for Level 'a'</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []: (<span class="cm-variable">df_G</span>[<span class="cm-string">'key'</span>] == <span class="cm-string">'a'</span>).<span class="cm-property">astype</span>(<span class="cm-builtin">int</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[]:</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">0</span> &nbsp;  <span class="cm-number">0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">1</span> &nbsp;  <span class="cm-number">0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">2</span> &nbsp;  <span class="cm-number">1</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">3</span> &nbsp;  <span class="cm-number">0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">4</span> &nbsp;  <span class="cm-number">0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">5</span> &nbsp;  <span class="cm-number">0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">6</span> &nbsp;  <span class="cm-number">0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Name</span>: <span class="cm-variable">key</span>, <span class="cm-variable">dtype</span>: <span class="cm-variable">int64</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Dummy for level 'b'</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []: (<span class="cm-variable">df_G</span>[<span class="cm-string">'key'</span>] == <span class="cm-string">'b'</span>).<span class="cm-property">astype</span>(<span class="cm-builtin">int</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[]:</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">0</span> &nbsp;  <span class="cm-number">1</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">1</span> &nbsp;  <span class="cm-number">1</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">2</span> &nbsp;  <span class="cm-number">0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">3</span> &nbsp;  <span class="cm-number">0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">4</span> &nbsp;  <span class="cm-number">0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">5</span> &nbsp;  <span class="cm-number">0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">6</span> &nbsp;  <span class="cm-number">1</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Name</span>: <span class="cm-variable">key</span>, <span class="cm-variable">dtype</span>: <span class="cm-variable">int64</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Dummies for all 3 levels</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []: (<span class="cm-variable">DataFrame</span>({<span class="cm-string">'key'</span>: <span class="cm-variable">df_G</span>[<span class="cm-string">'key'</span>]})</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  .<span class="cm-property">assign</span>(<span class="cm-variable">dummy_a</span> = <span class="cm-keyword">lambda</span> <span class="cm-variable">x</span>: (<span class="cm-variable">x</span>[<span class="cm-string">'key'</span>] == <span class="cm-string">'a'</span>).<span class="cm-property">astype</span>(<span class="cm-builtin">int</span>),</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-variable">dummy_b</span> = <span class="cm-keyword">lambda</span> <span class="cm-variable">x</span>: (<span class="cm-variable">x</span>[<span class="cm-string">'key'</span>] ==<span class="cm-string">'b'</span>).<span class="cm-property">astype</span>(<span class="cm-builtin">int</span>),</span></pre><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-variable">dummy_c</span> = <span class="cm-keyword">lambda</span> <span class="cm-variable">x</span>: (<span class="cm-variable">x</span>[<span class="cm-string">'key'</span>] == <span class="cm-string">'c'</span>).<span class="cm-property">astype</span>(<span class="cm-builtin">int</span>)))</span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[]:</span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-variable cm-error">key</span>  <span class="cm-variable">dummy_a</span>  <span class="cm-variable">dummy_b</span>  <span class="cm-variable">dummy_c</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">0</span> &nbsp; <span class="cm-variable">b</span> &nbsp; &nbsp; &nbsp;  <span class="cm-number">0</span> &nbsp; &nbsp; &nbsp;  <span class="cm-number">1</span> &nbsp; &nbsp; &nbsp;  <span class="cm-number">0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">1</span> &nbsp; <span class="cm-variable">b</span> &nbsp; &nbsp; &nbsp;  <span class="cm-number">0</span> &nbsp; &nbsp; &nbsp;  <span class="cm-number">1</span> &nbsp; &nbsp; &nbsp;  <span class="cm-number">0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">2</span> &nbsp; <span class="cm-variable">a</span> &nbsp; &nbsp; &nbsp;  <span class="cm-number">1</span> &nbsp; &nbsp; &nbsp;  <span class="cm-number">0</span> &nbsp; &nbsp; &nbsp;  <span class="cm-number">0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">3</span> &nbsp; <span class="cm-variable">c</span> &nbsp; &nbsp; &nbsp;  <span class="cm-number">0</span> &nbsp; &nbsp; &nbsp;  <span class="cm-number">0</span> &nbsp; &nbsp; &nbsp;  <span class="cm-number">1</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">4</span> &nbsp; <span class="cm-variable">c</span> &nbsp; &nbsp; &nbsp;  <span class="cm-number">0</span> &nbsp; &nbsp; &nbsp;  <span class="cm-number">0</span> &nbsp; &nbsp; &nbsp;  <span class="cm-number">1</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">5</span> &nbsp; <span class="cm-variable">c</span> &nbsp; &nbsp; &nbsp;  <span class="cm-number">0</span> &nbsp; &nbsp; &nbsp;  <span class="cm-number">0</span> &nbsp; &nbsp; &nbsp;  <span class="cm-number">1</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">6</span> &nbsp; <span class="cm-variable">b</span> &nbsp; &nbsp; &nbsp;  <span class="cm-number">0</span> &nbsp; &nbsp; &nbsp;  <span class="cm-number">1</span> &nbsp; &nbsp; &nbsp;  <span class="cm-number">0</span> &nbsp;  </span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1404px;"></div></div></div></pre><p>Note how the dummy corresponding each level of <code>key</code> takes 1 whenever the corresponding level in <code>key</code> is &#39;a&#39;, &#39;b&#39; or &#39;c&#39;. Now that you&#39;ve seen how dummies work, let&#39;s look at how we can do this automatically.</p><h3><a name='header-c818' class='md-header-anchor '></a>Creating Dummies with <code>pd.get_dummies()</code></h3><p>This function takes as input a categorical variable, and a <code>prefix=</code> argument for supplying names to created variables.</p><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Creating Dummies</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">345</span>]: <span class="cm-variable">pd</span>.<span class="cm-property">get_dummies</span>(<span class="cm-variable">df_G</span>[<span class="cm-string">'key'</span>])</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">345</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; <span class="cm-variable">a</span> &nbsp;  <span class="cm-variable">b</span> &nbsp;  <span class="cm-variable">c</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">0</span>  <span class="cm-number">0.0</span>  <span class="cm-number">1.0</span>  <span class="cm-number">0.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">1</span>  <span class="cm-number">0.0</span>  <span class="cm-number">1.0</span>  <span class="cm-number">0.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">2</span>  <span class="cm-number">1.0</span>  <span class="cm-number">0.0</span>  <span class="cm-number">0.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">3</span>  <span class="cm-number">0.0</span>  <span class="cm-number">0.0</span>  <span class="cm-number">1.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">4</span>  <span class="cm-number">0.0</span>  <span class="cm-number">0.0</span>  <span class="cm-number">1.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">5</span>  <span class="cm-number">0.0</span>  <span class="cm-number">0.0</span>  <span class="cm-number">1.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">6</span>  <span class="cm-number">0.0</span>  <span class="cm-number">1.0</span>  <span class="cm-number">0.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Joining the dummies back to the original data</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> [<span class="cm-number">346</span>]: <span class="cm-variable">df_G</span>.<span class="cm-property">join</span>(<span class="cm-variable">pd</span>.<span class="cm-property">get_dummies</span>(<span class="cm-variable">df_G</span>[<span class="cm-string">'key'</span>]))</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[<span class="cm-number">346</span>]: </span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-variable cm-error">key</span> &nbsp; <span class="cm-variable">val</span> &nbsp;  <span class="cm-variable">a</span> &nbsp;  <span class="cm-variable">b</span> &nbsp;  <span class="cm-variable">c</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">0</span> &nbsp; <span class="cm-variable">b</span> <span class="cm-operator">-</span><span class="cm-number">1.63</span>  <span class="cm-number">0.0</span>  <span class="cm-number">1.0</span>  <span class="cm-number">0.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">1</span> &nbsp; <span class="cm-variable">b</span> <span class="cm-operator">-</span><span class="cm-number">0.10</span>  <span class="cm-number">0.0</span>  <span class="cm-number">1.0</span>  <span class="cm-number">0.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">2</span> &nbsp; <span class="cm-variable">a</span>  <span class="cm-number">1.30</span>  <span class="cm-number">1.0</span>  <span class="cm-number">0.0</span>  <span class="cm-number">0.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">3</span> &nbsp; <span class="cm-variable">c</span>  <span class="cm-number">0.09</span>  <span class="cm-number">0.0</span>  <span class="cm-number">0.0</span>  <span class="cm-number">1.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">4</span> &nbsp; <span class="cm-variable">c</span>  <span class="cm-number">0.37</span>  <span class="cm-number">0.0</span>  <span class="cm-number">0.0</span>  <span class="cm-number">1.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">5</span> &nbsp; <span class="cm-variable">c</span>  <span class="cm-number">1.86</span>  <span class="cm-number">0.0</span>  <span class="cm-number">0.0</span>  <span class="cm-number">1.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">6</span> &nbsp; <span class="cm-variable">b</span>  <span class="cm-number">0.93</span>  <span class="cm-number">0.0</span>  <span class="cm-number">1.0</span>  <span class="cm-number">0.0</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 598px;"></div></div></div></pre><h3><a name='header-c822' class='md-header-anchor '></a>The Dummy Variable Trap</h3><p>If we build dummy variables for <strong>every</strong> level of a categorical variable, it leads to a situation where one or more of these dummies would be <strong>highly correlated</strong> leading to problems of multicollinearity. It is thus advised to create (k-1) dummies for a categorical variable with k levels.</p><p>Keeping this in mind, we can summarize the steps of dummification as</p><ul><li>Identify the categorical variables you want to create dummies from</li><li>Create the dummies for k-1 categories for each </li><li>Join the dummies back to the original table</li><li>Drop the categorical variables from step 1</li></ul><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap "><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code   " style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Create dummies, drop the categorical variable, and one of the dummies to avoid the trap</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []: (<span class="cm-variable">df_G</span>.<span class="cm-property">join</span>(<span class="cm-variable">pd</span>.<span class="cm-property">get_dummies</span>(<span class="cm-variable">df_G</span>[<span class="cm-string">'key'</span>], <span class="cm-variable">prefix</span>=<span class="cm-string">'dummy'</span>))</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  .<span class="cm-property">drop</span>(<span class="cm-string">'key'</span>, <span class="cm-variable">axis</span>=<span class="cm-number">1</span>)</span></pre><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  .<span class="cm-property">drop</span>(<span class="cm-string">'dummy_c'</span>, <span class="cm-variable">axis</span>=<span class="cm-number">1</span>))</span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[]: </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-variable">val</span>  <span class="cm-variable">dummy_a</span>  <span class="cm-variable">dummy_b</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">0</span> <span class="cm-operator">-</span><span class="cm-number">1.63</span> &nbsp; &nbsp;  <span class="cm-number">0.0</span> &nbsp; &nbsp;  <span class="cm-number">1.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">1</span> <span class="cm-operator">-</span><span class="cm-number">0.10</span> &nbsp; &nbsp;  <span class="cm-number">0.0</span> &nbsp; &nbsp;  <span class="cm-number">1.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">2</span>  <span class="cm-number">1.30</span> &nbsp; &nbsp;  <span class="cm-number">1.0</span> &nbsp; &nbsp;  <span class="cm-number">0.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">3</span>  <span class="cm-number">0.09</span> &nbsp; &nbsp;  <span class="cm-number">0.0</span> &nbsp; &nbsp;  <span class="cm-number">0.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">4</span>  <span class="cm-number">0.37</span> &nbsp; &nbsp;  <span class="cm-number">0.0</span> &nbsp; &nbsp;  <span class="cm-number">0.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">5</span>  <span class="cm-number">1.86</span> &nbsp; &nbsp;  <span class="cm-number">0.0</span> &nbsp; &nbsp;  <span class="cm-number">0.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">6</span>  <span class="cm-number">0.93</span> &nbsp; &nbsp;  <span class="cm-number">0.0</span> &nbsp; &nbsp;  <span class="cm-number">1.0</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 390px;"></div></div></div></pre><h2><a name='header-c841' class='md-header-anchor '></a>Reshaping Data</h2><p>Usually, for convenience and for storage efficiencies, data in relational databases is stored in the so called <code>long</code> or <code>stacked</code> format. This means that there are fewer columns and more rows, with label duplication in keys.</p><p>Example of <code>long</code> data</p><pre class='md-fences mock-cm' style='display:block;position:relative'>         date variable     value
0  2000-01-03        A  0.469112
1  2000-01-04        A -0.282863
2  2000-01-05        A -1.509059
3  2000-01-03        B -1.135632
4  2000-01-04        B  1.212112
5  2000-01-05        B -0.173215
6  2000-01-03        C  0.119209
7  2000-01-04        C -1.044236
8  2000-01-05        C -0.861849
9  2000-01-03        D -2.104569
10 2000-01-04        D -0.494929
11 2000-01-05        D  1.071804</pre><p>But for certain kinds of analysis (especially time series analysis), we might prefer to have the data in the <code>wide</code> format (more columns, unique labels in keys). Other applications would include cases where we have data at the transaction level for every customer (so multiple rows per customer) and we want to reduce it to one row per customer (typical input to most machine learning algoritms.) Reshaping functions also come in handy when creating visualizations.</p><p>Example of <code>wide</code> data (same DataFrame as above)</p><pre class='md-fences mock-cm' style='display:block;position:relative'>variable           A         B         C         D
date                                              
2000-01-03  0.469112 -1.135632  0.119209 -2.104569
2000-01-04 -0.282863  1.212112 -1.044236 -0.494929
2000-01-05 -1.509059 -0.173215 -0.861849  1.071804</pre><p>As should be evident from the examples above, both <code>long</code> and <code>wide</code> are just different representations of the same data!</p><h3><a name='header-c854' class='md-header-anchor '></a><code>stack()</code> and <code>unstack()</code></h3><p>For pandas DataFrames with hierarchical indices, <code>stack()</code> and <code>unstack()</code> provide a convenient way to reshape the data from wide-to-long or long-to-wide formats.</p><ul><li><code>stack</code> pivots the columns into rows (wide to long)</li><li><code>unstack</code> pivots rows into columns (long to wide.) 
It works with DataFrames that have a <code>hierarchical index</code></li></ul><p>Example <code>stack</code></p><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap "><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code    " style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Create a toy dataset in the LONG format</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Here, we use set_index to create a hierarchical index (combination of two columns)</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []: <span class="cm-variable">df_long</span> = (<span class="cm-variable">DataFrame</span>({<span class="cm-string">'group'</span>: <span class="cm-builtin">list</span>(<span class="cm-string">'PQR'</span> <span class="cm-operator">*</span> <span class="cm-number">4</span>),</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-string">'item'</span>: <span class="cm-builtin">list</span>(<span class="cm-string">'ABCD'</span> <span class="cm-operator">*</span> <span class="cm-number">3</span>),</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-string">'status'</span>: (<span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">12</span>).<span class="cm-property">round</span>(<span class="cm-number">2</span>))})</span></pre><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  .<span class="cm-property">set_index</span>([<span class="cm-string">'group'</span>, <span class="cm-string">'item'</span>]))</span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []: <span class="cm-variable">df_long</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[]: </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-variable">status</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">group</span> <span class="cm-variable">item</span> &nbsp; &nbsp; &nbsp;  </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">P</span> &nbsp; &nbsp; <span class="cm-variable">A</span> &nbsp; &nbsp; &nbsp; <span class="cm-number">0.81</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Q</span> &nbsp; &nbsp; <span class="cm-variable">B</span> &nbsp; &nbsp; &nbsp; <span class="cm-number">0.23</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">R</span> &nbsp; &nbsp; <span class="cm-variable">C</span> &nbsp; &nbsp;  <span class="cm-operator">-</span><span class="cm-number">0.75</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">P</span> &nbsp; &nbsp; <span class="cm-variable">D</span> &nbsp; &nbsp;  <span class="cm-operator">-</span><span class="cm-number">0.39</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Q</span> &nbsp; &nbsp; <span class="cm-variable">A</span> &nbsp; &nbsp;  <span class="cm-operator">-</span><span class="cm-number">0.05</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">R</span> &nbsp; &nbsp; <span class="cm-variable">B</span> &nbsp; &nbsp; &nbsp; <span class="cm-number">0.15</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">P</span> &nbsp; &nbsp; <span class="cm-variable">C</span> &nbsp; &nbsp; &nbsp; <span class="cm-number">0.96</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Q</span> &nbsp; &nbsp; <span class="cm-variable">D</span> &nbsp; &nbsp;  <span class="cm-operator">-</span><span class="cm-number">0.59</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">R</span> &nbsp; &nbsp; <span class="cm-variable">A</span> &nbsp; &nbsp;  <span class="cm-operator">-</span><span class="cm-number">0.81</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">P</span> &nbsp; &nbsp; <span class="cm-variable">B</span> &nbsp; &nbsp;  <span class="cm-operator">-</span><span class="cm-number">3.04</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Q</span> &nbsp; &nbsp; <span class="cm-variable">C</span> &nbsp; &nbsp;  <span class="cm-operator">-</span><span class="cm-number">0.89</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">R</span> &nbsp; &nbsp; <span class="cm-variable">D</span> &nbsp; &nbsp;  <span class="cm-operator">-</span><span class="cm-number">0.68</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []: <span class="cm-variable">df_long</span>.<span class="cm-property">unstack</span>()</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[]: </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp;  <span class="cm-variable">status</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">item</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">A</span> &nbsp; &nbsp; <span class="cm-variable">B</span> &nbsp; &nbsp; <span class="cm-variable">C</span> &nbsp; &nbsp; <span class="cm-variable">D</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">group</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">P</span> &nbsp; &nbsp; &nbsp; <span class="cm-number">0.81</span> <span class="cm-operator">-</span><span class="cm-number">3.04</span>  <span class="cm-number">0.96</span> <span class="cm-operator">-</span><span class="cm-number">0.39</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Q</span> &nbsp; &nbsp;  <span class="cm-operator">-</span><span class="cm-number">0.05</span>  <span class="cm-number">0.23</span> <span class="cm-operator">-</span><span class="cm-number">0.89</span> <span class="cm-operator">-</span><span class="cm-number">0.59</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">R</span> &nbsp; &nbsp;  <span class="cm-operator">-</span><span class="cm-number">0.81</span>  <span class="cm-number">0.15</span> <span class="cm-operator">-</span><span class="cm-number">0.75</span> <span class="cm-operator">-</span><span class="cm-number">0.68</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 832px;"></div></div></div></pre><p> Example <code>unstack</code></p><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap "><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Create a toy dataset in the WIDE format</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []: <span class="cm-variable">df_wide</span> = (<span class="cm-variable">DataFrame</span>(<span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">12</span>).<span class="cm-property">reshape</span>(<span class="cm-number">3</span>, <span class="cm-number">4</span>).<span class="cm-property">round</span>(<span class="cm-number">2</span>),</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-variable">index</span>=<span class="cm-builtin">list</span>(<span class="cm-string">'ABC'</span>), </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-variable">columns</span>=<span class="cm-builtin">list</span>(<span class="cm-string">'PQRS'</span>)))</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []: <span class="cm-variable">df_wide</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[]: </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp;  <span class="cm-variable">P</span> &nbsp; &nbsp; <span class="cm-variable">Q</span> &nbsp; &nbsp; <span class="cm-variable">R</span> &nbsp; &nbsp; <span class="cm-variable">S</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">A</span>  <span class="cm-number">1.43</span>  <span class="cm-number">1.11</span> <span class="cm-operator">-</span><span class="cm-number">1.80</span>  <span class="cm-number">0.24</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">B</span>  <span class="cm-number">0.19</span>  <span class="cm-number">1.15</span>  <span class="cm-number">1.46</span>  <span class="cm-number">0.83</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">C</span> <span class="cm-operator">-</span><span class="cm-number">0.75</span> <span class="cm-operator">-</span><span class="cm-number">0.48</span> <span class="cm-operator">-</span><span class="cm-number">0.64</span>  <span class="cm-number">1.84</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Use unstack to convert it to LONG</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []: <span class="cm-variable">df_wide</span>.<span class="cm-property">stack</span>()</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">A</span>  <span class="cm-variable">P</span> &nbsp;  <span class="cm-number">1.43</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; <span class="cm-variable">Q</span> &nbsp;  <span class="cm-number">1.11</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; <span class="cm-variable cm-error">R</span> &nbsp; <span class="cm-operator">-</span><span class="cm-number">1.80</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; <span class="cm-variable">S</span> &nbsp;  <span class="cm-number">0.24</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">B</span>  <span class="cm-variable">P</span> &nbsp;  <span class="cm-number">0.19</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; <span class="cm-variable">Q</span> &nbsp;  <span class="cm-number">1.15</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; <span class="cm-variable cm-error">R</span> &nbsp;  <span class="cm-number">1.46</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; <span class="cm-variable">S</span> &nbsp;  <span class="cm-number">0.83</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">C</span>  <span class="cm-variable">P</span> &nbsp; <span class="cm-operator">-</span><span class="cm-number">0.75</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; <span class="cm-variable">Q</span> &nbsp; <span class="cm-operator">-</span><span class="cm-number">0.48</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; <span class="cm-variable cm-error">R</span> &nbsp; <span class="cm-operator">-</span><span class="cm-number">0.64</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; <span class="cm-variable">S</span> &nbsp;  <span class="cm-number">1.84</span></span></pre><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">dtype</span>: <span class="cm-variable">float64</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 702px;"></div></div></div></pre><h3><a name='header-c871' class='md-header-anchor '></a><code>pivot()</code> and <code>pivot_table()</code></h3><p>The <code>df.pivot()</code> method takes the names of columns to be used as row (the <code>index=</code> parameter) and column indexes (the <code>columns=</code> parameter) and a column to fill in the data as (the <code>values=</code> parameter) and converts (<em>or pivots)</em> wide data to long data.</p><p>Simply put, <code>pivot</code> is just a convenient wrapper function that replaces the need to create a hierarchical index using <code>set_index</code> and reshaping with <code>stack</code>.</p><p>Example <code>pivot</code></p><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []: <span class="cm-variable">df_long</span>.<span class="cm-property">reset_index</span>(<span class="cm-variable">inplace</span>=<span class="cm-builtin">True</span>)</span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []: <span class="cm-variable">df_long</span>.<span class="cm-property">pivot</span>(<span class="cm-variable">index</span>=<span class="cm-string">'group'</span>, <span class="cm-variable">columns</span>=<span class="cm-string">'item'</span>, <span class="cm-variable">values</span>=<span class="cm-string">'status'</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">item</span> &nbsp; &nbsp;  <span class="cm-variable">A</span> &nbsp; &nbsp; <span class="cm-variable">B</span> &nbsp; &nbsp; <span class="cm-variable">C</span> &nbsp; &nbsp; <span class="cm-variable">D</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">group</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">P</span> &nbsp; &nbsp;  <span class="cm-number">0.81</span> <span class="cm-operator">-</span><span class="cm-number">3.04</span>  <span class="cm-number">0.96</span> <span class="cm-operator">-</span><span class="cm-number">0.39</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Q</span> &nbsp; &nbsp; <span class="cm-operator">-</span><span class="cm-number">0.05</span>  <span class="cm-number">0.23</span> <span class="cm-operator">-</span><span class="cm-number">0.89</span> <span class="cm-operator">-</span><span class="cm-number">0.59</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">R</span> &nbsp; &nbsp; <span class="cm-operator">-</span><span class="cm-number">0.81</span>  <span class="cm-number">0.15</span> <span class="cm-operator">-</span><span class="cm-number">0.75</span> <span class="cm-operator">-</span><span class="cm-number">0.68</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 234px;"></div></div></div></pre><p></p><p>The <code>pivot_table()</code>  function is similar to <code>pivot</code>, but </p><ul><li>can work with duplicate indices and </li><li>lets you specify an aggregation function</li></ul><p>For those with an understanding how pivot tables work in Excel, the <code>pivot_table</code> function in pandas is a very natural way of specifying the same things you would using Excel, ie, a variable for rows, a variable for columns, a variable for the data and an aggregation function like sum, mean or count.</p><p>In the resulting table, the number of rows will be equal to the number of unique levels of the variable passed with <code>index=</code>, the number of columns will be equal to the number of unique levels of the variable passed with <code>columns=</code> and the data in the table will be the summarization of the values of the variable passed with the <code>values=</code> parameter aggregated using the function passed with <code>aggfunc=</code> (default action uses <em>mean</em> ) </p><p>Example </p><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []: <span class="cm-variable">df</span> = (<span class="cm-variable">pd</span>.<span class="cm-property">DataFrame</span>({<span class="cm-string">'C1'</span>:<span class="cm-builtin">list</span>((<span class="cm-string">'x'</span> <span class="cm-operator">*</span> <span class="cm-number">4</span> <span class="cm-operator">+</span> <span class="cm-string">'y'</span><span class="cm-operator">*</span> <span class="cm-number">4</span>)<span class="cm-operator">*</span><span class="cm-number">2</span>),</span></pre></div><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-string">'C2'</span>:<span class="cm-builtin">list</span>(<span class="cm-string">'abbbaabaabbbaaba'</span>),</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-string">'N1'</span>:<span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">16</span>)})); <span class="cm-variable">df</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[]: </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; <span class="cm-variable cm-error">C1</span> <span class="cm-variable">C2</span> &nbsp; &nbsp; &nbsp;  <span class="cm-variable">N1</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">0</span> &nbsp; <span class="cm-variable">x</span>  <span class="cm-variable">a</span> <span class="cm-operator">-</span><span class="cm-number">0.720376</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">1</span> &nbsp; <span class="cm-variable">x</span>  <span class="cm-variable">b</span> <span class="cm-operator">-</span><span class="cm-number">0.717720</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">2</span> &nbsp; <span class="cm-variable">x</span>  <span class="cm-variable">b</span> <span class="cm-operator">-</span><span class="cm-number">0.411926</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">3</span> &nbsp; <span class="cm-variable">x</span>  <span class="cm-variable">b</span> <span class="cm-operator">-</span><span class="cm-number">0.478841</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">4</span> &nbsp; <span class="cm-variable">y</span>  <span class="cm-variable">a</span>  <span class="cm-number">0.338465</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">5</span> &nbsp; <span class="cm-variable">y</span>  <span class="cm-variable">a</span>  <span class="cm-number">1.309893</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">6</span> &nbsp; <span class="cm-variable">y</span>  <span class="cm-variable">b</span>  <span class="cm-number">0.050849</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">7</span> &nbsp; <span class="cm-variable">y</span>  <span class="cm-variable">a</span>  <span class="cm-number">1.739078</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">8</span> &nbsp; <span class="cm-variable">x</span>  <span class="cm-variable">a</span> <span class="cm-operator">-</span><span class="cm-number">1.201153</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">9</span> &nbsp; <span class="cm-variable">x</span>  <span class="cm-variable">b</span> <span class="cm-operator">-</span><span class="cm-number">1.178396</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">10</span>  <span class="cm-variable">x</span>  <span class="cm-variable">b</span> <span class="cm-operator">-</span><span class="cm-number">0.583237</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">11</span>  <span class="cm-variable">x</span>  <span class="cm-variable">b</span> <span class="cm-operator">-</span><span class="cm-number">0.785945</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">12</span>  <span class="cm-variable">y</span>  <span class="cm-variable">a</span> <span class="cm-operator">-</span><span class="cm-number">0.858983</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">13</span>  <span class="cm-variable">y</span>  <span class="cm-variable">a</span>  <span class="cm-number">1.641496</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">14</span>  <span class="cm-variable">y</span>  <span class="cm-variable">b</span>  <span class="cm-number">0.795528</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">15</span>  <span class="cm-variable">y</span>  <span class="cm-variable">a</span>  <span class="cm-number">0.444192</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []: (<span class="cm-variable">df</span>.<span class="cm-property">pivot_table</span>(<span class="cm-variable">index</span>=<span class="cm-string">'C1'</span>, </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">columns</span>=<span class="cm-string">'C2'</span>, </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">values</span>=<span class="cm-string">'N1'</span>,</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">aggfunc</span>=<span class="cm-string">'mean'</span>))</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">C2</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">a</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">b</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">C1</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">x</span>  <span class="cm-operator">-</span><span class="cm-number">0.960765</span> <span class="cm-operator">-</span><span class="cm-number">0.692677</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">y</span> &nbsp; <span class="cm-number">0.769024</span>  <span class="cm-number">0.423189</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 806px;"></div></div></div></pre><h2><a name='header-c897' class='md-header-anchor '></a><code>apply()</code> and <code>applymap()</code></h2><p>There are often situations in data analysis where you would want to apply an existing or a user-defined funtion to values in your dataset. The <code>apply()</code> and <code>applymap()</code> methods provide a powerful, yet simple interface for doing this while eliminating the need to write for-loops to iterate over data. Lambda functions are leveraged extensively here.</p><ul><li><code>applymap()</code> allows you to apply a function to each element of a DataFrame. </li><li><code>apply()</code> allows you to apply a function to rows/columns (controlled via the <code>axis=</code> parameter) of a DataFrame</li></ul><p>Example: <code>applymap()</code></p><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []: <span class="cm-variable">df_3</span> = <span class="cm-variable">DataFrame</span>(<span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">20</span>).<span class="cm-property">reshape</span>(<span class="cm-number">4</span>, <span class="cm-number">5</span>), </span></pre></div><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-variable">index</span>=<span class="cm-builtin">list</span>(<span class="cm-string">'abcd'</span>), </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-variable">columns</span>=<span class="cm-builtin">list</span>(<span class="cm-string">'pqrst'</span>))</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []: <span class="cm-variable">df_3</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[]: </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-variable">p</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">q</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">r</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">s</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">t</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">a</span>  <span class="cm-number">1.400444</span>  <span class="cm-number">0.915017</span> <span class="cm-operator">-</span><span class="cm-number">0.993813</span>  <span class="cm-number">0.153223</span>  <span class="cm-number">1.927246</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">b</span> <span class="cm-operator">-</span><span class="cm-number">1.099701</span> <span class="cm-operator">-</span><span class="cm-number">0.401442</span> <span class="cm-operator">-</span><span class="cm-number">1.357320</span>  <span class="cm-number">1.873588</span>  <span class="cm-number">1.006781</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">c</span> <span class="cm-operator">-</span><span class="cm-number">1.733929</span> <span class="cm-operator">-</span><span class="cm-number">0.410928</span>  <span class="cm-number">0.640509</span>  <span class="cm-number">1.219760</span> <span class="cm-operator">-</span><span class="cm-number">0.008854</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">d</span> <span class="cm-operator">-</span><span class="cm-number">0.727955</span> <span class="cm-operator">-</span><span class="cm-number">1.565173</span>  <span class="cm-number">1.084859</span>  <span class="cm-number">2.574694</span> <span class="cm-operator">-</span><span class="cm-number">0.449346</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Find the square root of each number</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []: <span class="cm-variable">df_3</span>.<span class="cm-property">applymap</span>(<span class="cm-keyword">lambda</span> <span class="cm-variable">x</span>: <span class="cm-variable">np</span>.<span class="cm-property">sqrt</span>(<span class="cm-variable">np</span>.<span class="cm-property">abs</span>(<span class="cm-variable">x</span>)))</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[]: </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-variable">p</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">q</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">r</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">s</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">t</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">a</span>  <span class="cm-number">1.183403</span>  <span class="cm-number">0.956565</span>  <span class="cm-number">0.996902</span>  <span class="cm-number">0.391437</span>  <span class="cm-number">1.388253</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">b</span>  <span class="cm-number">1.048666</span>  <span class="cm-number">0.633595</span>  <span class="cm-number">1.165041</span>  <span class="cm-number">1.368791</span>  <span class="cm-number">1.003385</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">c</span>  <span class="cm-number">1.316787</span>  <span class="cm-number">0.641037</span>  <span class="cm-number">0.800318</span>  <span class="cm-number">1.104428</span>  <span class="cm-number">0.094098</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">d</span>  <span class="cm-number">0.853203</span>  <span class="cm-number">1.251069</span>  <span class="cm-number">1.041566</span>  <span class="cm-number">1.604585</span>  <span class="cm-number">0.67033</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 494px;"></div></div></div></pre><p></p><p>Example: Using <code>apply</code> to standardize variables in a dataset. </p><blockquote><p><em>Standardization is the process of reducing each numeric variable&#39;s mean to 0 and standard deviation to 1 by subtracting each value from its column mean and dividing it by the column standard deviation.</em></p></blockquote><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap "><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code " style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Create a 200 x 5 toy dataframe with all numeric columns</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []: <span class="cm-variable">df_4</span> = <span class="cm-variable">DataFrame</span>(<span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">1000</span>).<span class="cm-property">reshape</span>(<span class="cm-number">200</span>, <span class="cm-number">5</span>), </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-variable">columns</span>=[<span class="cm-string">'Col_'</span> <span class="cm-operator">+</span> <span class="cm-builtin">str</span>(<span class="cm-variable">x</span>) <span class="cm-keyword">for</span> <span class="cm-variable">x</span> <span class="cm-keyword">in</span> <span class="cm-builtin">range</span>(<span class="cm-number">5</span>)]); <span class="cm-variable">df_4</span>.<span class="cm-property">head</span>()</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[]:</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp;  <span class="cm-variable">Col_0</span> &nbsp; &nbsp; <span class="cm-variable">Col_1</span> &nbsp; &nbsp; <span class="cm-variable">Col_2</span> &nbsp; &nbsp; <span class="cm-variable">Col_3</span> &nbsp; &nbsp; <span class="cm-variable">Col_4</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">0</span> <span class="cm-operator">-</span><span class="cm-number">1.157990</span>  <span class="cm-number">0.681349</span>  <span class="cm-number">1.030490</span>  <span class="cm-number">0.014480</span> <span class="cm-operator">-</span><span class="cm-number">1.114365</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">1</span>  <span class="cm-number">0.173016</span>  <span class="cm-number">1.080648</span> <span class="cm-operator">-</span><span class="cm-number">0.265723</span> <span class="cm-operator">-</span><span class="cm-number">0.219716</span> <span class="cm-operator">-</span><span class="cm-number">0.555620</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">2</span>  <span class="cm-number">0.885419</span> <span class="cm-operator">-</span><span class="cm-number">1.179766</span> <span class="cm-operator">-</span><span class="cm-number">0.491304</span> <span class="cm-operator">-</span><span class="cm-number">0.883111</span> <span class="cm-operator">-</span><span class="cm-number">1.635053</span></span></pre><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">3</span> <span class="cm-operator">-</span><span class="cm-number">2.011335</span> <span class="cm-operator">-</span><span class="cm-number">0.115281</span>  <span class="cm-number">0.385405</span> <span class="cm-operator">-</span><span class="cm-number">1.302427</span> <span class="cm-operator">-</span><span class="cm-number">0.051955</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">4</span>  <span class="cm-number">0.984635</span>  <span class="cm-number">0.063711</span> <span class="cm-operator">-</span><span class="cm-number">1.048197</span> <span class="cm-operator">-</span><span class="cm-number">0.401136</span> <span class="cm-operator">-</span><span class="cm-number">1.221760</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Apply the standardization function to each column</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []: <span class="cm-variable">df_4_standardized</span> = <span class="cm-variable">df_4</span>.<span class="cm-property">apply</span>(<span class="cm-keyword">lambda</span> <span class="cm-variable">x</span>: (<span class="cm-variable">x</span> <span class="cm-operator">-</span> <span class="cm-variable">x</span>.<span class="cm-property">mean</span>())<span class="cm-operator">/</span><span class="cm-variable">x</span>.<span class="cm-property">std</span>())</span></pre><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []: <span class="cm-variable">df_4_standardized</span>.<span class="cm-property">head</span>()</span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[]: </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp;  <span class="cm-variable">Col_0</span> &nbsp; &nbsp; <span class="cm-variable">Col_1</span> &nbsp; &nbsp; <span class="cm-variable">Col_2</span> &nbsp; &nbsp; <span class="cm-variable">Col_3</span> &nbsp; &nbsp; <span class="cm-variable">Col_4</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">0</span> <span class="cm-operator">-</span><span class="cm-number">1.242254</span>  <span class="cm-number">0.716079</span>  <span class="cm-number">0.952361</span>  <span class="cm-number">0.027532</span> <span class="cm-operator">-</span><span class="cm-number">1.017306</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">1</span>  <span class="cm-number">0.247038</span>  <span class="cm-number">1.107296</span> <span class="cm-operator">-</span><span class="cm-number">0.376966</span> <span class="cm-operator">-</span><span class="cm-number">0.202084</span> <span class="cm-operator">-</span><span class="cm-number">0.464047</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">2</span>  <span class="cm-number">1.044162</span> <span class="cm-operator">-</span><span class="cm-number">1.107369</span> <span class="cm-operator">-</span><span class="cm-number">0.608310</span> <span class="cm-operator">-</span><span class="cm-number">0.852506</span> <span class="cm-operator">-</span><span class="cm-number">1.532882</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">3</span> <span class="cm-operator">-</span><span class="cm-number">2.197081</span> <span class="cm-operator">-</span><span class="cm-number">0.064428</span>  <span class="cm-number">0.290796</span> <span class="cm-operator">-</span><span class="cm-number">1.263623</span>  <span class="cm-number">0.034673</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">4</span>  <span class="cm-number">1.155177</span>  <span class="cm-number">0.110941</span> <span class="cm-operator">-</span><span class="cm-number">1.179430</span> <span class="cm-operator">-</span><span class="cm-number">0.379956</span> <span class="cm-operator">-</span><span class="cm-number">1.123646</span> &nbsp;  </span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Check if standardization was successful</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []: <span class="cm-variable">df_4_standardized</span>.<span class="cm-property">mean</span>().<span class="cm-property">round</span>(<span class="cm-number">2</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Col_0</span> &nbsp;  <span class="cm-number">0.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Col_1</span> &nbsp;  <span class="cm-number">0.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Col_2</span> &nbsp;  <span class="cm-number">0.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Col_3</span> &nbsp;  <span class="cm-number">0.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Col_4</span> &nbsp;  <span class="cm-number">0.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">dtype</span>: <span class="cm-variable">float64</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []: <span class="cm-variable">df_4_standardized</span>.<span class="cm-property">std</span>()</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Col_0</span> &nbsp;  <span class="cm-number">1.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Col_1</span> &nbsp;  <span class="cm-number">1.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Col_2</span> &nbsp;  <span class="cm-number">1.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Col_3</span> &nbsp;  <span class="cm-number">1.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Col_4</span> &nbsp;  <span class="cm-number">1.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">dtype</span>: <span class="cm-variable">float64</span> &nbsp;  </span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1066px;"></div></div></div></pre><h2><a name='header-c920' class='md-header-anchor '></a>Split - Apply - Combine using <code>groupby()</code></h2><p>In Data Analysis workflows, operations like data loading, cleaning and merging are usually followed by <strong>summarizations</strong> using some grouping variable(s). This includes evaluating summary statistics over variables, within-group transformations, computing pivot-tables and by-group analyses. </p><blockquote><p> <em>Pandas DataFrames have a <code>.groupby()</code> method that works much in the same way as the SQL <code>GROUP BY</code> aggregations.</em> </p></blockquote><p>This process involves three steps      </p><ul><li><p><strong>Splitting</strong> the data into groups based on the levels of a categorical variable. This is generally the simplest step. Each &#39;group&#39; is a subset of the original data with the same columns, and rows filtered for the particular level of the categorical variable.</p></li><li><p><strong>Applying</strong> a function to each group individually. There are 3 classes of functions we might consider:</p><ul><li><em>Aggregate</em> – estimate summary statistics (like counts, means) for each group. 
This will reduce the size of the data.</li><li><em>Transform</em> – within group standardization, imputation using group values. 
The size of the data will not change.</li><li><em>Filter</em> – retain or ignore rows that belong to a particular group</li></ul></li><li><p><strong>Combining</strong> the results into a Series orDataframe. <code>pandas</code> handles this step gracefully, and in most cases the returned DataFrame is neatly formatted.</p></li></ul><p>The image below shows a graphical explanation of this process: 
We split by <code>key</code>, apply the function <code>sum</code> to each group formed and then append the results.</p><p>Note that as a result of the aggregation, there will exist one row per level of the categorical variable.</p><p><img src='sac.png' alt='' /></p><p></p><p>With <code>pandas</code>, we can implement this strategy as</p><ul><li><p><strong>Split</strong></p></li><li><p>A DataFrame can be split up by rows(axis=0) or columns(axis=1) into groups.</p><ul><li>We use <code>pd.groupby()</code> to create a <code>groupby</code> object</li></ul></li><li><p><strong>Apply</strong></p><ul><li>A function is applied to each group using <code>.agg()</code> or <code>.apply()</code></li></ul></li><li><p><strong>Combine</strong></p><ul><li>The results of applying functions to groups are put together into an object</li></ul></li></ul><h3><a name='header-c990' class='md-header-anchor '></a>The <code>DataFrameGroupBy</code> object</h3><p>This object is created by calling the <code>groupby()</code> function on a DataFrame, passing a list of column names that we wish to use for grouping. These objects </p><ul><li><p>have a <code>.size()</code> method, which returns the count of elements in each group.</p></li><li><p>can be directly subsetted using square brackets and lists of column names to select variables for aggregation</p></li><li><p>have optimized methods for general aggregation operations like</p><ul><li><code>count, sum</code></li><li><code>mean, median, std, var</code></li><li><code>first, last</code></li><li><code>min, max</code></li></ul></li><li><p>specialized methods like <code>.describe()</code> </p></li></ul><blockquote><p> <em>By far, the most important <code>DataFrameGroupBy</code> object methods are <code>agg(), transform()</code>, and <code>apply()</code></em></p></blockquote><p>Syntax:</p><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap  "><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Create a groupBy object</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">gb_obj</span> = <span class="cm-variable">my_df</span>.<span class="cm-property">groupby</span>([<span class="cm-string">'col_x'</span>])</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Summarize each group and combine results</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">gb_obj</span>.<span class="cm-property">my_func</span>()</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 130px;"></div></div></div></pre><p>Example:</p><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Create a toy dataframe with 2 numeric and 2 categorical columns</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []: <span class="cm-variable">df</span> = <span class="cm-variable">DataFrame</span>({<span class="cm-string">'k1'</span>: <span class="cm-builtin">list</span>(<span class="cm-string">'abcd'</span> <span class="cm-operator">*</span> <span class="cm-number">25</span>),</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-string">'k2'</span>: <span class="cm-builtin">list</span>(<span class="cm-string">'xy'</span> <span class="cm-operator">*</span> <span class="cm-number">25</span> <span class="cm-operator">+</span> <span class="cm-string">'yx'</span> <span class="cm-operator">*</span> <span class="cm-number">25</span>),</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-string">'v1'</span>: <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">rand</span>(<span class="cm-number">100</span>),</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-string">'v2'</span>: <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">rand</span>(<span class="cm-number">100</span>)})</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []: <span class="cm-variable">df</span>.<span class="cm-property">head</span>()</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[]: </span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-variable cm-error">k1</span> <span class="cm-variable">k2</span> &nbsp; &nbsp; &nbsp;  <span class="cm-variable">v1</span> &nbsp; &nbsp; &nbsp;  <span class="cm-variable">v2</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">0</span>  <span class="cm-variable">a</span>  <span class="cm-variable">x</span>  <span class="cm-number">0.037904</span>  <span class="cm-number">0.042694</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">1</span>  <span class="cm-variable">b</span>  <span class="cm-variable">y</span>  <span class="cm-number">0.638175</span>  <span class="cm-number">0.277161</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">2</span>  <span class="cm-variable">c</span>  <span class="cm-variable">x</span>  <span class="cm-number">0.872149</span>  <span class="cm-number">0.084649</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">3</span>  <span class="cm-variable">d</span>  <span class="cm-variable">y</span>  <span class="cm-number">0.317732</span>  <span class="cm-number">0.044503</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">4</span>  <span class="cm-variable">a</span>  <span class="cm-variable">x</span>  <span class="cm-number">0.972954</span>  <span class="cm-number">0.890182</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 364px;"></div></div></div></pre><p></p><h3><a name='header-c1029' class='md-header-anchor '></a>Grouping by One key</h3><p>This results in a summarized data frame indexed by levels of the key.</p><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Since k1 has 4 categories, this will return 4 rows</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []: <span class="cm-variable">df</span>.<span class="cm-property">groupby</span>(<span class="cm-string">'k1'</span>).<span class="cm-property">mean</span>()</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[]: </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-variable">v1</span> &nbsp; &nbsp; &nbsp;  <span class="cm-variable">v2</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">k1</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">a</span> &nbsp; <span class="cm-number">0.521484</span>  <span class="cm-number">0.571119</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">b</span> &nbsp; <span class="cm-number">0.521301</span>  <span class="cm-number">0.388422</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">c</span> &nbsp; <span class="cm-number">0.492358</span>  <span class="cm-number">0.555235</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">d</span> &nbsp; <span class="cm-number">0.508871</span>  <span class="cm-number">0.419638</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Since k2 has 2 categories, this will return 2 rows</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []: <span class="cm-variable">df</span>.<span class="cm-property">groupby</span>(<span class="cm-string">'k2'</span>).<span class="cm-property">sum</span>()</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[]: </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">v1</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">v2</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">k2</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">x</span> &nbsp; <span class="cm-number">24.547462</span>  <span class="cm-number">22.477416</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">y</span> &nbsp; <span class="cm-number">26.552891</span>  <span class="cm-number">25.882961</span> &nbsp;  </span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 442px;"></div></div></div></pre><p></p><h3><a name='header-c1035' class='md-header-anchor '></a>Grouping by Two keys</h3><p>This will result in a summarized dataframe with a hierarchical index.</p><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># A dataframe with a hierarchical index formed by a combination of the levels</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []: <span class="cm-variable">df</span>.<span class="cm-property">groupby</span>([<span class="cm-string">'k1'</span>, <span class="cm-string">'k2'</span>]).<span class="cm-property">sum</span>()</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[]: </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">v1</span> &nbsp; &nbsp; &nbsp;  <span class="cm-variable">v2</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">k1</span> <span class="cm-variable">k2</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">a</span>  <span class="cm-variable">x</span> &nbsp; <span class="cm-number">6.069234</span>  <span class="cm-number">6.044262</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; <span class="cm-variable">y</span> &nbsp; <span class="cm-number">6.967875</span>  <span class="cm-number">8.233720</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">b</span>  <span class="cm-variable">x</span> &nbsp; <span class="cm-number">6.270785</span>  <span class="cm-number">4.383762</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; <span class="cm-variable">y</span> &nbsp; <span class="cm-number">6.761731</span>  <span class="cm-number">5.326794</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">c</span>  <span class="cm-variable">x</span> &nbsp; <span class="cm-number">5.665012</span>  <span class="cm-number">6.593410</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; <span class="cm-variable">y</span> &nbsp; <span class="cm-number">6.643937</span>  <span class="cm-number">7.287471</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">d</span>  <span class="cm-variable">x</span> &nbsp; <span class="cm-number">6.542430</span>  <span class="cm-number">5.455982</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; <span class="cm-variable">y</span> &nbsp; <span class="cm-number">6.179347</span>  <span class="cm-number">5.034976</span> &nbsp;  </span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 338px;"></div></div></div></pre><p></p><h3><a name='header-c1041' class='md-header-anchor '></a>Column-wise aggregations (using optimized statistical methods)</h3><p>For simple statistical aggregations of numeric columns of a DataFrame we can call methods like <code>mean</code> and <code>sum</code></p><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap "><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Finding the sums of a Series by group</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []: <span class="cm-variable">df</span>.<span class="cm-property">groupby</span>(<span class="cm-string">'k1'</span>)[<span class="cm-string">'v1'</span>].<span class="cm-property">sum</span>()</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[]: </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">k1</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">a</span> &nbsp;  <span class="cm-number">13.037110</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">b</span> &nbsp;  <span class="cm-number">13.032516</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">c</span> &nbsp;  <span class="cm-number">12.308950</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">d</span> &nbsp;  <span class="cm-number">12.721777</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Name</span>: <span class="cm-variable">v1</span>, <span class="cm-variable">dtype</span>: <span class="cm-variable">float64</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Summing all Series of a DataFrame</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []: <span class="cm-variable">df</span>.<span class="cm-property">groupby</span>(<span class="cm-string">'k2'</span>).<span class="cm-property">sum</span>()</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[]: </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">v1</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">v2</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">k2</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">x</span> &nbsp; <span class="cm-number">24.547462</span>  <span class="cm-number">22.477416</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">y</span> &nbsp; <span class="cm-number">26.552891</span>  <span class="cm-number">25.882961</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 442px;"></div></div></div></pre><p></p><h3><a name='header-c1047' class='md-header-anchor '></a>The <code>.agg( )</code> method</h3><p>When we have a <code>DataFrameGroupBy</code> object, we may choose to apply </p><ul><li>one or more functions to one or more columns,<br/></li><li>different functions to different columns. </li></ul><p>The <code>.agg()</code> method allows us to easily and flexibly specify these details. It takes as arguments the following – </p><ul><li><em>list of function names</em> to be applied to all selected columns, or</li><li><em>tuples of (colname, function)</em> to be applied to all selected columns, or</li><li><em>dict of (colname, function)</em> to be applied to each column</li></ul><h3><a name='header-c1069' class='md-header-anchor '></a><code>.agg()</code> Examples</h3><ol start='' ><li>Apply more than 1 function(s) to selected column(s) by passing names of functions as a list</li></ol><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Apply min, mean, max and max to v1 grouped by k1</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []: <span class="cm-variable">df</span>.<span class="cm-property">groupby</span>(<span class="cm-string">'k1'</span>)[<span class="cm-string">'v1'</span>].<span class="cm-property">agg</span>([<span class="cm-string">'min'</span>, <span class="cm-string">'mean'</span>, <span class="cm-string">'max'</span>])</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[]: </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-builtin">min</span> &nbsp; &nbsp;  <span class="cm-variable">mean</span> &nbsp; &nbsp; &nbsp; <span class="cm-builtin">max</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">k1</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">a</span> &nbsp; <span class="cm-number">0.037904</span>  <span class="cm-number">0.521484</span>  <span class="cm-number">0.972954</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">b</span> &nbsp; <span class="cm-number">0.167095</span>  <span class="cm-number">0.521301</span>  <span class="cm-number">0.902595</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">c</span> &nbsp; <span class="cm-number">0.115346</span>  <span class="cm-number">0.492358</span>  <span class="cm-number">0.872149</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">d</span> &nbsp; <span class="cm-number">0.127018</span>  <span class="cm-number">0.508871</span>  <span class="cm-number">0.904145</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Apply min and max to all numeric columns of df grouped by k2</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []: <span class="cm-variable">df</span>.<span class="cm-property">groupby</span>(<span class="cm-string">'k2'</span>)[[<span class="cm-string">'v1'</span>, <span class="cm-string">'v2'</span>]].<span class="cm-property">agg</span>([<span class="cm-string">'min'</span>, <span class="cm-string">'max'</span>])</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[]: </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-variable">v1</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-variable">v2</span> &nbsp; &nbsp; &nbsp; &nbsp;  </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-builtin">min</span> &nbsp; &nbsp; &nbsp; <span class="cm-builtin">max</span> &nbsp; &nbsp; &nbsp; <span class="cm-builtin">min</span> &nbsp; &nbsp; &nbsp; <span class="cm-builtin">max</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">k2</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">x</span> &nbsp; <span class="cm-number">0.037904</span>  <span class="cm-number">0.972954</span>  <span class="cm-number">0.026337</span>  <span class="cm-number">0.986863</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">y</span> &nbsp; <span class="cm-number">0.118852</span>  <span class="cm-number">0.897646</span>  <span class="cm-number">0.008764</span>  <span class="cm-number">0.997575</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 468px;"></div></div></div></pre><ol start='2' ><li>We can supply names for the columns in the (new) aggregated DataFrame to the <code>agg()</code> method, <strong>in a list of tuples</strong>. The first element of the 2-tuple should be the <strong>name</strong> and the second element should be the <strong>function</strong></li></ol><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap "><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Provide names for the aggregated columns</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []: <span class="cm-variable">df</span>.<span class="cm-property">groupby</span>(<span class="cm-string">'k1'</span>)[[<span class="cm-string">'v1'</span>, <span class="cm-string">'v2'</span>]].<span class="cm-property">agg</span>([(<span class="cm-string">'smallest'</span>,<span class="cm-string">'min'</span>), (<span class="cm-string">'largest'</span>, <span class="cm-string">'max'</span>)])</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[]: </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-variable">v1</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-variable">v2</span> &nbsp; &nbsp; &nbsp; &nbsp;  </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-variable">smallest</span> &nbsp; <span class="cm-variable">largest</span>  <span class="cm-variable">smallest</span> &nbsp; <span class="cm-variable">largest</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">k1</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">a</span> &nbsp; <span class="cm-number">0.037904</span>  <span class="cm-number">0.972954</span>  <span class="cm-number">0.042694</span>  <span class="cm-number">0.986863</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">b</span> &nbsp; <span class="cm-number">0.167095</span>  <span class="cm-number">0.902595</span>  <span class="cm-number">0.008764</span>  <span class="cm-number">0.997575</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">c</span> &nbsp; <span class="cm-number">0.115346</span>  <span class="cm-number">0.872149</span>  <span class="cm-number">0.016577</span>  <span class="cm-number">0.982617</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">d</span> &nbsp; <span class="cm-number">0.127018</span>  <span class="cm-number">0.904145</span>  <span class="cm-number">0.044503</span>  <span class="cm-number">0.949769</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 286px;"></div></div></div></pre><ol start='3' ><li>We can supply DataFrame column names and which functions to apply to each, <strong>in a dictionary</strong></li></ol><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap "><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Apply max and min to v1; and mean and sum to v2; all grouped by k1</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []: <span class="cm-variable">df</span>.<span class="cm-property">groupby</span>(<span class="cm-string">'k1'</span>)[[<span class="cm-string">'v1'</span>, <span class="cm-string">'v2'</span>]].<span class="cm-property">agg</span>({<span class="cm-string">'v1'</span>: [<span class="cm-string">'max'</span>, <span class="cm-string">'min'</span>], <span class="cm-string">'v2'</span>: [<span class="cm-string">'mean'</span>, <span class="cm-string">'sum'</span>]})</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[]: </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-variable">v1</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-variable">v2</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-builtin">max</span> &nbsp; &nbsp; &nbsp; <span class="cm-builtin">min</span> &nbsp; &nbsp;  <span class="cm-variable">mean</span> &nbsp; &nbsp; &nbsp;  <span class="cm-builtin">sum</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">k1</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span></pre><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">a</span> &nbsp; <span class="cm-number">0.972954</span>  <span class="cm-number">0.037904</span>  <span class="cm-number">0.571119</span>  <span class="cm-number">14.277982</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">b</span> &nbsp; <span class="cm-number">0.902595</span>  <span class="cm-number">0.167095</span>  <span class="cm-number">0.388422</span> &nbsp; <span class="cm-number">9.710556</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">c</span> &nbsp; <span class="cm-number">0.872149</span>  <span class="cm-number">0.115346</span>  <span class="cm-number">0.555235</span>  <span class="cm-number">13.880881</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">d</span> &nbsp; <span class="cm-number">0.904145</span>  <span class="cm-number">0.127018</span>  <span class="cm-number">0.419638</span>  <span class="cm-number">10.490958</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 286px;"></div></div></div></pre><p></p><h3><a name='header-c1088' class='md-header-anchor '></a>The <code>.apply( )</code> method</h3><p>This method takes as arguments the following: </p><ul><li>a general or <strong>user defined function</strong></li><li>any other <strong>parameters</strong> that the function would take</li></ul><p>Remember that any function passed through <code>apply</code> should be designed to work on a subset of the DataFrame. Groups are afterall just smaller versions of the original table with the same columns, and all rows corresponding to a particular level of the <code>groupby</code> variable.</p><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap  " lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">#&nbsp; Function to Retrieve the top N cases from each group </span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">topN</span>(<span class="cm-variable">data</span>, <span class="cm-variable">col</span>, <span class="cm-variable">N</span>):</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-string">"""</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-string"><span class="cm-tab">    </span>This function takes as input a DataFrame, a column name, and a numeric value</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-string"><span class="cm-tab">    </span>It sorts the DataFrame in descending order by the values of the column </span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-string"><span class="cm-tab">    </span>Then it returns the Top N records from that column</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-string"><span class="cm-tab">    </span>"""</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-keyword">return</span> <span class="cm-variable">data</span>.<span class="cm-property">sort_values</span>(<span class="cm-variable">by</span>=<span class="cm-variable">col</span>, <span class="cm-variable">ascending</span>=<span class="cm-builtin">False</span>).<span class="cm-property">loc</span>[:, <span class="cm-variable">col</span>].<span class="cm-property">head</span>(<span class="cm-variable">N</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Apply the function to groups formed by levels of k2, return the top 5</span></span></pre><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []: <span class="cm-variable">df</span>.<span class="cm-property">groupby</span>(<span class="cm-string">'k2'</span>).<span class="cm-property">apply</span>(<span class="cm-variable">topN</span>, <span class="cm-variable">col</span>=<span class="cm-string">'v1'</span>, <span class="cm-variable">N</span>=<span class="cm-number">3</span>)</span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[]:</span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">k2</span> &nbsp;  </span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">x</span> &nbsp; <span class="cm-number">4</span> &nbsp; &nbsp; <span class="cm-number">0.972954</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-number">71</span> &nbsp;  <span class="cm-number">0.904145</span></span></pre><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-number">57</span> &nbsp;  <span class="cm-number">0.902595</span></span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">y</span> &nbsp; <span class="cm-number">68</span> &nbsp;  <span class="cm-number">0.897646</span></span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-number">21</span> &nbsp;  <span class="cm-number">0.896949</span></span></pre></div><div class="" style="position: relative;"><pre><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-number">72</span> &nbsp;  <span class="cm-number">0.884951</span></span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Name</span>: <span class="cm-variable">v1</span>, <span class="cm-variable">dtype</span>: <span class="cm-variable">float64</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 520px;"></div></div></div></pre><h2><a name='header-c1104' class='md-header-anchor '></a>Combine 2 DataFrames with <code>pd.merge</code></h2><p><code>pandas.merge</code> is similar to the <em>SQL join</em> operations. It links rows of tables using one or more <em>keys</em>. The following graphic outlines the specifics of common SQL join operations.</p><p><img src='joins.jpeg' alt='' /></p><p><strong>Syntax</strong></p><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">pd</span>.<span class="cm-property">merge</span>(<span class="cm-variable">df1</span>, <span class="cm-variable">df2</span>, <span class="cm-variable">how</span>=<span class="cm-string">'left'</span>, <span class="cm-variable">on</span>=<span class="cm-string">'key'</span>, </span></pre></div><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">left_on</span>=<span class="cm-builtin">None</span>, <span class="cm-variable">right_on</span>=<span class="cm-builtin">None</span>, </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">left_index</span>=<span class="cm-builtin">False</span>, <span class="cm-variable">right_index</span>=<span class="cm-builtin">False</span>, </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">sort</span>=<span class="cm-builtin">True</span>, <span class="cm-variable">copy</span>=<span class="cm-builtin">True</span>,</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">suffixes</span>=(<span class="cm-string">'x'</span>, <span class="cm-string">'y'</span>))</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 130px;"></div></div></div></pre><p>The syntax includes specifications of the following arguments</p><ul><li><p><strong>Which column to merge on;</strong> </p><ul><li>the <code>on=&#39;key&#39;</code> if the same key is present in the two DFs, </li><li>or <code>left_on=&#39;lkey&#39;, right_on=&#39;rkey&#39;</code> if the keys have different names in the DFs </li><li>[<em>Note</em>] To merge on multiple keys, pass a <em>list of column names</em></li></ul></li></ul><ul><li><p><strong>The nature of the join;</strong> </p><ul><li>the <code>how=</code> option, with <code>left</code>, <code>right</code>, <code>outer</code></li><li>By default, the merge is an <code>inner</code> join</li></ul></li><li><p>Tuple of string values to append to <strong>overlapping column names</strong> to identify them in the merged dataset</p><ul><li>the <code>suffixes=</code> option</li><li>defaults to <code>(&#39;_x&#39;, &#39;_y&#39;)</code></li></ul></li><li><p>If you wish <strong>to merge on the index</strong>, pass <code>left_index=True</code> or <code>right_index=True</code> or both.</p></li></ul><ul><li><p>Sort the result DataFrame by the join keys in lexicographical order or not;</p><ul><li><code>sort=</code> option; </li><li>Defaults to <code>True</code>, setting to <code>False</code> will improve performance substantially in many cases</li></ul></li></ul><p><strong>Example</strong></p><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Let's define a few toy datasets to use as examples</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">df0</span> = <span class="cm-variable">DataFrame</span>({<span class="cm-string">'key'</span>: [<span class="cm-string">'a'</span>, <span class="cm-string">'b'</span>, <span class="cm-string">'c'</span>, <span class="cm-string">'d'</span>, <span class="cm-string">'e'</span>], </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-string">'data0'</span>: <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randint</span>(<span class="cm-number">0</span>, <span class="cm-number">100</span>, <span class="cm-number">5</span>)})</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">df1</span> = <span class="cm-variable">DataFrame</span>({<span class="cm-string">'key'</span>: [<span class="cm-string">'b'</span>, <span class="cm-string">'b'</span>, <span class="cm-string">'a'</span>, <span class="cm-string">'c'</span>, <span class="cm-string">'a'</span>, <span class="cm-string">'a'</span>, <span class="cm-string">'b'</span>], </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-string">'data1'</span>: <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randint</span>(<span class="cm-number">0</span>, <span class="cm-number">100</span>, <span class="cm-number">7</span>)})</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">df2</span> = <span class="cm-variable">DataFrame</span>({<span class="cm-string">'key'</span>: [<span class="cm-string">'a'</span>, <span class="cm-string">'b'</span>, <span class="cm-string">'d'</span>, <span class="cm-string">'f'</span>, <span class="cm-string">'g'</span>], </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-string">'data2'</span>: <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randint</span>(<span class="cm-number">0</span>, <span class="cm-number">100</span>, <span class="cm-number">5</span>)})</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">df3</span> = <span class="cm-variable">DataFrame</span>({<span class="cm-string">'lkey'</span>: [<span class="cm-string">'b'</span>, <span class="cm-string">'b'</span>, <span class="cm-string">'a'</span>, <span class="cm-string">'c'</span>, <span class="cm-string">'a'</span>, <span class="cm-string">'a'</span>, <span class="cm-string">'b'</span>], </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-string">'data3'</span>: <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randint</span>(<span class="cm-number">0</span>, <span class="cm-number">100</span>, <span class="cm-number">7</span>)})</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">df4</span> = <span class="cm-variable">DataFrame</span>({<span class="cm-string">'rkey'</span>: [<span class="cm-string">'a'</span>, <span class="cm-string">'b'</span>, <span class="cm-string">'d'</span>], </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-string">'data4'</span>: <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randint</span>(<span class="cm-number">0</span>, <span class="cm-number">100</span>, <span class="cm-number">3</span>)})</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">print</span> <span class="cm-variable">df0</span>, <span class="cm-string">'\n\n'</span>, <span class="cm-variable">df1</span>, <span class="cm-string">'\n\n'</span>, <span class="cm-variable">df2</span>, <span class="cm-string">'\n\n'</span>, <span class="cm-variable">df3</span>, <span class="cm-string">'\n\n'</span>, <span class="cm-variable">df4</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; <span class="cm-variable">data0</span> <span class="cm-variable">key</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-number">0</span> &nbsp; &nbsp;  <span class="cm-number">1</span> &nbsp; <span class="cm-variable">a</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-number">1</span> &nbsp; &nbsp; <span class="cm-number">55</span> &nbsp; <span class="cm-variable">b</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-number">2</span> &nbsp; &nbsp;  <span class="cm-number">5</span> &nbsp; <span class="cm-variable">c</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-number">3</span> &nbsp; &nbsp; <span class="cm-number">59</span> &nbsp; <span class="cm-variable">d</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-number">4</span> &nbsp; &nbsp; <span class="cm-number">67</span> &nbsp; <span class="cm-variable">e</span> </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; <span class="cm-variable">data1</span> <span class="cm-variable">key</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-number">0</span> &nbsp; &nbsp; <span class="cm-number">29</span> &nbsp; <span class="cm-variable">b</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-number">1</span> &nbsp; &nbsp; <span class="cm-number">39</span> &nbsp; <span class="cm-variable">b</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-number">2</span> &nbsp; &nbsp; <span class="cm-number">26</span> &nbsp; <span class="cm-variable">a</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-number">3</span> &nbsp; &nbsp; <span class="cm-number">39</span> &nbsp; <span class="cm-variable">c</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-number">4</span> &nbsp; &nbsp; <span class="cm-number">91</span> &nbsp; <span class="cm-variable">a</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-number">5</span> &nbsp; &nbsp; <span class="cm-number">39</span> &nbsp; <span class="cm-variable">a</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-number">6</span> &nbsp; &nbsp; <span class="cm-number">43</span> &nbsp; <span class="cm-variable">b</span> </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; <span class="cm-variable">data2</span> <span class="cm-variable">key</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-number">0</span> &nbsp; &nbsp; <span class="cm-number">86</span> &nbsp; <span class="cm-variable">a</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-number">1</span> &nbsp; &nbsp; <span class="cm-number">85</span> &nbsp; <span class="cm-variable">b</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-number">2</span> &nbsp; &nbsp; <span class="cm-number">25</span> &nbsp; <span class="cm-variable">d</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-number">3</span> &nbsp; &nbsp; <span class="cm-number">98</span> &nbsp; <span class="cm-variable">f</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-number">4</span> &nbsp; &nbsp;  <span class="cm-number">8</span> &nbsp; <span class="cm-variable">g</span> </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; <span class="cm-variable">data3</span> <span class="cm-variable">lkey</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-number">0</span> &nbsp; &nbsp; <span class="cm-number">29</span> &nbsp;  <span class="cm-variable">b</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-number">1</span> &nbsp; &nbsp; <span class="cm-number">16</span> &nbsp;  <span class="cm-variable">b</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-number">2</span> &nbsp; &nbsp; <span class="cm-number">60</span> &nbsp;  <span class="cm-variable">a</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-number">3</span> &nbsp; &nbsp; <span class="cm-number">22</span> &nbsp;  <span class="cm-variable">c</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-number">4</span> &nbsp; &nbsp; <span class="cm-number">81</span> &nbsp;  <span class="cm-variable">a</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-number">5</span> &nbsp; &nbsp; <span class="cm-number">28</span> &nbsp;  <span class="cm-variable">a</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-number">6</span> &nbsp; &nbsp; <span class="cm-number">95</span> &nbsp;  <span class="cm-variable">b</span> </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; <span class="cm-variable">data4</span> <span class="cm-variable">rkey</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-number">0</span> &nbsp; &nbsp; <span class="cm-number">23</span> &nbsp;  <span class="cm-variable">a</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-number">1</span> &nbsp; &nbsp; <span class="cm-number">48</span> &nbsp;  <span class="cm-variable">b</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-number">2</span> &nbsp; &nbsp; <span class="cm-number">84</span> &nbsp;  <span class="cm-variable">d</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1326px;"></div></div></div></pre><h3><a name='header-c1167' class='md-header-anchor '></a>Default merge (Inner Join)</h3><p>This leads to an <em>inner join</em> by default (output key is the <strong>intersection</strong> of input keys)
Merge happens on the column &#39;<em>key</em>&#39; which is common to both datasets.</p><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># inner join</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">pd</span>.<span class="cm-property">merge</span>(<span class="cm-variable">df0</span>, <span class="cm-variable">df2</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; <span class="cm-variable">data0</span> <span class="cm-variable">key</span>  <span class="cm-variable">data2</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-number">0</span> &nbsp; &nbsp;  <span class="cm-number">1</span> &nbsp; <span class="cm-variable">a</span> &nbsp; &nbsp; <span class="cm-number">86</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-number">1</span> &nbsp; &nbsp; <span class="cm-number">55</span> &nbsp; <span class="cm-variable">b</span> &nbsp; &nbsp; <span class="cm-number">85</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-number">2</span> &nbsp; &nbsp; <span class="cm-number">59</span> &nbsp; <span class="cm-variable">d</span> &nbsp; &nbsp; <span class="cm-number">25</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 182px;"></div></div></div></pre><p>Note that we could&#39;ve written </p><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">pd</span>.<span class="cm-property">merge</span>(<span class="cm-variable">df0</span>, <span class="cm-variable">df2</span>, <span class="cm-variable">on</span>=<span class="cm-string">'key'</span>, <span class="cm-variable">how</span>=<span class="cm-string">'inner'</span>) </span></pre></div></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 26px;"></div></div></div></pre><p>to achieve the same effect.</p><p>If there are no matching column names in the two DataFrames to merge on, the default merge will throw an error.</p><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">pd</span>.<span class="cm-property">merge</span>(<span class="cm-variable">df0</span>, <span class="cm-variable">df4</span>)</span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-operator">---------------------------------------------------------------------------</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">MergeError</span>: <span class="cm-variable">No</span> <span class="cm-variable">common</span> <span class="cm-variable">columns</span> <span class="cm-variable">to</span> <span class="cm-variable">perform</span> <span class="cm-variable">merge</span> <span class="cm-variable">on</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 104px;"></div></div></div></pre><p></p><h3><a name='header-c1182' class='md-header-anchor '></a>Outer Join</h3><p>This leads to a <strong>union</strong> of keys, missing values are imputed in the resulting dataset wherever a match isn&#39;t found in either table.</p><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">pd</span>.<span class="cm-property">merge</span>(<span class="cm-variable">df0</span>, <span class="cm-variable">df2</span>, <span class="cm-variable">how</span>=<span class="cm-string">'outer'</span>)</span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; <span class="cm-variable">data0</span> <span class="cm-variable">key</span>  <span class="cm-variable">data2</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-number">0</span> &nbsp;  <span class="cm-number">1.0</span> &nbsp; <span class="cm-variable">a</span> &nbsp; <span class="cm-number">86.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-number">1</span> &nbsp; <span class="cm-number">55.0</span> &nbsp; <span class="cm-variable">b</span> &nbsp; <span class="cm-number">85.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-number">2</span> &nbsp;  <span class="cm-number">5.0</span> &nbsp; <span class="cm-variable">c</span> &nbsp;  <span class="cm-variable">NaN</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-number">3</span> &nbsp; <span class="cm-number">59.0</span> &nbsp; <span class="cm-variable">d</span> &nbsp; <span class="cm-number">25.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-number">4</span> &nbsp; <span class="cm-number">67.0</span> &nbsp; <span class="cm-variable">e</span> &nbsp;  <span class="cm-variable">NaN</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-number">5</span> &nbsp;  <span class="cm-variable">NaN</span> &nbsp; <span class="cm-variable">f</span> &nbsp; <span class="cm-number">98.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-number">6</span> &nbsp;  <span class="cm-variable">NaN</span> &nbsp; <span class="cm-variable">g</span> &nbsp;  <span class="cm-number">8.0</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 260px;"></div></div></div></pre><h3><a name='header-c1187' class='md-header-anchor '></a>Left Join</h3><p>The value for &#39;<strong>c</strong>&#39; is absent in df2, so there will be a <code>NaN</code> in column data2 in the resulting dataset.</p><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">pd</span>.<span class="cm-property">merge</span>(<span class="cm-variable">df1</span>, <span class="cm-variable">df2</span>, <span class="cm-variable">how</span>=<span class="cm-string">'left'</span>)</span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; <span class="cm-variable">data1</span> <span class="cm-variable">key</span>  <span class="cm-variable">data2</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">0</span> &nbsp; &nbsp; <span class="cm-number">57</span> &nbsp; <span class="cm-variable">b</span> &nbsp; <span class="cm-number">18.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">1</span> &nbsp; &nbsp; <span class="cm-number">70</span> &nbsp; <span class="cm-variable">b</span> &nbsp; <span class="cm-number">18.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">2</span> &nbsp; &nbsp; <span class="cm-number">86</span> &nbsp; <span class="cm-variable">a</span> &nbsp; <span class="cm-number">60.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">3</span> &nbsp; &nbsp; <span class="cm-number">34</span> &nbsp; <span class="cm-variable">c</span> &nbsp;  <span class="cm-variable">NaN</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">4</span> &nbsp; &nbsp;  <span class="cm-number">4</span> &nbsp; <span class="cm-variable">a</span> &nbsp; <span class="cm-number">60.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">5</span> &nbsp; &nbsp;  <span class="cm-number">3</span> &nbsp; <span class="cm-variable">a</span> &nbsp; <span class="cm-number">60.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">6</span> &nbsp; &nbsp; <span class="cm-number">67</span> &nbsp; <span class="cm-variable">b</span> &nbsp; <span class="cm-number">18.0</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 260px;"></div></div></div></pre><p></p><h3><a name='header-c1193' class='md-header-anchor '></a>Merge with keys having different names in the two dataframes</h3><p>The <code>left_on=</code> and <code>right_on=</code> options save us from having to rename columns before merge.</p><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">pd</span>.<span class="cm-property">merge</span>(<span class="cm-variable">df1</span>, <span class="cm-variable">df4</span>, <span class="cm-variable">left_on</span>=<span class="cm-string">'key'</span>, <span class="cm-variable">right_on</span>=<span class="cm-string">'rkey'</span>)</span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; <span class="cm-variable">data1</span> <span class="cm-variable">key</span>  <span class="cm-variable">data4</span> <span class="cm-variable">rkey</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">0</span> &nbsp; &nbsp; <span class="cm-number">57</span> &nbsp; <span class="cm-variable">b</span> &nbsp; &nbsp; <span class="cm-number">41</span> &nbsp;  <span class="cm-variable">b</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">1</span> &nbsp; &nbsp; <span class="cm-number">70</span> &nbsp; <span class="cm-variable">b</span> &nbsp; &nbsp; <span class="cm-number">41</span> &nbsp;  <span class="cm-variable">b</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">2</span> &nbsp; &nbsp; <span class="cm-number">67</span> &nbsp; <span class="cm-variable">b</span> &nbsp; &nbsp; <span class="cm-number">41</span> &nbsp;  <span class="cm-variable">b</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">3</span> &nbsp; &nbsp; <span class="cm-number">86</span> &nbsp; <span class="cm-variable">a</span> &nbsp; &nbsp; <span class="cm-number">71</span> &nbsp;  <span class="cm-variable">a</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">4</span> &nbsp; &nbsp;  <span class="cm-number">4</span> &nbsp; <span class="cm-variable">a</span> &nbsp; &nbsp; <span class="cm-number">71</span> &nbsp;  <span class="cm-variable">a</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">5</span> &nbsp; &nbsp;  <span class="cm-number">3</span> &nbsp; <span class="cm-variable">a</span> &nbsp; &nbsp; <span class="cm-number">71</span> &nbsp;  <span class="cm-variable">a</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 234px;"></div></div></div></pre><h3><a name='header-c1197' class='md-header-anchor '></a>Merge with DataFrame containing overlapping column names</h3><p>By default, pandas will append suffixes (<code>_x and _y</code>) to the column names in the merged dataset to identify where the column came from.</p><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap "><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Add a column with the same name to df1 and df2</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []:</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">df1</span>[<span class="cm-string">'newcol'</span>] = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">7</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">df2</span>[<span class="cm-string">'newcol'</span>] = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">5</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">pd</span>.<span class="cm-property">merge</span>(<span class="cm-variable">df1</span>, <span class="cm-variable">df2</span>, <span class="cm-variable">on</span>=<span class="cm-string">'key'</span>)</span></pre><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[]:</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; <span class="cm-variable cm-error">data1</span> <span class="cm-variable">key</span>  <span class="cm-variable">newcol_x</span>  <span class="cm-variable">data2</span>  <span class="cm-variable">newcol_y</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">0</span> &nbsp; &nbsp; <span class="cm-number">33</span> &nbsp; <span class="cm-variable">b</span>  <span class="cm-number">2.178623</span> &nbsp; &nbsp; <span class="cm-number">72</span> <span class="cm-operator">-</span><span class="cm-number">0.379224</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">1</span> &nbsp; &nbsp;  <span class="cm-number">3</span> &nbsp; <span class="cm-variable">b</span>  <span class="cm-number">0.288692</span> &nbsp; &nbsp; <span class="cm-number">72</span> <span class="cm-operator">-</span><span class="cm-number">0.379224</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">2</span> &nbsp; &nbsp; <span class="cm-number">91</span> &nbsp; <span class="cm-variable">b</span> <span class="cm-operator">-</span><span class="cm-number">0.176319</span> &nbsp; &nbsp; <span class="cm-number">72</span> <span class="cm-operator">-</span><span class="cm-number">0.379224</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">3</span> &nbsp; &nbsp;  <span class="cm-number">3</span> &nbsp; <span class="cm-variable">a</span> <span class="cm-operator">-</span><span class="cm-number">0.765213</span> &nbsp; &nbsp; <span class="cm-number">10</span> <span class="cm-operator">-</span><span class="cm-number">0.915644</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">4</span> &nbsp; &nbsp;  <span class="cm-number">2</span> &nbsp; <span class="cm-variable">a</span> <span class="cm-operator">-</span><span class="cm-number">0.371988</span> &nbsp; &nbsp; <span class="cm-number">10</span> <span class="cm-operator">-</span><span class="cm-number">0.915644</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">5</span> &nbsp; &nbsp;  <span class="cm-number">2</span> &nbsp; <span class="cm-variable">a</span>  <span class="cm-number">0.926292</span> &nbsp; &nbsp; <span class="cm-number">10</span> <span class="cm-operator">-</span><span class="cm-number">0.915644</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 390px;"></div></div></div></pre><p>We could specify other suffixes explicitly with the <code>suffixes=</code> option</p><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap "><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">pd</span>.<span class="cm-property">merge</span>(<span class="cm-variable">df1</span>, <span class="cm-variable">df2</span>, <span class="cm-variable">on</span>=<span class="cm-string">'key'</span>, <span class="cm-variable">suffixes</span>=[<span class="cm-string">'_df1'</span>, <span class="cm-string">'_df2'</span>])</span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-variable">data1</span> <span class="cm-variable">key</span>  <span class="cm-variable">newcol_df1</span>  <span class="cm-variable">data2</span>  <span class="cm-variable">newcol_df2</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">0</span> &nbsp; &nbsp; <span class="cm-number">33</span> &nbsp; <span class="cm-variable">b</span> &nbsp;  <span class="cm-number">2.178623</span> &nbsp; &nbsp; <span class="cm-number">72</span> &nbsp; <span class="cm-operator">-</span><span class="cm-number">0.379224</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">1</span> &nbsp; &nbsp;  <span class="cm-number">3</span> &nbsp; <span class="cm-variable">b</span> &nbsp;  <span class="cm-number">0.288692</span> &nbsp; &nbsp; <span class="cm-number">72</span> &nbsp; <span class="cm-operator">-</span><span class="cm-number">0.379224</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">2</span> &nbsp; &nbsp; <span class="cm-number">91</span> &nbsp; <span class="cm-variable">b</span> &nbsp; <span class="cm-operator">-</span><span class="cm-number">0.176319</span> &nbsp; &nbsp; <span class="cm-number">72</span> &nbsp; <span class="cm-operator">-</span><span class="cm-number">0.379224</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">3</span> &nbsp; &nbsp;  <span class="cm-number">3</span> &nbsp; <span class="cm-variable">a</span> &nbsp; <span class="cm-operator">-</span><span class="cm-number">0.765213</span> &nbsp; &nbsp; <span class="cm-number">10</span> &nbsp; <span class="cm-operator">-</span><span class="cm-number">0.915644</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">4</span> &nbsp; &nbsp;  <span class="cm-number">2</span> &nbsp; <span class="cm-variable">a</span> &nbsp; <span class="cm-operator">-</span><span class="cm-number">0.371988</span> &nbsp; &nbsp; <span class="cm-number">10</span> &nbsp; <span class="cm-operator">-</span><span class="cm-number">0.915644</span></span></pre><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">5</span> &nbsp; &nbsp;  <span class="cm-number">2</span> &nbsp; <span class="cm-variable">a</span> &nbsp;  <span class="cm-number">0.926292</span> &nbsp; &nbsp; <span class="cm-number">10</span> &nbsp; <span class="cm-operator">-</span><span class="cm-number">0.915644</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 234px;"></div></div></div></pre><h3><a name='header-c1206' class='md-header-anchor '></a>Merge when the key is the <code>index</code></h3><p>The pandas <code>merge</code> is so flexible that even if the <em>key</em> is the index in one or both DataFrames, the user wouldn&#39;t have to convert them into columns before the merge.</p><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap  "><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Set lkey to be the index of df3</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">df3</span>.<span class="cm-property">set_index</span>(<span class="cm-string">'lkey'</span>, <span class="cm-variable">inplace</span>=<span class="cm-builtin">True</span>)</span></pre><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># We specify that for the left df we will use the column called 'key' and for the right df, we will use its index for the merge</span></span></pre></div><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">pd</span>.<span class="cm-property">merge</span>(<span class="cm-variable">df2</span>, <span class="cm-variable">df3</span>, <span class="cm-variable">how</span>=<span class="cm-string">'left'</span>, <span class="cm-variable">left_on</span>=<span class="cm-string">'key'</span>, <span class="cm-variable">right_index</span>=<span class="cm-builtin">True</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 156px;"></div></div></div></pre><h2><a name='header-c1212' class='md-header-anchor '></a>Combine multiple DataFrames with <code>join()</code></h2><p><code>.join()</code> is a convenient <strong>DataFrame method</strong> for combining many DataFrames objects with the same or similar indexes but (non-overlapping) columns into a single result DataFrame.</p><ul><li>By default, the <code>join</code> method performs a <em>left join</em> on the join keys.</li><li>For simple <strong>index-on-index merges</strong> we can pass a list of DataFrames to <code>join.</code></li></ul><blockquote><p> <em>The <code>join</code> operation is equivalent to performing a <code>reduce</code> on a list of DataFrames that have the same index.</em></p></blockquote><p>Syntax</p><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap "><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">df1</span>.<span class="cm-property">join</span>(<span class="cm-variable">df2</span>)</span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># which is equivalent to</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">pd</span>.<span class="cm-property">merge</span>(<span class="cm-variable">df1</span>, <span class="cm-variable">df2</span>, <span class="cm-variable">how</span>=<span class="cm-string">'left'</span>, <span class="cm-variable">right_index</span>=<span class="cm-builtin">True</span>, <span class="cm-variable">left_index</span>=<span class="cm-builtin">True</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># we can alter the nature of the join </span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">df1</span>.<span class="cm-property">join</span>(<span class="cm-variable">df2</span>, <span class="cm-variable">how</span>=<span class="cm-string">'outer'</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 182px;"></div></div></div></pre><p></p><p>Example</p><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []:</span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Create dataFrames with partially overlapping index objects</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">df</span> = <span class="cm-variable">DataFrame</span>(<span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randint</span>(<span class="cm-number">0</span>, <span class="cm-number">50</span>, <span class="cm-number">32</span>).<span class="cm-property">reshape</span>(<span class="cm-number">8</span>, <span class="cm-number">4</span>), </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">columns</span>=<span class="cm-builtin">list</span>(<span class="cm-string">'WXYZ'</span>), </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">index</span>=<span class="cm-builtin">list</span>(<span class="cm-string">'abcdefgh'</span>))</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">df1</span> = <span class="cm-variable">df</span>.<span class="cm-property">ix</span>[<span class="cm-number">2</span>:, [<span class="cm-string">'W'</span>, <span class="cm-string">'X'</span>]]</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">df2</span> = <span class="cm-variable">df</span>.<span class="cm-property">ix</span>[:<span class="cm-number">5</span>, [<span class="cm-string">'Y'</span>, <span class="cm-string">'Z'</span>]]</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">print</span> <span class="cm-variable">df</span>, <span class="cm-string">'\n\n'</span>, <span class="cm-variable">df1</span>, <span class="cm-string">'\n\n'</span>, <span class="cm-variable">df2</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[]:</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-variable">W</span> &nbsp; <span class="cm-variable">X</span> &nbsp; <span class="cm-variable">Y</span> &nbsp; <span class="cm-variable">Z</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">a</span> &nbsp; <span class="cm-number">9</span>  <span class="cm-number">11</span>  <span class="cm-number">19</span>  <span class="cm-number">33</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">b</span>  <span class="cm-number">12</span>  <span class="cm-number">48</span> &nbsp; <span class="cm-number">6</span>  <span class="cm-number">33</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">c</span>  <span class="cm-number">18</span> &nbsp; <span class="cm-number">7</span>  <span class="cm-number">18</span>  <span class="cm-number">39</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">d</span>  <span class="cm-number">11</span>  <span class="cm-number">12</span>  <span class="cm-number">15</span>  <span class="cm-number">23</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">e</span>  <span class="cm-number">36</span> &nbsp; <span class="cm-number">5</span>  <span class="cm-number">32</span>  <span class="cm-number">38</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">f</span>  <span class="cm-number">35</span>  <span class="cm-number">22</span>  <span class="cm-number">40</span>  <span class="cm-number">36</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">g</span>  <span class="cm-number">40</span>  <span class="cm-number">29</span>  <span class="cm-number">11</span>  <span class="cm-number">10</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">h</span>  <span class="cm-number">37</span>  <span class="cm-number">14</span>  <span class="cm-number">32</span>  <span class="cm-number">39</span> </span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-variable">W</span> &nbsp; <span class="cm-variable">X</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">c</span>  <span class="cm-number">18</span> &nbsp; <span class="cm-number">7</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">d</span>  <span class="cm-number">11</span>  <span class="cm-number">12</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">e</span>  <span class="cm-number">36</span> &nbsp; <span class="cm-number">5</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">f</span>  <span class="cm-number">35</span>  <span class="cm-number">22</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">g</span>  <span class="cm-number">40</span>  <span class="cm-number">29</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">h</span>  <span class="cm-number">37</span>  <span class="cm-number">14</span> </span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-variable">Y</span> &nbsp; <span class="cm-variable">Z</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">a</span>  <span class="cm-number">19</span>  <span class="cm-number">33</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">b</span> &nbsp; <span class="cm-number">6</span>  <span class="cm-number">33</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">c</span>  <span class="cm-number">18</span>  <span class="cm-number">39</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">d</span>  <span class="cm-number">15</span>  <span class="cm-number">23</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">e</span>  <span class="cm-number">32</span>  <span class="cm-number">38</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Perform the join</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []: <span class="cm-variable">df1</span>.<span class="cm-property">join</span>(<span class="cm-variable">df2</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[]:</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-variable">W</span> &nbsp; <span class="cm-variable">X</span> &nbsp; &nbsp; <span class="cm-variable">Y</span> &nbsp; &nbsp; <span class="cm-variable">Z</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">c</span>  <span class="cm-number">18</span> &nbsp; <span class="cm-number">7</span>  <span class="cm-number">18.0</span>  <span class="cm-number">39.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">d</span>  <span class="cm-number">11</span>  <span class="cm-number">12</span>  <span class="cm-number">15.0</span>  <span class="cm-number">23.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">e</span>  <span class="cm-number">36</span> &nbsp; <span class="cm-number">5</span>  <span class="cm-number">32.0</span>  <span class="cm-number">38.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">f</span>  <span class="cm-number">35</span>  <span class="cm-number">22</span> &nbsp; <span class="cm-variable">NaN</span> &nbsp; <span class="cm-variable">NaN</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">g</span>  <span class="cm-number">40</span>  <span class="cm-number">29</span> &nbsp; <span class="cm-variable">NaN</span> &nbsp; <span class="cm-variable">NaN</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">h</span>  <span class="cm-number">37</span>  <span class="cm-number">14</span> &nbsp; <span class="cm-variable">NaN</span> &nbsp; <span class="cm-variable">NaN</span> &nbsp;  </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  </span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1196px;"></div></div></div></pre><p>The real strength of the join method is apparent when we have multiple dataFrames. Then, instead of having to write a number of <code>merge</code> statements, we can get away with writing a single <code>join</code>.</p><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Create a couple more DFs with the same index</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []:</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">df3</span> = <span class="cm-variable">df</span>.<span class="cm-property">ix</span>[<span class="cm-number">0</span>:<span class="cm-number">3</span>, [<span class="cm-string">'X'</span>, <span class="cm-string">'Z'</span>]]</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">df3</span>.<span class="cm-property">columns</span> = [<span class="cm-string">'P'</span>, <span class="cm-string">'Q'</span>]</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">df4</span> = <span class="cm-variable">df</span>.<span class="cm-property">ix</span>[<span class="cm-number">4</span>:<span class="cm-number">6</span>, [<span class="cm-string">'W'</span>]]</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">df4</span>.<span class="cm-property">columns</span> = [<span class="cm-string">'R'</span>]</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">print</span> <span class="cm-variable">df3</span>, <span class="cm-string">"\n\n"</span>, <span class="cm-variable">df4</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[]:</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-variable">P</span> &nbsp; <span class="cm-variable">Q</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">a</span>  <span class="cm-number">11</span>  <span class="cm-number">33</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">b</span>  <span class="cm-number">48</span>  <span class="cm-number">33</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">c</span> &nbsp; <span class="cm-number">7</span>  <span class="cm-number">39</span> </span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-variable">R</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">e</span>  <span class="cm-number">36</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">f</span>  <span class="cm-number">35</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Merging multiple DFs with the same index by passing a list of names to .join</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []: <span class="cm-variable">df1</span>.<span class="cm-property">join</span>([<span class="cm-variable">df2</span>, <span class="cm-variable">df3</span>, <span class="cm-variable">df4</span>])</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[]:</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-variable">W</span> &nbsp; <span class="cm-variable">X</span> &nbsp; &nbsp; <span class="cm-variable">Y</span> &nbsp; &nbsp; <span class="cm-variable">Z</span> &nbsp;  <span class="cm-variable">P</span> &nbsp; &nbsp; <span class="cm-variable">Q</span> &nbsp; &nbsp; <span class="cm-variable">R</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">c</span>  <span class="cm-number">18</span> &nbsp; <span class="cm-number">7</span>  <span class="cm-number">18.0</span>  <span class="cm-number">39.0</span>  <span class="cm-number">7.0</span>  <span class="cm-number">39.0</span> &nbsp; <span class="cm-variable">NaN</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">d</span>  <span class="cm-number">11</span>  <span class="cm-number">12</span>  <span class="cm-number">15.0</span>  <span class="cm-number">23.0</span>  <span class="cm-variable">NaN</span> &nbsp; <span class="cm-variable">NaN</span> &nbsp; <span class="cm-variable">NaN</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">e</span>  <span class="cm-number">36</span> &nbsp; <span class="cm-number">5</span>  <span class="cm-number">32.0</span>  <span class="cm-number">38.0</span>  <span class="cm-variable">NaN</span> &nbsp; <span class="cm-variable">NaN</span>  <span class="cm-number">36.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">f</span>  <span class="cm-number">35</span>  <span class="cm-number">22</span> &nbsp; <span class="cm-variable">NaN</span> &nbsp; <span class="cm-variable">NaN</span>  <span class="cm-variable">NaN</span> &nbsp; <span class="cm-variable">NaN</span>  <span class="cm-number">35.0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">g</span>  <span class="cm-number">40</span>  <span class="cm-number">29</span> &nbsp; <span class="cm-variable">NaN</span> &nbsp; <span class="cm-variable">NaN</span>  <span class="cm-variable">NaN</span> &nbsp; <span class="cm-variable">NaN</span> &nbsp; <span class="cm-variable">NaN</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">h</span>  <span class="cm-number">37</span>  <span class="cm-number">14</span> &nbsp; <span class="cm-variable">NaN</span> &nbsp; <span class="cm-variable">NaN</span>  <span class="cm-variable">NaN</span> &nbsp; <span class="cm-variable">NaN</span> &nbsp; <span class="cm-variable">NaN</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 754px;"></div></div></div></pre><p>Since the default action is a <code>left join</code> we observe that all values of the index in <code>df1</code> are retained in the output, and missing values are imputed whereever no matching values are found. This action can be altered by passing the <code>how=</code> parameter.</p><h2><a name='header-c1237' class='md-header-anchor '></a>Combine multiple DataFrames, Series with <code>pd.concat()</code></h2><p>The <code>concat()</code> function in pandas is used to concatenate pandas objects along a particular axis. This operation is synonymous with  <code>binding, stacking, union, rbind, cbind</code> functions in other languages. </p><p>Concatentation can happen along either axis, the action being governed by the <code>axis=</code> parameter.</p><ul><li>With <code>axis=0</code> the objects will be <em>appended vertically</em>, i.e. the resulting object will have more <strong>rows</strong>. This is similar to the <code>rbind</code> operation in R and the <code>UNION</code> operation in SQL.</li><li>With <code>axis=1</code> the objects will be <em>concatenated horizontally</em>, leading to an object with more <strong>columns</strong>. This is analogous to an <code>outer join</code></li></ul><p>Depending on whether the objects have overlapping index (or column) labels, the concat will also include merging of the data where an overlap is found.</p><p>Syntax</p><pre class='md-fences mock-cm' style='display:block;position:relative'>pd.concat([list-of-series/dataframe-objects], axis=0_or_1)</pre><p></p><p>Examples</p><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Create toy Series with non-overlapping indices</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []:</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">s1</span> = <span class="cm-variable">Series</span>(<span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">3</span>), <span class="cm-variable">index</span>=<span class="cm-builtin">list</span>(<span class="cm-string">'abc'</span>))</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">s2</span> = <span class="cm-variable">Series</span>(<span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">4</span>), <span class="cm-variable">index</span>=<span class="cm-builtin">list</span>(<span class="cm-string">'defg'</span>))</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">s3</span> = <span class="cm-variable">Series</span>(<span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">2</span>), <span class="cm-variable">index</span>=<span class="cm-builtin">list</span>(<span class="cm-string">'hi'</span>))</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">print</span> <span class="cm-string">'\n\n'</span>, <span class="cm-variable">s1</span>, <span class="cm-string">'\n\n'</span>, <span class="cm-variable">s2</span>, <span class="cm-string">'\n\n'</span>, <span class="cm-variable">s3</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[]:</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">a</span> &nbsp;  <span class="cm-number">0.766440</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">b</span> &nbsp; <span class="cm-operator">-</span><span class="cm-number">1.022994</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">c</span> &nbsp;  <span class="cm-number">1.801808</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">dtype</span>: <span class="cm-variable">float64</span> </span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">d</span> &nbsp; <span class="cm-operator">-</span><span class="cm-number">0.410916</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">e</span> &nbsp;  <span class="cm-number">2.007578</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">f</span> &nbsp; <span class="cm-operator">-</span><span class="cm-number">1.303415</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">g</span> &nbsp; <span class="cm-operator">-</span><span class="cm-number">0.194217</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">dtype</span>: <span class="cm-variable">float64</span> </span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">h</span> &nbsp; <span class="cm-operator">-</span><span class="cm-number">1.401666</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">i</span> &nbsp;  <span class="cm-number">0.156245</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">dtype</span>: <span class="cm-variable">float64</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 572px;"></div></div></div></pre><ol start='' ><li>For <code>Series</code> objects with <strong>no index overlap</strong></li></ol><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># with axis=0 (default) will append the Series (~rbind)</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []:</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">pd</span>.<span class="cm-property">concat</span>([<span class="cm-variable">s1</span>, <span class="cm-variable">s2</span>, <span class="cm-variable">s3</span>])</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span> []:</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">a</span> &nbsp;  <span class="cm-number">0.766440</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">b</span> &nbsp; <span class="cm-operator">-</span><span class="cm-number">1.022994</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">c</span> &nbsp;  <span class="cm-number">1.801808</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">d</span> &nbsp; <span class="cm-operator">-</span><span class="cm-number">0.410916</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">e</span> &nbsp;  <span class="cm-number">2.007578</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">f</span> &nbsp; <span class="cm-operator">-</span><span class="cm-number">1.303415</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">g</span> &nbsp; <span class="cm-operator">-</span><span class="cm-number">0.194217</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">h</span> &nbsp; <span class="cm-operator">-</span><span class="cm-number">1.401666</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">i</span> &nbsp;  <span class="cm-number">0.156245</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">dtype</span>: <span class="cm-variable">float64</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># with axis=1 will *merge* the Series to produce a DF (~full outer join)</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []:</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">pd</span>.<span class="cm-property">concat</span>([<span class="cm-variable">s1</span>, <span class="cm-variable">s2</span>, <span class="cm-variable">s3</span>], <span class="cm-variable">axis</span>=<span class="cm-number">1</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[]:</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-number">0</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">1</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">2</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">a</span>  <span class="cm-number">0.766440</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">NaN</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">NaN</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">b</span> <span class="cm-operator">-</span><span class="cm-number">1.022994</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">NaN</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">NaN</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">c</span>  <span class="cm-number">1.801808</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">NaN</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">NaN</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">d</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">NaN</span> <span class="cm-operator">-</span><span class="cm-number">0.410916</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">NaN</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">e</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">NaN</span>  <span class="cm-number">2.007578</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">NaN</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">f</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">NaN</span> <span class="cm-operator">-</span><span class="cm-number">1.303415</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">NaN</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">g</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">NaN</span> <span class="cm-operator">-</span><span class="cm-number">0.194217</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">NaN</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">h</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">NaN</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">NaN</span> <span class="cm-operator">-</span><span class="cm-number">1.401666</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">i</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">NaN</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">NaN</span>  <span class="cm-number">0.156245</span> &nbsp;  </span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 806px;"></div></div></div></pre><ol start='2' ><li>For <code>Series</code> objects <strong>with an overlap on indexes</strong>, we can specify the <code>join=</code> parameter to intersect the data. Note that the <code>join=</code> option takes only <code>&#39;inner&#39;</code> and <code>&#39;outer&#39;</code> as valid arguments.</li></ol><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Create a new Series</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []:</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">s4</span> = <span class="cm-variable">Series</span>(<span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">5</span>), <span class="cm-variable">index</span>=<span class="cm-builtin">list</span>(<span class="cm-string">'abcde'</span>))</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">s4</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[]:</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">a</span> &nbsp; <span class="cm-operator">-</span><span class="cm-number">0.758740</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">b</span> &nbsp; <span class="cm-operator">-</span><span class="cm-number">1.557941</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">c</span> &nbsp;  <span class="cm-number">0.673917</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">d</span> &nbsp; <span class="cm-operator">-</span><span class="cm-number">1.605039</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">e</span> &nbsp;  <span class="cm-number">0.382931</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">dtype</span>: <span class="cm-variable">float64</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># concat with overlapping index (default join type is outer)</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []:</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">pd</span>.<span class="cm-property">concat</span>([<span class="cm-variable">s1</span>, <span class="cm-variable">s4</span>], <span class="cm-variable">axis</span>=<span class="cm-number">1</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[]:</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-number">0</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">1</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">a</span>  <span class="cm-number">0.766440</span> <span class="cm-operator">-</span><span class="cm-number">0.758740</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">b</span> <span class="cm-operator">-</span><span class="cm-number">1.022994</span> <span class="cm-operator">-</span><span class="cm-number">1.557941</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">c</span>  <span class="cm-number">1.801808</span>  <span class="cm-number">0.673917</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">d</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">NaN</span> <span class="cm-operator">-</span><span class="cm-number">1.605039</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">e</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">NaN</span>  <span class="cm-number">0.382931</span> &nbsp;  </span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># if we specify a join type, this will be equivalent to a merge</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []:</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">pd</span>.<span class="cm-property">concat</span>([<span class="cm-variable">s1</span>, <span class="cm-variable">s4</span>], <span class="cm-variable">axis</span>=<span class="cm-number">1</span>, <span class="cm-variable">join</span>=<span class="cm-string">'inner'</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[]:</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-number">0</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">1</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">a</span>  <span class="cm-number">0.766440</span> <span class="cm-operator">-</span><span class="cm-number">0.758740</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">b</span> <span class="cm-operator">-</span><span class="cm-number">1.022994</span> <span class="cm-operator">-</span><span class="cm-number">1.557941</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">c</span>  <span class="cm-number">1.801808</span>  <span class="cm-number">0.673917</span> &nbsp;  </span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 884px;"></div></div></div></pre><ol start='3' ><li><p>For <code>DataFrame</code> objects with <strong><em>no overlapping index,</em></strong></p><ul><li><code>axis = 0</code> will produce an append</li><li><code>axis = 1</code> will produce a merge, imputing NaN values where necessary.</li></ul></li></ol><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap "><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Create toy dataframes with non-overlapping indexes</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []:</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">df1</span> = <span class="cm-variable">DataFrame</span>(<span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">9</span>).<span class="cm-property">reshape</span>(<span class="cm-number">3</span>, <span class="cm-number">3</span>), </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-variable">index</span>=<span class="cm-builtin">list</span>(<span class="cm-string">'abc'</span>), <span class="cm-variable">columns</span>=<span class="cm-builtin">list</span>(<span class="cm-string">'XYZ'</span>)) </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">df2</span> = <span class="cm-variable">DataFrame</span>(<span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">4</span>).<span class="cm-property">reshape</span>(<span class="cm-number">2</span>, <span class="cm-number">2</span>), </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-variable">index</span>=<span class="cm-builtin">list</span>(<span class="cm-string">'pq'</span>), <span class="cm-variable">columns</span>=<span class="cm-builtin">list</span>(<span class="cm-string">'XZ'</span>))</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">print</span> <span class="cm-variable">df1</span>, <span class="cm-string">'\n\n'</span>, <span class="cm-variable">df2</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[]:</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">X</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">Y</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">Z</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">a</span> <span class="cm-operator">-</span><span class="cm-number">0.35526</span>  <span class="cm-number">0.629197</span>  <span class="cm-number">0.605691</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">b</span> <span class="cm-operator">-</span><span class="cm-number">0.44103</span> <span class="cm-operator">-</span><span class="cm-number">0.416271</span>  <span class="cm-number">0.212713</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">c</span> <span class="cm-operator">-</span><span class="cm-number">0.37739</span> <span class="cm-operator">-</span><span class="cm-number">2.500837</span>  <span class="cm-number">0.497077</span> </span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-variable">X</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">Z</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">p</span>  <span class="cm-number">1.146606</span>  <span class="cm-number">0.010390</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">q</span>  <span class="cm-number">1.738752</span> <span class="cm-operator">-</span><span class="cm-number">0.727999</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># concat with axis=0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []: <span class="cm-variable">pd</span>.<span class="cm-property">concat</span>([<span class="cm-variable">df1</span>, <span class="cm-variable">df2</span>], <span class="cm-variable">axis</span>=<span class="cm-number">0</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[]:</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-variable">X</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">Y</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">Z</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">a</span> <span class="cm-operator">-</span><span class="cm-number">0.355260</span>  <span class="cm-number">0.629197</span>  <span class="cm-number">0.605691</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">b</span> <span class="cm-operator">-</span><span class="cm-number">0.441030</span> <span class="cm-operator">-</span><span class="cm-number">0.416271</span>  <span class="cm-number">0.212713</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">c</span> <span class="cm-operator">-</span><span class="cm-number">0.377390</span> <span class="cm-operator">-</span><span class="cm-number">2.500837</span>  <span class="cm-number">0.497077</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">p</span>  <span class="cm-number">1.146606</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">NaN</span>  <span class="cm-number">0.010390</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">q</span>  <span class="cm-number">1.738752</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">NaN</span> <span class="cm-operator">-</span><span class="cm-number">0.727999</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># concat with axis=1</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []: <span class="cm-variable">pd</span>.<span class="cm-property">concat</span>([<span class="cm-variable">df1</span>, <span class="cm-variable">df2</span>], <span class="cm-variable">axis</span>=<span class="cm-number">1</span>) </span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[]:</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">X</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">Y</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">Z</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">X</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">Z</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">a</span> <span class="cm-operator">-</span><span class="cm-number">0.35526</span>  <span class="cm-number">0.629197</span>  <span class="cm-number">0.605691</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">NaN</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">NaN</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">b</span> <span class="cm-operator">-</span><span class="cm-number">0.44103</span> <span class="cm-operator">-</span><span class="cm-number">0.416271</span>  <span class="cm-number">0.212713</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">NaN</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">NaN</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">c</span> <span class="cm-operator">-</span><span class="cm-number">0.37739</span> <span class="cm-operator">-</span><span class="cm-number">2.500837</span>  <span class="cm-number">0.497077</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">NaN</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">NaN</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">p</span> &nbsp; &nbsp;  <span class="cm-variable">NaN</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">NaN</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">NaN</span>  <span class="cm-number">1.146606</span>  <span class="cm-number">0.010390</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">q</span> &nbsp; &nbsp;  <span class="cm-variable">NaN</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">NaN</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">NaN</span>  <span class="cm-number">1.738752</span> <span class="cm-operator">-</span><span class="cm-number">0.727999</span> &nbsp;  </span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1014px;"></div></div></div></pre><ol start='4' ><li>For <code>DataFrame</code> objects with an <strong><em>overlapping index</em></strong>,</li></ol><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># Create toy dataframes with overlapping indexes</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []:</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">df1</span> = <span class="cm-variable">DataFrame</span>(<span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">9</span>).<span class="cm-property">reshape</span>(<span class="cm-number">3</span>, <span class="cm-number">3</span>), </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-variable">index</span>=<span class="cm-builtin">list</span>(<span class="cm-string">'abc'</span>), <span class="cm-variable">columns</span>=<span class="cm-builtin">list</span>(<span class="cm-string">'XYZ'</span>)) </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">df2</span> = <span class="cm-variable">DataFrame</span>(<span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">4</span>).<span class="cm-property">reshape</span>(<span class="cm-number">2</span>, <span class="cm-number">2</span>), </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-variable">index</span>=<span class="cm-builtin">list</span>(<span class="cm-string">'ac'</span>), <span class="cm-variable">columns</span>=<span class="cm-builtin">list</span>(<span class="cm-string">'XZ'</span>))</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">print</span> <span class="cm-variable">df1</span>, <span class="cm-string">'\n\n'</span>, <span class="cm-variable">df2</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[]:</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-variable">X</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">Y</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">Z</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">a</span>  <span class="cm-number">1.490298</span> <span class="cm-operator">-</span><span class="cm-number">1.424274</span>  <span class="cm-number">0.498258</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">b</span> <span class="cm-operator">-</span><span class="cm-number">0.375134</span> <span class="cm-operator">-</span><span class="cm-number">0.175445</span>  <span class="cm-number">0.533636</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">c</span>  <span class="cm-number">2.198040</span> <span class="cm-operator">-</span><span class="cm-number">0.375883</span> <span class="cm-operator">-</span><span class="cm-number">0.312773</span> </span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-variable">X</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">Z</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">a</span>  <span class="cm-number">0.240080</span>  <span class="cm-number">1.137680</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">c</span>  <span class="cm-number">0.121164</span> <span class="cm-operator">-</span><span class="cm-number">0.076435</span> &nbsp;  </span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># with axis=0 (default)</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []: <span class="cm-variable">pd</span>.<span class="cm-property">concat</span>([<span class="cm-variable">df1</span>, <span class="cm-variable">df2</span>])</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[]:</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-variable">X</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">Y</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">Z</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">a</span>  <span class="cm-number">1.490298</span> <span class="cm-operator">-</span><span class="cm-number">1.424274</span>  <span class="cm-number">0.498258</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">b</span> <span class="cm-operator">-</span><span class="cm-number">0.375134</span> <span class="cm-operator">-</span><span class="cm-number">0.175445</span>  <span class="cm-number">0.533636</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">c</span>  <span class="cm-number">2.198040</span> <span class="cm-operator">-</span><span class="cm-number">0.375883</span> <span class="cm-operator">-</span><span class="cm-number">0.312773</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">a</span>  <span class="cm-number">0.240080</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">NaN</span>  <span class="cm-number">1.137680</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">c</span>  <span class="cm-number">0.121164</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">NaN</span> <span class="cm-operator">-</span><span class="cm-number">0.076435</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># with axis=1</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">In</span> []: <span class="cm-variable">pd</span>.<span class="cm-property">concat</span>([<span class="cm-variable">df1</span>, <span class="cm-variable">df2</span>], <span class="cm-variable">axis</span>=<span class="cm-number">1</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">Out</span>[]: </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-variable">X</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">Y</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">Z</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">X</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">Z</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">a</span>  <span class="cm-number">1.490298</span> <span class="cm-operator">-</span><span class="cm-number">1.424274</span>  <span class="cm-number">0.498258</span>  <span class="cm-number">0.240080</span>  <span class="cm-number">1.137680</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">b</span> <span class="cm-operator">-</span><span class="cm-number">0.375134</span> <span class="cm-operator">-</span><span class="cm-number">0.175445</span>  <span class="cm-number">0.533636</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">NaN</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">NaN</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">c</span>  <span class="cm-number">2.198040</span> <span class="cm-operator">-</span><span class="cm-number">0.375883</span> <span class="cm-operator">-</span><span class="cm-number">0.312773</span>  <span class="cm-number">0.121164</span> <span class="cm-operator">-</span><span class="cm-number">0.076435</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 936px;"></div></div></div></pre><p></p></div>
</body>
</html>